module.exports=function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="lib/",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){var n=[],r=function e(r){return O.default.readdirSync(r).forEach(function(o){var u=w.default.join(r,o);O.default.statSync(u).isDirectory()?e(u):t.test(o)&&n.push(u)})};return O.default.statSync(e).isDirectory()?r(e):n.push(e),n}function s(e,t){return new y.default(e,t)}function l(e){return new _.default(e)}function f(e){return new m.default(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.test=t.group=t.collection=t.squalus=void 0;var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(1),h=r(d),p=n(20),y=r(p),v=n(24),_=r(v),b=n(25),m=r(b),g=n(28),w=r(g),k=n(29),O=r(k),j=n(30),E=r(j),P=function(e){function t(){return o(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),c(t,null,[{key:"execute",value:function(e,t,n){var r=a(e,/\.yaml$/);if(r.length){var o=Object.assign.apply(null,r.map(function(e){return E.default.safeLoad(O.default.readFileSync(e,{encoding:"utf8"}))}));h.default.buildTypes(o)}var u=void 0;return n&&(u=JSON.parse(O.default.readFileSync(n,{encoding:"utf8"}))),t.execute(u)}}]),t}(h.default);t.squalus=P,t.collection=s,t.group=l,t.test=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(")"===e[t]){for(var n=0,r=t-1;r>=0;r--)if(")"===e[r])++n;else if("("===e[r]){if(0===n)return u(e,r-1);--n}}else if("}"===e[t]){for(var o=t-1;o>=0;o--)if("{"===e[o])return u(e,o-1)}else if("[]"===e[t])return u(e,t-1);return t>=0?t:0}function i(e,t){for(var n=e.split(/([|{}()?:,]|&&|\[]|=>)/).map(function(e){return e.trim()}).filter(function(e){return""!==e}),r=0;r<n.length;r++)if("?"===n[r]){var o=u(n,r-1);n.splice(o,0,"("),n.splice(r+1,1,"|","null",")"),--r}if(!t)return n;for(var i=[],a=0;a<n.length;a++)if("{"!==n[a])if(":"!==n[a])["[]","=>","|",",","(",")"].includes(n[a])||i.push(n[a]);else for(;")"!==n[a];)++a;else for(;"}"!==n[a];)++a;return i}function a(){return M.default.getScalarTypes().map(function(e){return{name:e,data:e}})}function s(e){var t=new Set;return Object.keys(e).forEach(function(n){var r=e[n];"string"==typeof r?i(r,!0).forEach(function(e){return t.add(e)}):s(r).forEach(function(e){return t.add(e)})}),t}function l(e,t){var n=e;"string"==typeof e&&(n=[e]);var r=Array.from(n,function(e){return e.indexOf("{")!==-1||e.indexOf("[")!==-1||e.indexOf("|")!==-1||e.indexOf(".")!==-1||M.default.getScalarTypes().includes(e)?e:t+"."+e});return"string"==typeof e?r[0]:r}function f(e){var t=[];return Object.keys(e).forEach(function(n){Object.keys(e[n]).forEach(function(r){var o=e[n][r],u=new Set;"string"==typeof o?i(o,!0).forEach(function(e){return u.add(e)}):s(o).forEach(function(e){return u.add(e)}),t.push({name:l(r,n),requires:l(u,n),data:o})})}),t}function c(e,t){return new S.default(e.replace(/\?$/,""),t.clone(),!e.endsWith("?"))}function d(e){"("===e[0]&&")"===e[e.length-1]&&(e.splice(e.length-1),e.splice(0,1))}function h(e,t){d(e);var n=[],r=[],o=[];return e.forEach(function(e){"("===e?(o.push(!0),r.push(e)):")"===e?(o.pop(),r.push(e)):o.length||e!==t?r.push(e):(r.length&&n.push(r),r=[])}),r.length&&n.push(r),n.forEach(function(e){return d(e)}),n}function p(e,t){if("boolean"==typeof e&&(e=e?"bool{true}":"bool{false}"),"string"==typeof e){var n=i(e),r=h(n,"|");if(r.length>1){var o=function(){if(r.length!==new Set(r).size)throw new Error("duplicate types in branch list");var e=new Map;return r.forEach(function(n){e.set(n,p(l(n.join(""),t)))}),{v:j.default.create(e)}}();if("object"===("undefined"==typeof o?"undefined":v(o)))return o.v}var u=h(n,"=>");if(u.length>1)return new N.default(p(u[0].join(""),t),p(u[1].join(""),t));if("[]"===n[n.length-1])return new P.default(p(n.slice(0,n.length-1).join(""),t));if("}"===n[n.length-1])return M.default.create(n[n.indexOf("{")-1],n.slice(n.indexOf("{")+1,n.length-1).filter(function(e){return","!==e}));if(")"===n[n.length-1]){var a=function(){var e=n.indexOf(":"),r=n[e+1],o=n.slice(e+3,n.length-1).filter(function(e){return","!==e}),u={map:function(e){var t=new Map;return e.attributes().forEach(function(e){return t.set(e.name(),new T.default([new S.default(o[0],M.default.create("string",[e.name()]),!0),new S.default(o[1],e.type().clone(),!0)]))}),new j.default(t)}};if(!u[r])throw new Error("unsupported transform");return{v:u[r](p(n.slice(0,e).join(""),t))}}();if("object"===("undefined"==typeof a?"undefined":v(a)))return a.v}var s=l(n.join(""),t);return V.has(s)?V.get(s).clone():M.default.create(s)}var f=Object.keys(e).filter(function(e){return"^"!==e}),d=e["^"];if(d){if("string"!=typeof d)throw new Error("inheritance attribute must be a string");var y=i(d).filter(function(e){return","!==e}).map(function(e){return V.get(l(e,t))});if(1===y.length&&y[0]instanceof j.default){var _=function(){var n=y[0];if(!Array.from(n.types.values()).every(function(e){return e instanceof Object}))throw new Error("inheritance from branch with non-object");var r=new Map;return n.types.forEach(function(n,o){var u=function(n,o){var u=new Map;n.attributes().forEach(function(e){u.set(e.name(),e.clone())}),f.forEach(function(n){return u.set(n.trim("?"),c(n,p(e[n],t)))}),r.set(o,new T.default(Array.from(u.values())))};n instanceof j.default?n.types.forEach(function(e,t){return u(e,o+"-"+t)}):u(n,o)}),{v:new j.default(r)}}();if("object"===("undefined"==typeof _?"undefined":v(_)))return _.v}else if(y.every(function(e){return e instanceof T.default})){var b=function(){var n=new Map;return y.forEach(function(e){e.attributes().forEach(function(e){n.set(e,e.clone())})}),f.forEach(function(r){return n.set(r.trim("?"),c(r,p(e[r],t)))}),{v:new T.default(Array.from(n.values()))}}();if("object"===("undefined"==typeof b?"undefined":v(b)))return b.v}throw new Error("invalid parent type")}return new T.default(f.map(function(n){return c(n,p(e[n],t))}))}Object.defineProperty(t,"__esModule",{value:!0});var y=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_=n(2),b=r(_),m=n(3),g=r(m),w=n(5),k=r(w),O=n(6),j=r(O),E=n(10),P=r(E),x=n(11),S=r(x),C=n(12),T=r(C),q=n(9),M=r(q),A=n(13),N=r(A),U=n(14),J=r(U),L=n(15),I=r(L),z=n(16),R=r(z),D=n(17),H=r(D),B=n(18),$=r(B),G=n(8),F=r(G),K=n(19),W=r(K);M.default.register("null",F.default),M.default.register(["int","uint"],$.default),M.default.register("float",R.default),M.default.register("bool",J.default),M.default.register("guid",H.default),M.default.register("email",I.default),M.default.register("password",W.default);var V=new Map,Y=function(){function e(){o(this,e)}return y(e,null,[{key:"getType",value:function(e){return V.get(e)}},{key:"buildTypes",value:function(e){var t=a().concat(f(e)),n=(0,k.default)(t,function(e){return e.name},function(e){return e.requires});n.forEach(function(e,t){var n=t.indexOf(".")?t.substring(0,t.indexOf(".")):null;V.set(t,p(e.data,n))})}},{key:"buildTests",value:function(e,t){var n=document.body.appendChild((0,b.default)("div",{id:"api-root"})),r=n.appendChild((0,b.default)("div",{id:"api-container"}));n.appendChild((0,b.default)("div",{id:"output-container"}));var o=r.appendChild((0,b.default)("ul",{class:"api-tests"}));e.forEach(function(e){var n=["get","put","post","delete"],r=n.filter(function(t){return e[t]});if(1!==r.length)throw new Error("missing or invalid method");var u=new g.default(t,e[r[0]],r[0].toUpperCase(),e.headers?p(e.headers):null,e.urlParams?p(e.urlParams):null,e.queryParams?p(e.queryParams):null,e.body?p(e.body):null);o.appendChild((0,b.default)("li",u.build())),u.load()});var u={change:{"select.test-option":j.default.onChange},click:{".test-row-add":P.default.onClickAdd,".test-row-remove":P.default.onClickRemove,".test-attr-toggle":S.default.onClickToggle,".test-submit":g.default.onSubmit},keypress:{"input[type=text],input[type=checkbox],select":g.default.onKeyPress}};window.addEventListener("beforeunload",g.default.onBeforeUnload),Object.keys(u).forEach(function(e){n.addEventListener(e,function(t){t.target&&!function(){var n=g.default.closest(t.target);n&&Object.keys(u[e]).forEach(function(r){if(t.target.matches(r)){var o=u[e][r];o(t,n)}})}()})}),j.default.initializeSelectionStates(n),S.default.initializeIncludedStates(n)}}]),e}();t.default=Y},function(e,t){"use strict";function n(e){return e===Object(e)&&!Array.isArray(e)}function r(e,t){if(t&&t.nodeType)e.appendChild(t);else{var n=document.createElement("div");for(n.innerHTML=void 0===t?"":t;n.firstChild;)e.appendChild(n.firstChild)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=arguments.length,o=Array(t>1?t-1:0),u=1;u<t;u++)o[u-1]=arguments[u];var i=o.length&&n(o[0])&&!o[0].nodeType?o[0]:{},a=o.slice(o[0]===i?1:0),s=document.createElement(e);return Object.keys(i).forEach(function(e){e.startsWith("data-")?s.dataset[e.substr(5)]=i[e]:e.startsWith("_")?s[e]=i[e]:s.setAttribute(e,i[e])}),a.forEach(function(e){Array.isArray(e)?e.forEach(function(e){r(s,e)}):r(s,e)}),s}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=e.parentNode;n;){if(n.classList&&n.classList.contains(t))return n;n=n.parentNode}return null}function i(e,t,n){Array.isArray(e)?e.forEach(function(e,r){return i(e,t+"["+r+"]",n)}):"object"===("undefined"==typeof e?"undefined":s(e))?Object.keys(e).forEach(function(r){return i(e[r],t+"["+r+"]",n)}):"boolean"==typeof e?n.set(t,encodeURI(e?1:0)):n.set(t,encodeURI(e))}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=n(2),f=r(l),c=n(4),d=r(c),h={headers:"http-headers",urlParams:"url-params",queryParams:"query-params",body:"body"},p=function(){function e(t,n,r,u,i,a,s){o(this,e),this._baseUrl=t,this._url=n,this._method=r,this._headers=u,this._urlParams=i,this._queryParams=a,this._body=s,this._node=null}return a(e,[{key:"section",value:function(e){return this["_"+e]}},{key:"headers",value:function(){return this._headers?this._headers.value():null}},{key:"urlParams",value:function(){return this._urlParams?this._urlParams.value():null}},{key:"queryParams",value:function(){return this._queryParams?this._queryParams.value():null}},{key:"body",value:function(){return this._body?this._body.value():null}},{key:"clear",value:function(){this._body.clear()}},{key:"lock",value:function(){this._body.find("*").prop("disabled",!0)}},{key:"unlock",value:function(){this._body.find("*").prop("disabled",!1)}},{key:"getPopulatedUrl",value:function(){var e=this._url,t=this.urlParams();if(t){var n=!0,r=!1,o=void 0;try{for(var u,a=Object.keys(t)[Symbol.iterator]();!(n=(u=a.next()).done);n=!0){var s=u.value;e=e.replace("{"+s+"}",encodeURI(t[s]))}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}}e=new URL(e,this._baseUrl);var l=this.queryParams();if(l){var f=new Map,c=!0,d=!1,h=void 0;try{for(var p,y=Object.keys(l)[Symbol.iterator]();!(c=(p=y.next()).done);c=!0){var v=p.value,_=l[v];null!==_&&""!==_&&i(_,v,f)}}catch(e){d=!0,h=e}finally{try{!c&&y.return&&y.return()}finally{if(d)throw h}}f.forEach(function(t,n){return e.searchParams.append(n,t)})}return e}},{key:"build",value:function(){this._node=(0,f.default)("div",{class:"endpoint endpoint-method-"+this._method.toLowerCase(),_squalusDef:this},(0,f.default)("div",{class:"endpoint-header"},(0,f.default)("span",{class:"endpoint-method"},this._method),(0,f.default)("span",{class:"endpoint-url"},this._url)));var e=this._node.appendChild((0,f.default)("div",{class:"endpoint-test"})),t=!0,n=!1,r=void 0;try{for(var o,u=Object.keys(h)[Symbol.iterator]();!(t=(o=u.next()).done);t=!0){var i=o.value,a=this.section(i);a&&e.appendChild((0,f.default)("div",{class:"endpoint-test-"+("body"===i?"body":"params")},(0,f.default)("div",{class:"endpoint-test-label"},h[i]),a.build()))}}catch(e){n=!0,r=e}finally{try{!t&&u.return&&u.return()}finally{if(n)throw r}}return e.appendChild((0,f.default)("div",{class:"endpoint-test-controls"},(0,f.default)("input",{type:"button",value:this._method,class:"test-submit"}),(0,f.default)("span",{class:"endpoint-test-status"}))),this._node}},{key:"submit",value:function(){var e=this.getPopulatedUrl(),t=this.headers(),n=this.body(),r={method:this._method,headers:{"Content-Type":"application/json"}};if(t){var o=!0,u=!1,i=void 0;try{for(var a,s=Object.keys(t)[Symbol.iterator]();!(o=(a=s.next()).done);o=!0){var l=a.value;r.headers[l]=t[l]}}catch(e){u=!0,i=e}finally{try{!o&&s.return&&s.return()}finally{if(u)throw i}}}["PUT","POST","PATCH"].includes(this._method)&&(r.body=JSON.stringify(n)),d.default.execute(e,r).then(function(e){e.dump()})}},{key:"storageKey",value:function(){return"squalus:"+this._method.toLowerCase()+"-"+this._url}},{key:"load",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=Object.keys(h)[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var u=r.value,i=this.section(u);if(i){var a=localStorage.getItem(this.storageKey()+"-"+u);if(null!=a){try{a=JSON.parse(a)}catch(e){continue}try{i.populate(a)}catch(e){}}}}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}}},{key:"unload",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,o=Object.keys(h)[Symbol.iterator]();!(e=(r=o.next()).done);e=!0){var u=r.value,i=this.section(u);i&&localStorage.setItem(this.storageKey()+"-"+u,JSON.stringify(i.value()))}}catch(e){t=!0,n=e}finally{try{!e&&o.return&&o.return()}finally{if(t)throw n}}}}],[{key:"onBeforeUnload",value:function(){Array.from(document.getElementsByClassName("endpoint")).forEach(function(e){return e._squalusDef.unload()})}},{key:"onKeyPress",value:function(e,t){13===e.which&&(e.preventDefault(),(t||this.closest(e.target)).submit())}},{key:"onSubmit",value:function(e,t){(t||this.closest(e.target)).submit()}},{key:"closest",value:function(e){var t=u(e,"endpoint");return t?t._squalusDef:null}}]),e}();t.default=p},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(){return document.getElementById("output-container")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(2),s=r(a),l=function(){function e(t,n){o(this,e),this._url=t,this._options=n,this._sendTime=(new Date).getTime(),this._responseTime=null,this._responseUrl=null,this._responseStatus=null,this._responseHeaders=null,this._responseBody=null}return i(e,[{key:"dump",value:function(){var t=u();t.innerHTML="";var n=this._responseBody,r=this._responseHeaders.get("content-type");if(r&&r.indexOf("application/json")!==-1)try{n=JSON.stringify(JSON.parse(n),null,2)}catch(e){}var o=(0,s.default)("pre");o.textContent=n;var i={url:this._responseUrl,method:this._options.method,status:this._responseStatus,time:this._responseTime-this._sendTime+" ms",headers:(0,s.default)("table",Array.from(this._responseHeaders.entries()).map(function(e){return(0,s.default)("tr",(0,s.default)("th",e[0]),(0,s.default)("td",e[1]))}))};this._responseHeaders.get("content-type")&&(i.body=o),e.dumpSections(i)}}],[{key:"execute",value:function(t,n){var r=new e(t,n),o=u();o.innerHTML="";var i={url:r._url,method:r._options.method,status:"fetching..."};return e.dumpSections(i),fetch(t,n).then(function(e){return e.text().then(function(t){return r._responseTime=(new Date).getTime(),r._responseUrl=e.url,r._responseStatus=e.status,r._responseHeaders=e.headers,r._responseBody=t,r})}).catch(function(e){console.log(e.message)})}},{key:"dumpSections",value:function(e){var t=u(),n=!0,r=!1,o=void 0;try{for(var i,a=Object.keys(e)[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var l=i.value;t.appendChild((0,s.default)("div",{class:"output-section"},(0,s.default)("div",{class:"output-section-label"},l),(0,s.default)("div",{class:"output-section-content"},e[l])))}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}}}]),e}();t.default=l},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var r=new Map,o=[],u=new Map;e.forEach(function(e){return u.set(t(e),e)}),u.forEach(function(e){var i=n(e);i&&i.length?i.forEach(function(n){if(!u.has(n))throw new Error("Unknown dependency "+n);r.has(n)||r.set(n,[]),r.get(n).push(t(e))}):o.push(e)});for(var i=void 0,a=new Map;o.length>0;){var s=o.pop(),l=t(s);if(a.set(l,s),r.has(l))for(i=r.get(l);i.length>0;){var f=i.pop(),c=u.get(f),d=n(c);d&&d.find(function(e){return!a.has(e)})||o.push(c)}}return r.forEach(function(e){if(e.size>0)throw new Error("Graph cycle; unable to sort")}),a}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2),a=r(i),s=n(7),l=r(s),f=n(8),c=r(f),d=function(){function e(t){if(o(this,e),t.size<2)throw new Error("degenerate branch type");this._types=t,this._node=null}return u(e,[{key:"clone",value:function(){var e=new Map;return this._types.forEach(function(t,n){return e.set(n,t.clone())}),new this.constructor(e)}},{key:"build",value:function(){return this._node=(0,a.default)("div",{_squalusType:this},(0,a.default)("select",{class:"test-option"},Array.from(this._types.keys(),function(e){return(0,a.default)("option",e)})),Array.from(this._types.values(),function(e){return(0,a.default)("div",{class:"test-option"},e.build())})),this._node}},{key:"value",value:function(){return Array.from(this._types.values())[this._node.firstElementChild.selectedIndex].value()}},{key:"populate",value:function(e){var t=Array.from(this._types.values()),n=t.findIndex(function(t){return t.validate(e,"",!0)});if(n===-1)throw new Error("branch validation failed");var r=this._node.firstElementChild;r.selectedIndex=n;var o=new Event("change",{bubbles:!0});r.dispatchEvent(o),t[n].populate(e)}},{key:"validate",value:function(e,t,n,r){if(!Array.from(this._types.values()).some(function(n){return n.validate(e,t,!0,r)})){if(n)return!1;throw new Error(t+" does not match any candidate")}return!0}},{key:"clear",value:function(){this._types.forEach(function(e){return e.clear()})}},{key:"toJSON",value:function(){return{_:"branch",types:this._types}}},{key:"types",get:function(){return this._types}}],[{key:"onChange",value:function(e){for(var t=e.target,n=0;t.nextElementSibling;)t=t.nextElementSibling,t.classList.toggle("test-hidden",n++!==e.target.selectedIndex)}},{key:"initializeSelectionStates",value:function(e){Array.from(e.querySelectorAll("select")).forEach(function(e){var t=new Event("change",{bubbles:!0});e.dispatchEvent(t)})}},{key:"create",value:function(t){if(2===t.size){var n=Array.from(t.values()).filter(function(e){return!(e instanceof c.default)});if(1===n.length)return new l.default(n[0])}return new e(t)}}]),e}();t.default=d},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t){n(this,e),this._type=t}return r(e,[{key:"name",value:function(){return this._type.name()}},{key:"build",value:function(){return this._type.build()}},{key:"clone",value:function(){return new this.constructor(this._type.clone())}},{key:"value",value:function(){var e=this._type.value();return""===e&&(e=null),e}},{key:"validate",value:function(e,t,n,r){return null===e||this._type.validate(e,t,n,r)}},{key:"populate",value:function(e){this._type.populate(e)}},{key:"clear",value:function(){this._type.clear()}},{key:"toJSON",value:function(){return{_:"nullable",type:this._type}}}]),e}();t.default=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(9),l=r(s),f=function(e){function t(){return o(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"supportsValues",value:function(){return!1}},{key:"_build",value:function(){return document.createTextNode("")}},{key:"_validate",value:function(e){return null===e}},{key:"value",value:function(){return null}}]),t}(l.default);t.default=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2),a=r(i),s=new Map;["null","int","uint","float","string","password","email","bool","date","datetime","timestamp","guid"].forEach(function(e){return s.set(e,null)});var l=function(){function e(t,n){o(this,e),this._type=t,this._values=this._parse(n),this._node=null}return u(e,[{key:"clone",value:function(){return new this.constructor(this._type,this._values)}},{key:"supportsValues",value:function(){return!0}},{key:"_parse",value:function(e){return e}},{key:"_build",value:function(){return this._values?1===this._values.length?(0,a.default)("input",{type:"text",disabled:!0,value:this._values[0]}):(0,a.default)("select",this._values.map(function(e){return(0,a.default)("option",e)})):(0,a.default)("input",{type:"text",placeholder:this._type})}},{key:"build",value:function(){return this._node=this._build(),this._node._squalusType=this,this._node}},{key:"value",value:function(){return this._node.value}},{key:"populate",value:function(e){this._node.value=e}},{key:"_validate",value:function(e){return"string"==typeof e}},{key:"validate",value:function(e,t,n){if(!this._validate(e,t,n)){if(n)return!1;throw new Error(t+" must be of type "+this._type)}if(this._values&&!this._values.includes(e)){if(n)return!1;throw new Error(t+": '"+e+"' must be in ["+this._values.join(", ")+"]")}return!0}},{key:"clear",value:function(){this._values?void 0!==this._node.selectedIndex&&(this._node.selectedIndex=0):this._node.value=""}},{key:"toJSON",value:function(){return{_:"scalar",type:this._type}}},{key:"name",get:function(){return this._type}}],[{key:"register",value:function(e,t){Array.isArray(e)?e.forEach(function(e){return s.set(e,t)}):s.set(e,t)}},{key:"create",value:function(t,n){return new(s.get(t)||e)(t,n)}},{key:"getScalarTypes",value:function(){return Array.from(s.keys())}}]),e}();t.default=l},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2),a=r(i),s=n(6),l=r(s),f=function(){function e(t){o(this,e),this._type=t,this._rows=[],this._node=null,this._body=null}return u(e,[{key:"name",value:function(){return this._type.name()+"[]"}},{key:"clone",value:function(){return new this.constructor(this._type.clone())}},{key:"build",value:function(){return this._node=(0,a.default)("div",{_squalusType:this},(0,a.default)("table",this._body=(0,a.default)("tbody"),(0,a.default)("tfoot",(0,a.default)("th",(0,a.default)("input",{type:"button",class:"test-row-add",value:"+"})),(0,a.default)("th"),(0,a.default)("td")))),this._node}},{key:"populate",value:function(e){for(var t=0;t<e.length;t++){var n=this.add();n.populate(e[t])}}},{key:"validate",value:function(e,t,n,r){var o=this;if(!Array.isArray(e)){if(n)return!1;throw new Error(t+" must be an array")}return e.every(function(e,u){return o._type.validate(e,t+"["+u+"]",n,r)})}},{key:"value",value:function(){return this._rows.map(function(e){return e.value()})}},{key:"clear",value:function(){this._rows=[],this._body.innerHTML=""}},{key:"add",value:function(){var e=this._type.clone();return this._rows.push(e),this._body.appendChild((0,a.default)("tr",(0,a.default)("th",(0,a.default)("input",{type:"button",class:"test-row-remove",value:"-"})),(0,a.default)("th","["+this._body.children.length+"]"),(0,a.default)("td",e.build()))),l.default.initializeSelectionStates(this._body.lastElementChild),e}},{key:"remove",value:function(e){this._rows.splice(e,1),this._body.children[e].remove();for(var t=e;t<this._body.children.length;t++)this._body.children[t].children[1].textContent="["+t+"]"}},{key:"toJSON",value:function(){return{_:"array",type:this._type}}}],[{key:"onClickAdd",value:function(e){e.target.parentNode.parentNode.parentNode.parentNode._squalusType.add()}},{key:"onClickRemove",value:function(e){var t=e.target.parentNode.parentNode,n=Array.prototype.indexOf.call(t.parentNode.children,t);t.parentNode.parentNode.parentNode._squalusType.remove(n)}}]),e}();t.default=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2),a=r(i),s=function(){function e(t,n,r){o(this,e),this._name=t,this._type=n,this._required=r,this._included=!1,this._name.endsWith("?")&&console.log(this)}return u(e,[{key:"name",value:function(){return this._name}},{key:"type",value:function(){return this._type}},{key:"required",value:function(){return this._required}},{key:"included",value:function(){return this._included}},{key:"clone",value:function(){return new this.constructor(this._name,this._type.clone(),this._required)}},{key:"build",value:function(){return this._node=(0,a.default)("tr",{_squalusType:this},(0,a.default)("th"),(0,a.default)("th",this._name),(0,a.default)("td",this._type.build())),this._required||this._node.firstElementChild.appendChild((0,a.default)("input",{type:"button",class:"test-attr-toggle",value:"ðŸ“Ž"})),this.update(),this._node}},{key:"value",value:function(){return this._type.value()}},{key:"populate",value:function(e){this._type.populate(e),this._included=!0,this.update()}},{key:"validate",value:function(e,t,n,r){return this._type.validate(e,t,n,r)}},{key:"clear",value:function(){this._type.clear(),this._included=!1,this.update()}},{key:"toggle",value:function(){this._included=!this._included,this.update()}},{key:"update",value:function(){this._required||(this._node.children[0].firstElementChild.classList.toggle("test-attr-included",this._included),this._node.children[1].classList.toggle("test-attr-toggle",!this._included),this._node.children[2].firstElementChild.classList.toggle("test-hidden",!this._included))}},{key:"toJSON",value:function(){return{_:"attribute",name:this._name,type:this._type}}}],[{key:"onClickToggle",value:function(e){e.target.parentNode.parentNode._squalusType.toggle()}},{key:"initializeIncludedStates",value:function(e){Array.from(e.querySelectorAll(".test-attr-toggle")).forEach(function(e){var t=new Event("click",{bubbles:!0});e.dispatchEvent(t)})}}]),e}();t.default=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(2),s=r(a),l=function(){function e(t){o(this,e),this._attributes=t,this._node=null}return i(e,[{key:"attributes",value:function(){return this._attributes}},{key:"clone",value:function(){return new this.constructor(this._attributes.map(function(e){return e.clone()}))}},{key:"build",value:function(){return this._node=(0,s.default)("table",{_squalusType:this},(0,s.default)("tbody",this._attributes.map(function(e){return e.build()}))),this._node}},{key:"value",value:function(){var e={};return this._attributes.forEach(function(t){(t.required()||t.included())&&(e[t.name()]=t.value())}),e}},{key:"populate",value:function(e){this._attributes.forEach(function(t){
t.populate(e[t.name()])})}},{key:"validate",value:function(e,t,n,r){var o=this;if("object"!==("undefined"==typeof e?"undefined":u(e))||null===e){if(n)return!1;throw new Error(t+" must be an object")}for(var i=0;i<this._attributes.length;i++){var a=this._attributes[i],s=a.name();if(void 0===e[s]){if(a.required()){if(n)return!1;throw new Error(t+"."+s+" is required")}}else if(!a.validate(e[s],t+"."+s,n,r))return!1}return r._throwUnknownObjectAttributes&&!function(){var n=new Set(o._attributes.map(function(e){return e.name()})),r=Object.keys(e).filter(function(e){return!n.has(e)});if(r.length>0)throw new Error("Unknown attributes `"+r.join(",")+"` not allowed in `"+t+"`")}(),!0}},{key:"clear",value:function(){this._attributes.forEach(function(e){return e.clear()})}},{key:"toJSON",value:function(){return{_:"object",attributes:this._attributes}}}]),e}();t.default=l},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(2),s=r(a),l=n(6),f=r(l),c=function(){function e(t,n,r){o(this,e),this._type=n,this._key=t,this._required=r,this._rows=[],this._node=null,this._body=null}return i(e,[{key:"name",value:function(){return this._type.name()+"{}"}},{key:"clone",value:function(){return new this.constructor(this._key.clone(),this._type.clone(),this._required?this._required.clone():null)}},{key:"build",value:function(){var e=this;return this._node=(0,s.default)("div",{_squalusType:this},(0,s.default)("table",this._body=(0,s.default)("tbody"),(0,s.default)("tfoot",(0,s.default)("th",(0,s.default)("input",{type:"button",class:"test-row-add",value:"+"})),(0,s.default)("th"),(0,s.default)("td")))),this._required&&this._required.attributes().forEach(function(t){e.add(t.type(),t.name())}),this._node}},{key:"populate",value:function(e){var t=this;Object.keys(e).forEach(function(n,r){var o=t.add();t._body.children[r].firstElementChild.textContent=n,o.populate(e[n])})}},{key:"validate",value:function(e,t,n,r){if("object"!==("undefined"==typeof e?"undefined":u(e))||null===e){if(n)return!1;throw new Error(t+" must be an object")}for(var o=Object.keys(e),i=0;i<o.length;i++){var a=o[i];if(!this._key.validate(a,t+"["+a+"]*",n,r))return!1;if(!this._type.validate(e[a],t+"["+a+"]",n,r))return!1}return!(this._required&&!this._type.validate(e,t,n,r))}},{key:"value",value:function(){var e=this,t={};return this._rows.forEach(function(n,r){var o=e._body.children[r].children[1].firstElementChild.value;t[o]=n.value()}),t}},{key:"clear",value:function(){this._rows=[],this._body.innerHTML=""}},{key:"add",value:function(e,t){var n=e||this._type.clone();this._rows.push(n);var r=this._key?this._key.build():(0,s.default)("input",{type:"text",placeholder:"key"});return t&&(r.value=t),this._body.appendChild((0,s.default)("tr",(0,s.default)("th",(0,s.default)("input",{type:"button",class:"test-row-remove",value:"-"})),(0,s.default)("th",r),(0,s.default)("td",n.build()))),f.default.initializeSelectionStates(this._body.lastElementChild),n}},{key:"remove",value:function(e){this._rows.splice(e,1),this._body.children[e].remove()}},{key:"toJSON",value:function(){return{_:"map",key:this._key,type:this._type}}}]),e}();t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(2),l=r(s),f=n(9),c=r(f),d=function(e){function t(){return o(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"_parse",value:function(e){return e?e.map(function(e){return e===!0||"true"===e}):null}},{key:"_build",value:function(){return(0,l.default)("input",{type:"checkbox"})}},{key:"_validate",value:function(e){return"boolean"==typeof e}},{key:"value",value:function(){return this._node.checked}},{key:"populate",value:function(e){this._node.checked=e}},{key:"clear",value:function(){this._node.checked=!1}}]),t}(c.default);t.default=d},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(9),l=r(s),f=function(e){function t(){return o(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"_validate",value:function(e){return e&&e.match(/^(([^<>()\[\].,;:\s@"]+(\.[^<>()\[\].,;:\s@"]+)*)|(".+"))@(([^<>()[\].,;:\s@"]+\.)+[^<>()[\].,;:\s@"]{2,})$/i)}}]),t}(l.default);t.default=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(9),l=r(s),f=function(e){function t(){return o(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"_parse",value:function(e){return e?e.map(function(e){return parseFloat(e)}):null}},{key:"_validate",value:function(e){return"number"==typeof e}},{key:"value",value:function e(){var e=this._node.value.trim();return""===e?null:parseFloat(this._node.value)}}]),t}(l.default);t.default=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(9),l=r(s),f=function(e){function t(){return o(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"_validate",value:function(e){return e&&e.match(/^[a-f0-9]{8}(?:-[a-f0-9]{4}){3}-[a-f0-9]{12}$/i)}}]),t}(l.default);t.default=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(9),l=r(s),f=100,c=function(e){function t(e,n){o(this,t);var r=u(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r._validator=null,r}return i(t,e),a(t,[{key:"_parse",value:function(e){if(!e)return null;var t=e.reduce(function(e,t){if("number"==typeof t){if((0|t)!==t)throw new Error("not an int");e.push(t)}else if(t.indexOf("-")!==-1){var n=t.split("-"),r=parseInt(n[0],10),o=parseInt(n[1],10);e.push([r,o])}else e.push(parseInt(t,10));return e},[]),n=t.filter(function(e){return Array.isArray(e)});if(!n.length)return t.sort(function(e,t){return e-t});var r=t.filter(function(e){return!Array.isArray(e)}),o=n.reduce(function(e,t){return e+(t[1]-t[0])},0);return o+r.length<=f?(n.forEach(function(e){for(var t=e[0];t<=e[1];t++)r.push(t)}),r.sort(function(e,t){return e-t})):(this._validator=function(e){return r.includes(e)||n.some(function(t){return t[0]<=e&&e>=t[1]})},null)}},{key:"_validate",value:function(e){return"number"==typeof e&&(0|e)===e}},{key:"value",value:function e(){var e=this._node.value.trim();return""===e?null:parseInt(this._node.value,10)}}]),t}(l.default);t.default=c},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(2),l=r(s),f=n(9),c=r(f),d=function(e){function t(){return o(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),a(t,[{key:"_build",value:function(){return(0,l.default)("input",{type:"password",placeholder:this._type})}}]),t}(c.default);t.default=d},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(21),a=(r(i),n(5)),s=r(a),l=n(22),f=r(l),c=n(23),d=r(c),h=function(){function e(t,n){o(this,e),this._name=t,this._groups=null,this._cancel=!1,this._sequential=!!(n||{}).sequential,this._validationContext=new d.default(!!(n||{}).throwUnknownObjectAttributes)}return u(e,[{key:"groups",value:function(e){return this._groups=e,this}},{key:"getMaxGroupNameLength",value:function(){return this._groups&&!this._maxGroupNameLength&&(this._maxGroupNameLength=this._groups.reduce(function(e,t){return e._name.length>t._name.length?e:t})._name.length),this._maxGroupNameLength}},{key:"execute",value:function(e){var t=this,n=Date.now(),r=Promise.resolve(),o=new Map;e&&Object.keys(e).forEach(function(t){return o.set(t,e[t])});var u=this._groups.reduce(function(e,t){return e+t._tests.length},0),i=[];return this._sequential&&i.push("sequential"),this._validationContext._throwUnknownObjectAttributes&&i.push("throwUnknownObjectAttributes"),console.log(),console.log("  collection [%s] %s",this._name.green,i.length>0?"("+i.join(",")+")":""),console.log(),this._groups=Array.from((0,s.default)(this._groups,function(e){return e._name},function(e){return e._requires?e._requires.map(function(e){return e._name}):null}).values()),Promise.all(this._groups.map(function(e,n,u){return t._sequential&&n>0&&(r=u[n-1].execute()),e.execute(o,t,r)})).then(function(){console.log(),console.log("  %s after %s",(u+" passing").green,(Date.now()-n+" ms").magenta),console.log()}).catch(function(e){t._cancel||(t._cancel=!0,e instanceof f.default?e.log(o,n):console.log(e))})}}]),e}();t.default=h},function(e,t){e.exports=require("colors")},function(e,t){"use strict";function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=function(){function e(t,n,o,u,i){r(this,e),this._test=t,this._group=n,this._collection=o,this._reason=u,this._response=i}return o(e,[{key:"log",value:function(e){var t={collection:this._collection._name,group:this._group._name};if(void 0!==this._test._name&&null!==this._test._name&&this._test._name.length>0?t.test=this._test._name:t.test="#"+this._group._tests.indexOf(this._test),t["req-url"]=this._response.request.uri.href,t["req-method"]=this._response.request.method.toUpperCase(),["post","put","patch"].includes(this._response.request.method)&&(t["req-body"]=this._response.request.body),this._response.statusCode>=200&&![204,205].includes(this._response.statusCode)){var r=(this._response.headers["content-type"]||"").split(";")[0].toLowerCase().trim();if(r){var o=this._response.body,u=null;"text/html"===r?500===this._response.statusCode&&/<span><H1>Server Error in/i.test(o)&&(u="including only error trace from ASP.NET YSOD response",o=o.replace(/^[\s\S]*<!--([\s\S]*)-->\s*$/,"$1")):"application/json"===r&&(o=JSON.stringify(JSON.parse(o),null,4)),this._test._type&&(t["res-squalus-type"]=this._test._type),t["res-content-type"]=r,t["res-body"]=(u?"("+u+")":"")+"\n"+o}}t.context=JSON.stringify(Array.from(e.keys()).reduce(function(t,r){return Object.assign(t,n({},""+r,e.get(r)))},{}),null,4),this._reason instanceof Error?t.error=this._reason.stack:t.reason=this._reason;var i=Object.keys(t).reduce(function(e,t){return Math.max(e,t.length)},0);console.log(),console.log("  failed".red),console.log(),Object.keys(t).forEach(function(e){var n=t[e]||"";console.log("    %s%s : %s",e.yellow,n.indexOf("\n")===-1?" ".repeat(i-e.length):"",n.replace(/\n/g,"\n"+" ".repeat(8)))}),console.log()}}]),e}();t.default=u},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(t){n(this,e),this._throwUnknownObjectAttributes=!!t};t.default=r},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(t){n(this,e),this._name=t,this._requires=null,this._parallel=!1,this._session=null,this._tests=null,this._promise=null}return r(e,[{key:"requires",value:function(e){return this._requires=Array.isArray(e)?e:[e],this}},{key:"parallel",value:function(){return this._parallel=!0,this}},{key:"session",value:function(e){return this._session=e,this}},{key:"tests",value:function(e){return this._tests=e,this}},{key:"execute",value:function(e,t,n){var r=this;return this._promise||!function(){if(!t||!n)throw new Error("uninitialized promise");var o=n;r._requires&&(o=Promise.all(r._requires.map(function(t){return t.execute(n,e)}).concat([n]))),r._promise=new Promise(function(n,u){r._parallel&&!t._sequential?o.then(function(){Promise.all(r._tests.map(function(n){return n.execute(e,r,t)})).then(n,u)}):!function(){var i=r._tests.slice().reverse(),a=function o(){i.length?i.pop().execute(e,r,t).then(o,u):n()};o.then(a,u)}()})}(),this._promise}}]),e}();t.default=o},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:" ";return e.length<t?e+n.repeat(t-e.length):e}function i(e){var t=e.toString().replace(b,""),n=t.slice(t.indexOf("(")+1,t.indexOf(")")).match(m);return null===n&&(n=[]),n}function a(e,t,n,r){var o=new Map;o.set("response",t),o.set("body",n),o.set("context",r);var u=[o];return Array.from(o.values()).filter(function(e){return e instanceof Map}).forEach(function(e){return u.push(e)}),e.apply(null,i(e).map(function(e){var t=u.find(function(t){return t.has(e)});if(t)return t.get(e)}))}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),l=n(1),f=r(l),c=n(26),d=r(c),h=n(27),p=r(h),y=n(21),v=(r(y),n(22)),_=r(v),b=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,m=/([^\s,]+)/g,g=function(){function e(t){o(this,e),this._name=t,this._method=null,this._url=null,this._contentType=null,this._responseContentType=null,this._body=null,this._status=null,this._type=null,this._save=null,this._expect=null,this._promise=null}return s(e,[{key:"execute",value:function(e,t,n){var r=this;return this._promise||!function(){var o=r._url;"function"==typeof o&&(o=o(e));var i=function(t,n){return e.has(n)?e.get(n):t};o=o.replace(/[@:]([a-z0-9_]+)/gi,i),o=o.replace(/{([a-z0-9_]+)}/gi,i);var s=e.get("baseUrl")+o,l=r._body;"function"==typeof l&&(l=l(e));var c=function(e,o){return Promise.reject(new _.default(r,t,n,e,o))},d=function(e){if(!r._status||"number"!=typeof r._status)return c("invalid response status",e);if(e.statusCode!==r._status)return c("response status "+e.statusCode+" does not match expected "+r._status,e);if(r._responseContentType){var t=(e.headers["content-type"]||"").split(";",2)[0];if(t!==r._responseContentType)return c("response content type "+t+" does not match expected "+r._responseContentType,e)}return Promise.resolve(e)},h=function(e){if(r._type){var t=f.default.getType(r._type);if(!t)return c("failed to create response type "+r._type,e);try{var o=JSON.parse(e.body);e.bodyJson=o,t.validate(o,"body",!1,n._validationContext)}catch(t){return c(t,e)}return Promise.resolve(e)}return Promise.resolve(e)},y=function(t){return r._expect?Promise.all(r._expect.map(function(n,r){return Promise.resolve(a(n,t,void 0!==t.bodyJson?t.bodyJson:t.body,e)).then(function(e){return e?Promise.resolve(t):c("expect test '"+r+"' failed",t)})})).then(function(){return Promise.resolve(t)}):Promise.resolve(t)},v=function(t){return r._save?Promise.all(Array.from(r._save.keys()).map(function(n){return Promise.resolve(a(r._save.get(n),t,void 0!==t.bodyJson?t.bodyJson:t.body,e)).then(function(t){if(e.has(n))throw new Error("The context already contains key '"+n+"'");e.set(n,t)})})).then(function(){return Promise.resolve(t)}):Promise.resolve(t)},b={uri:s,method:r._method,headers:{"Content-Type":r._contentType||"application/json"},resolveWithFullResponse:!0,simple:!1},m=e.get("http_cookie__"+t._session);m&&(b.headers.Cookie=m);var g=e.get("http_authorization__"+t._session);g&&(b.headers.Authorization=g),"application/x-www-form-urlencoded"===r._contentType?b.form=l:"multipart/form-data"===r._contentType?b.formData=l:b.body=l,r._promise=(0,p.default)(b).then(function(e){return d(e)}).then(function(e){return h(e)}).then(function(e){return y(e)}).then(function(e){return v(e)}).then(function(){return n._cancel?Promise.reject():(console.log("    %s %s %s %s",u(t._name,n.getMaxGroupNameLength()).gray,u(r._method.toUpperCase(),6).magenta,o,r._name.cyan),Promise.resolve())})}(),this._promise}},{key:"get",value:function(e){return this._method="get",this._url=e,this._status=this._status||200,this}},{key:"post",value:function(e){return this._method="post",this._url=e,this._status=this._status||200,this}},{key:"put",value:function(e){return this._method="put",this._url=e,this._status=this._status||204,this}},{key:"delete",value:function(e){return this._method="delete",this._url=e,this._status=this._status||204,this}},{key:"json",value:function(e){return this._contentType="application/json","function"==typeof e?this._body=function(t){return JSON.stringify(e(t))}:this._body=JSON.stringify(e),this}},{key:"form",value:function(e){return this._contentType="application/x-www-form-urlencoded",this._body=e,this}},{key:"formData",value:function(e){this._contentType="multipart/form-data";var t=new d.default;return Object.keys(e).forEach(function(n){return t.append(n,e[n])}),this._body=t,this}},{key:"save",value:function(e,t){return this._save||(this._save=new Map),this._save.set(e,t),this}},{key:"saveCookie",value:function(e,t){return this.save("http_cookie__"+e,t)}},{key:"saveAuthorization",value:function(e,t){return this.save("http_authorization__"+e,t)}},{key:"expect",value:function(e){return"function"==typeof e?(this._expect||(this._expect=[]),this._expect.push(e)):"number"==typeof e?this._status=e:e.indexOf("/")!==-1?this._responseContentType=e:this._type=e,this}}]),e}();t.default=g},function(e,t){e.exports=require("form-data")},function(e,t){e.exports=require("request-promise")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("js-yaml")}]);
//# sourceMappingURL=squalus-node.js.map