{"version":3,"sources":["webpack:///squalus-node.js","webpack:///webpack/bootstrap 9e0cd30608cc75c04f90","webpack:///./src/SqualusNode.js","webpack:///./src/Squalus.js","webpack:///./src/Tag.js","webpack:///./src/Endpoint.js","webpack:///./src/Result.js","webpack:///./src/TopoSort.js","webpack:///./src/Type/BranchType.js","webpack:///./src/Type/NullableType.js","webpack:///./src/Type/Scalar/NullScalarType.js","webpack:///./src/Type/ScalarType.js","webpack:///./src/Type/ArrayType.js","webpack:///./src/Type/AttributeType.js","webpack:///./src/Type/ObjectType.js","webpack:///./src/Type/MapType.js","webpack:///./src/Type/Scalar/BoolScalarType.js","webpack:///./src/Type/Scalar/FloatScalarType.js","webpack:///./src/Type/Scalar/IntScalarType.js","webpack:///./src/Automation/TestCollection.js","webpack:///external \"colors\"","webpack:///./src/Automation/TestError.js","webpack:///./src/ValidationContext.js","webpack:///./src/Automation/TestGroup.js","webpack:///./src/Automation/Test.js","webpack:///external \"request-promise\"","webpack:///external \"path\"","webpack:///external \"fs\"","webpack:///external \"js-yaml\""],"names":["module","exports","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","getFiles","source","regex","files","findChildren","dir","_fs2","readdirSync","forEach","f","child","_path2","join","statSync","isDirectory","test","push","collection","name","options","_TestCollection2","group","_TestGroup2","_Test2","defineProperty","squalus","undefined","_createClass","defineProperties","target","props","i","length","descriptor","key","protoProps","staticProps","_Squalus2","_Squalus3","_TestCollection","_TestGroup","_Test","_path","_fs","_jsYaml","_jsYaml2","SqualusNode","_Squalus","this","getPrototypeOf","apply","arguments","typePath","collectionInstance","initialContextPath","types","assign","map","file","safeLoad","readFileSync","encoding","buildTypes","context","JSON","parse","execute","findPreviousTokenGroupStart","tokens","depth","j","_j","parseTokensFromType","type","dependenciesOnly","split","t","trim","filter","previous","splice","dependencies","_i","includes","buildKnownDependencies","_ScalarType2","getScalarTypes","data","parseChild","Set","keys","add","scopify","iter","scope","result","Array","from","item","indexOf","parseRoot","root","parsed","requires","createAttrFromName","_AttributeType2","replace","clone","endsWith","stripOuterParens","array","splitArray","chunks","chunk","stack","token","pop","buildType","def","branches","_ret","size","Error","branchMap","Map","branch","set","v","_BranchType2","_typeof","_MapType2","_ArrayType2","slice","_ret2","transformStart","transformName","transformArgs","transforms","attributes","attr","_ObjectType2","scopedName","registeredTypes","has","get","attributeNames","inheritanceAttr","parents","parent","_ret3","values","every","branchType","inheritedTypes","builder","k","_ret4","parentAttr","Symbol","iterator","_Tag","_Tag2","_Endpoint","_Endpoint2","_TopoSort","_TopoSort2","_BranchType","_ArrayType","_AttributeType","_ObjectType","_ScalarType","_MapType","_BoolScalarType","_BoolScalarType2","_FloatScalarType","_FloatScalarType2","_IntScalarType","_IntScalarType2","_NullScalarType","_NullScalarType2","register","Squalus","concat","sorted","d","substring","tests","ul","appendChild","class","params","url","method","build","events","change","select.test-option","onChange","click",".test-row-add","onClickAdd",".test-row-remove","onClickRemove",".test-attr-toggle","onClickToggle",".test-edit","onEdit",".test-submit","onSubmit","keypress","input[type=text],input[type=checkbox],select","onKeyPress","addEventListener","e","closest","selector","matches","func","initializeSelectionStates","isObject","isArray","appendNode","element","content","nodeType","div","document","createElement","innerHTML","firstChild","tagName","_len","args","_key","children","elem","startsWith","dataset","substr","setAttribute","closestAncestorByClassName","className","parentNode","classList","contains","convertValueToParam","val","query","encodeURI","_Result","_Result2","Endpoint","_url","_method","_params","_type","_node","Id","querySelector","_squalusType","populate","clear","querySelectorAll","param","keyPlaceholder","URL","window","location","href","searchParams","append","_this","toLowerCase","_squalusDef","names","match","data-name","getPopulatedUrl","stringify","headers","Content-Type","body","fetch","then","res","error","_this2","status","textContent","lock","ok","json","updateSingleParam","unlock","message","event","which","preventDefault","submit","edit","node","Result","relativeUrl","response","_relativeUrl","_response","Response","console","log","elements","getName","getRequires","edges","s","sources","dependency","nSource","n","mSource","find","_NullableType","_NullableType2","BranchType","_types","firstElementChild","selectedIndex","findIndex","validate","select","Event","bubbles","dispatchEvent","path","silent","some","_","nextElementSibling","toggle","nonNullTypes","NullableType","_ScalarType3","NullScalarType","createTextNode","implementations","ScalarType","_values","_parse","disabled","placeholder","_build","_validate","implementation","ArrayType","_rows","_body","row","lastElementChild","remove","AttributeType","required","_name","_required","_included","update","ObjectType","_attributes","included","_throwUnknownObjectAttributes","allowedKeys","a","diff","x","MapType","_this3","keyField","BoolScalarType","checked","FloatScalarType","parseFloat","IntScalarType","_validator","reduce","current","parts","start","parseInt","end","ranges","sort","b","fixed","rangeSize","r","_colors","_TestError","_TestError2","_ValidationContext","_ValidationContext2","TestCollection","_groups","_cancel","_sequential","sequential","_validationContext","throwUnknownObjectAttributes","_maxGroupNameLength","initial","startTime","Date","now","Promise","resolve","testCount","_tests","green","g","_requires","all","magenta","require","_defineProperty","TestError","reason","_test","_group","_collection","_reason","info","request","uri","toUpperCase","statusCode","responseContentType","responseBody","responseNote","maxInfoNameLength","Math","max","red","yellow","repeat","ValidationContext","TestGroup","_parallel","_session","_promise","groups","when","reject","reverse","onResolve","padRight","str","width","char","getParamNames","fnStr","toString","STRIP_COMMENTS","ARGUMENT_NAMES","callFuncWithParamInjection","sourceParams","maps","_requestPromise","_requestPromise2","Test","_contentType","_responseContentType","_status","_save","_expect","populateVariables","absUrl","contentType","responseType","getType","bodyJson","expect","passed","save","Cookie","resolveWithFullResponse","simple","form","formData","getMaxGroupNameLength","gray","cyan","FormData"],"mappings":"AAAAA,OAAOC,QACE,SAAUC,GCGnB,QAAAC,GAAAC,GAGA,GAAAC,EAAAD,GACA,MAAAC,GAAAD,GAAAH,OAGA,IAAAD,GAAAK,EAAAD,IACAH,WACAK,GAAAF,EACAG,QAAA,EAUA,OANAL,GAAAE,GAAAI,KAAAR,EAAAC,QAAAD,IAAAC,QAAAE,GAGAH,EAAAO,QAAA,EAGAP,EAAAC,QAvBA,GAAAI,KAqCA,OATAF,GAAAM,EAAAP,EAGAC,EAAAO,EAAAL,EAGAF,EAAAQ,EAAA,OAGAR,EAAA,KDOM,SAASH,EAAQC,EAASE,GAE/B,YAqCA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GAEvF,QAASG,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAEhH,QAASC,GAA2BC,EAAMb,GAAQ,IAAKa,EAAQ,KAAM,IAAIC,gBAAe,4DAAgE,QAAOd,GAAyB,gBAATA,IAAqC,kBAATA,GAA8Ba,EAAPb,EAElO,QAASe,GAAUC,EAAUC,GAAc,GAA0B,kBAAfA,IAA4C,OAAfA,EAAuB,KAAM,IAAIN,WAAU,iEAAoEM,GAAeD,GAASE,UAAYC,OAAOC,OAAOH,GAAcA,EAAWC,WAAaG,aAAeC,MAAON,EAAUO,YAAY,EAAOC,UAAU,EAAMC,cAAc,KAAeR,IAAYE,OAAOO,eAAiBP,OAAOO,eAAeV,EAAUC,GAAcD,EAASW,UAAYV,GElFle,QAASW,GAASC,EAAQC,GACxB,GAAMC,MAEAC,EAAe,QAAfA,GAAgBC,GAAD,MACnBC,cAAGC,YAAYF,GAAKG,QAAQ,SAAAC,GAC1B,GAAMC,GAAQC,aAAKC,KAAKP,EAAKI,EACzBH,cAAGO,SAASH,GAAOI,cACrBV,EAAaM,GACJR,EAAMa,KAAKN,IACpBN,EAAMa,KAAKN,KAUjB,OANIJ,cAAGO,SAASZ,GAAQa,cACtBV,EAAaH,GAEbE,EAAMa,KAAKf,GAGNE,EAyBT,QAASc,GAAWC,EAAMC,GACxB,MAAO,IAAAC,cAAmBF,EAAMC,GAGlC,QAASE,GAAMH,GACb,MAAO,IAAAI,cAAcJ,GAGvB,QAASH,GAAKG,GACZ,MAAO,IAAAK,cAASL,GFZjB3B,OAAOiC,eAAe3D,EAAS,cAC7B6B,OAAO,IAET7B,EAAQkD,KAAOlD,EAAQwD,MAAQxD,EAAQoD,WAAapD,EAAQ4D,QAAUC,MAEtE,IAAIC,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWtC,WAAasC,EAAWtC,aAAc,EAAOsC,EAAWpC,cAAe,EAAU,SAAWoC,KAAYA,EAAWrC,UAAW,GAAML,OAAOiC,eAAeK,EAAQI,EAAWC,IAAKD,IAAiB,MAAO,UAAUnD,EAAaqD,EAAYC,GAAiJ,MAA9HD,IAAYP,EAAiB9C,EAAYQ,UAAW6C,GAAiBC,GAAaR,EAAiB9C,EAAasD,GAAqBtD,MEtDjiBuD,EAAAtE,EAAA,GF0DKuE,EAAY9D,EAAuB6D,GEzDxCE,EAAAxE,EAAA,IF6DKqD,EAAmB5C,EAAuB+D,GE5D/CC,EAAAzE,EAAA,IFgEKuD,EAAc9C,EAAuBgE,GE/D1CC,EAAA1E,EAAA,IFmEKwD,EAAS/C,EAAuBiE,GElErCC,EAAA3E,EAAA,IFsEK4C,EAASnC,EAAuBkE,GErErCC,EAAA5E,EAAA,IFyEKuC,EAAO9B,EAAuBmE,GExEnCC,EAAA7E,EAAA,IF4EK8E,EAAWrE,EAAuBoE,GEpDjCE,EFqFa,SAAUC,GAG1B,QAASD,KAGP,MAFAlE,GAAgBoE,KAAMF,GAEf9D,EAA2BgE,KAAMzD,OAAO0D,eAAeH,GAAaI,MAAMF,KAAMG,YAyBzF,MA9BAhE,GAAU2D,EAAaC,GAQvBpB,EAAamB,EAAa,OACxBZ,IAAK,UACLxC,MAAO,SE9FK0D,EAAUC,EAAoBC,GAC3C,GAAMnD,GAAQH,EAASoD,EAAU,UAEjC,IAAIjD,EAAM6B,OAAQ,CAChB,GAAMuB,GAAQhE,OAAOiE,OAAON,MAAM,KAChC/C,EAAMsD,IAAI,SAAAC,GAAA,MAAQb,cAAKc,SAASrD,aAAGsD,aAAaF,GAAQG,SAAU,YAGpEvB,cAAQwB,WAAWP,GAGrB,GAAIQ,GAAUrC,MAKd,OAJI4B,KACFS,EAAUC,KAAKC,MAAM3D,aAAGsD,aAAaN,GAAsBO,SAAU,WAGhER,EAAmBa,QAAQH,OFkG5BjB,GACPR,aAcFzE,GEjGuB4D,QAAfqB,EFkGRjF,EElGgCoD,aFmGhCpD,EEnG4CwD,QFoG5CxD,EEpGmDkD,QFwG9C,SAASnD,EAAQC,EAASE,GAE/B,YA8DA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GAEvF,QAASG,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCGnNjH,QAASoF,GAA4BC,EAAQrC,GAC3C,GAAkB,MAAdqC,EAAOrC,IAET,IAAK,GADDsC,GAAQ,EACHC,EAAIvC,EAAI,EAAGuC,GAAK,EAAGA,IAC1B,GAAkB,MAAdF,EAAOE,KACPD,MACG,IAAkB,MAAdD,EAAOE,GAAY,CAC5B,GAAc,IAAVD,EACF,MAAOF,GAA4BC,EAAQE,EAAI,KAE/CD,OAGD,IAAkB,MAAdD,EAAOrC,IAChB,IAAK,GAAIwC,GAAIxC,EAAI,EAAGwC,GAAK,EAAGA,IAC1B,GAAkB,MAAdH,EAAOG,GACT,MAAOJ,GAA4BC,EAAQG,EAAI,OAG9C,IAAkB,OAAdH,EAAOrC,GAChB,MAAOoC,GAA4BC,EAAQrC,EAAI,EAGjD,OAAOA,IAAK,EAAIA,EAAI,EAGtB,QAASyC,GAAoBC,EAAMC,GAiBjC,IAAK,GAHCN,GAASK,EAAKE,MAAM,0BAA0BlB,IAAI,SAAAmB,GAAA,MAAKA,GAAEC,SAAQC,OAAO,SAAAF,GAAA,MAAW,KAANA,IAG1E7C,EAAI,EAAGA,EAAIqC,EAAOpC,OAAQD,IACjC,GAAkB,MAAdqC,EAAOrC,GAAY,CACrB,GAAMgD,GAAWZ,EAA4BC,EAAQrC,EAAI,EACzDqC,GAAOY,OAAOD,EAAU,EAAG,KAC3BX,EAAOY,OAAOjD,EAAI,EAAG,EAAG,IAAK,OAAQ,OACnCA,EAIN,IAAK2C,EACH,MAAON,EAWT,KAAK,GADCa,MACGC,EAAI,EAAGA,EAAId,EAAOpC,OAAQkD,IACjC,GAAkB,MAAdd,EAAOc,GAKJ,GAAkB,MAAdd,EAAOc,IAKN,KAAM,KAAM,IAAK,IAAK,IAAK,KAAKC,SAASf,EAAOc,KAG5DD,EAAajE,KAAKoD,EAAOc,QAPvB,MAAqB,MAAdd,EAAOc,MACVA,MANJ,MAAqB,MAAdd,EAAOc,MACVA,CAcR,OAAOD,GAGT,QAASG,KACP,MAAOC,cAAWC,iBAAiB7B,IAAI,SAAAmB,GAAA,OACrC1D,KAAM0D,EACNW,KAAMX,KAIV,QAASY,GAAWjC,GAClB,GAAM0B,GAAe,GAAIQ,IAYzB,OAVAlG,QAAOmG,KAAKnC,GAAO/C,QAAQ,SAAA0B,GACzB,GAAMuC,GAAOlB,EAAMrB,EAEC,iBAATuC,GACTD,EAAoBC,GAAM,GAAMjE,QAAQ,SAAAoE,GAAA,MAAKK,GAAaU,IAAIf,KAE9DY,EAAWf,GAAMjE,QAAQ,SAAAoE,GAAA,MAAKK,GAAaU,IAAIf,OAI5CK,EAGT,QAASW,GAAQC,EAAMC,GACrB,GAAI7F,GAAS4F,CACO,iBAATA,KACT5F,GAAU4F,GAEZ,IAAME,GAASC,MAAMC,KAAKhG,EAAQ,SAAAiG,GAAA,MACV,KAAtBA,EAAKC,QAAQ,MAAqC,KAAtBD,EAAKC,QAAQ,MAAqC,KAAtBD,EAAKC,QAAQ,MAC/C,KAAtBD,EAAKC,QAAQ,MAAgBd,aAAWC,iBAAiBH,SAASe,GAE9DA,EADGJ,EAHkC,IAGzBI,GAIlB,OAAwB,gBAATL,GAAqBE,EAAO,GAAKA,EAGlD,QAASK,GAAUC,GACjB,GAAMC,KAsBN,OApBA/G,QAAOmG,KAAKW,GAAM7F,QAAQ,SAAAsF,GACxBvG,OAAOmG,KAAKW,EAAKP,IAAQtF,QAAQ,SAAAU,GAC/B,GAAMuD,GAAO4B,EAAKP,GAAO5E,GAEnBqF,EAAW,GAAId,IAED,iBAAThB,GACTD,EAAoBC,GAAM,GAAMjE,QAAQ,SAAAoE,GAAA,MAAK2B,GAASZ,IAAIf,KAE1DY,EAAWf,GAAMjE,QAAQ,SAAAoE,GAAA,MAAK2B,GAASZ,IAAIf,KAG7C0B,EAAOtF,MACLE,KAAM0E,EAAQ1E,EAAM4E,GACpBS,SAAUX,EAAQW,EAAUT,GAC5BP,KAAMd,QAKL6B,EAGT,QAASE,GAAmBtF,EAAMuD,GAChC,MAAO,IAAAgC,cAAkBvF,EAAKwF,QAAQ,MAAO,IAAKjC,EAAKkC,SAAUzF,EAAK0F,SAAS,MAGjF,QAASC,GAAiBC,GACP,MAAbA,EAAM,IAA0C,MAA5BA,EAAMA,EAAM9E,OAAS,KAC3C8E,EAAM9B,OAAO8B,EAAM9E,OAAS,GAC5B8E,EAAM9B,OAAO,EAAG,IAIpB,QAAS+B,GAAWD,EAAOnC,GACzBkC,EAAiBC,EAEjB,IAAME,MACFC,KACEC,IAuBN,OAtBAJ,GAAMtG,QAAQ,SAAA2G,GACE,MAAVA,GACFD,EAAMlG,MAAK,GACXiG,EAAMjG,KAAKmG,IACQ,MAAVA,GACTD,EAAME,MACNH,EAAMjG,KAAKmG,IACDD,EAAMlF,QAAUmF,IAAUxC,EAMpCsC,EAAMjG,KAAKmG,IALPF,EAAMjF,QACRgF,EAAOhG,KAAKiG,GAEdA,QAKAA,EAAMjF,QACRgF,EAAOhG,KAAKiG,GAGdD,EAAOxG,QAAQ,SAAAlC,GAAA,MAAKuI,GAAiBvI,KAE9B0I,EAGT,QAASK,GAAUC,EAAKxB,GAOtB,GALmB,iBAARwB,KACTA,EAAMA,EAAM,aAAe,eAIV,gBAARA,GAAkB,CAC3B,GAAMlD,GAASI,EAAoB8C,GAE7BC,EAAWR,EAAW3C,EAAQ,IACpC,IAAImD,EAASvF,OAAS,EAAG,IAAAwF,GAAA,WACvB,GAAID,EAASvF,SAAW,GAAIyD,KAAI8B,GAAUE,KACxC,KAAM,IAAIC,OAAM,iCAElB,IAAMC,GAAY,GAAIC,IAItB,OAHAL,GAAS/G,QAAQ,SAAAqH,GACfF,EAAUG,IAAID,EAAQR,EAAUzB,EAAQiC,EAAOjH,KAAK,IAAKkF,QAE3DiC,EAAOC,aAAWxI,OAAOmI,MARF,mCAAAH,GAAA,YAAAS,EAAAT,IAAA,MAAAA,GAAAO,EAWzB,GAAMtE,GAAMsD,EAAW3C,EAAQ,KAC/B,IAAIX,EAAIzB,OAAS,EACf,MAAO,IAAAkG,cAAYb,EAAU5D,EAAI,GAAG7C,KAAK,IAAKkF,GAAQuB,EAAU5D,EAAI,GAAG7C,KAAK,IAAKkF,GAGnF,IAAkC,OAA9B1B,EAAOA,EAAOpC,OAAS,GACzB,MAAO,IAAAmG,cAAcd,EAAUjD,EAAOgE,MAAM,EAAGhE,EAAOpC,OAAS,GAAGpB,KAAK,IAAKkF,GAG9E,IAAkC,MAA9B1B,EAAOA,EAAOpC,OAAS,GACzB,MAAOqD,cAAW7F,OAChB4E,EAAOA,EAAO+B,QAAQ,KAAO,GAC7B/B,EAAOgE,MAAMhE,EAAO+B,QAAQ,KAAO,EAAG/B,EAAOpC,OAAS,GAAG8C,OAAO,SAAAF,GAAA,MAAW,MAANA,IAIzE,IAAkC,MAA9BR,EAAOA,EAAOpC,OAAS,GAAY,IAAAqG,GAAA,WACrC,GAAMC,GAAiBlE,EAAO+B,QAAQ,KAChCoC,EAAgBnE,EAAOkE,EAAiB,GACxCE,EAAgBpE,EAAOgE,MAAME,EAAiB,EAAGlE,EAAOpC,OAAS,GAAG8C,OAAO,SAAAF,GAAA,MAAW,MAANA,IAEhF6D,GACJhF,IAAK,SAAAgB,GACH,GAAMkD,GAAY,GAAIC,IAOtB,OANAnD,GAAKiE,aAAalI,QAAQ,SAAAmI,GAAA,MACxBhB,GAAUG,IAAIa,EAAKzH,OAAQ,GAAA0H,eACzB,GAAAnC,cAAkB+B,EAAc,GAAInD,aAAW7F,OAAO,UAAWmJ,EAAKzH,UAAU,GAChF,GAAAuF,cAAkB+B,EAAc,GAAIG,EAAKlE,OAAOkC,SAAS,QAGtD,GAAAqB,cAAeL,IAG1B,KAAKc,EAAWF,GACd,KAAM,IAAIb,OAAM,wBAElB,QAAAK,EAAOU,EAAWF,GAAelB,EAAUjD,EAAOgE,MAAM,EAAGE,GAAgB1H,KAAK,IAAKkF,OApBhD,mCAAAuC,GAAA,YAAAJ,EAAAI,IAAA,MAAAA,GAAAN,EAuBvC,GAAMc,GAAajD,EAAQxB,EAAOxD,KAAK,IAAKkF,EAC5C,OAAIgD,GAAgBC,IAAIF,GACfC,EAAgBE,IAAIH,GAAYlC,QAElCtB,aAAW7F,OAAOqJ,GAI3B,GAAMI,GAAiB1J,OAAOmG,KAAK4B,GAAKxC,OAAO,SAAA5C,GAAA,MAAe,MAARA,IAChDgH,EAAkB5B,EAAI,IAC5B,IAAI4B,EAAiB,CACnB,GAA+B,gBAApBA,GACT,KAAM,IAAIxB,OAAM,yCAGlB,IAAMyB,GAAU3E,EAAoB0E,GAAiBpE,OAAO,SAAAF,GAAA,MAAW,MAANA,IAAWnB,IAAI,SAAA2F,GAAA,MAC9EN,GAAgBE,IAAIpD,EAAQwD,EAAQtD,KAGtC,IAAuB,IAAnBqD,EAAQnH,QAAgBmH,EAAQ,YAARnB,cAAkC,IAAAqB,GAAA,WAC5D,GAAMD,GAASD,EAAQ,EACvB,KAAKnD,MAAMC,KAAKmD,EAAO7F,MAAM+F,UAAUC,MAAM,SAAAC,GAAA,MAAcA,aAAsBjK,UAC/E,KAAM,IAAImI,OAAM,0CAGlB,IAAM+B,GAAiB,GAAI7B,IAoB3B,OAnBAwB,GAAO7F,MAAM/C,QAAQ,SAACgJ,EAAYtH,GAChC,GAAMwH,GAAU,SAAC9E,EAAG+E,GAElB,GAAMjB,GAAa,GAAId,IACvBhD,GAAE8D,aAAalI,QAAQ,SAAAmI,GACrBD,EAAWZ,IAAIa,EAAKzH,OAAQyH,EAAKhC,WAEnCsC,EAAezI,QAAQ,SAAAmI,GAAA,MACrBD,GAAWZ,IAAIa,EAAK9D,KAAK,KAAM2B,EAAmBmC,EAAMtB,EAAUC,EAAIqB,GAAO7C,OAE/E2D,EAAe3B,IAAI6B,EAAG,GAAAf,cAAe5C,MAAMC,KAAKyC,EAAWY,YAGzDE,aAAAxB,cACFwB,EAAWjG,MAAM/C,QAAQ,SAACoE,EAAG+E,GAAJ,MAAUD,GAAQ9E,EAAM1C,EAAd,IAAqByH,KAExDD,EAAQF,EAAYtH,MAGxB6F,EAAO,GAAAC,cAAeyB,MA1BsC,mCAAAJ,GAAA,YAAApB,EAAAoB,IAAA,MAAAA,GAAAtB,MA2BvD,IAAIoB,EAAQI,MAAM,SAAAH,GAAA,MAAUA,aAAAR,gBAA+B,IAAAgB,GAAA,WAEhE,GAAMlB,GAAa,GAAId,IASvB,OARAuB,GAAQ3I,QAAQ,SAAA4I,GACdA,EAAOV,aAAalI,QAAQ,SAAAqJ,GAC1BnB,EAAWZ,IAAI+B,EAAYA,EAAWlD,aAG1CsC,EAAezI,QAAQ,SAAAmI,GAAA,MACrBD,GAAWZ,IAAIa,EAAK9D,KAAK,KAAM2B,EAAmBmC,EAAMtB,EAAUC,EAAIqB,GAAO7C,QAE/EiC,EAAO,GAAAa,cAAe5C,MAAMC,KAAKyC,EAAWY,cAXoB,mCAAAM,GAAA,YAAA3B,EAAA2B,IAAA,MAAAA,GAAA7B,EAclE,KAAM,IAAIL,OAAM,uBAIlB,MAAO,IAAAkB,cAAeK,EAAexF,IAAI,SAAAkF,GAAA,MAAQnC,GAAmBmC,EAAMtB,EAAUC,EAAIqB,GAAO7C,OHtKhGvG,OAAOiC,eAAe3D,EAAS,cAC7B6B,OAAO,GAGT,IAAIiC,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWtC,WAAasC,EAAWtC,aAAc,EAAOsC,EAAWpC,cAAe,EAAU,SAAWoC,KAAYA,EAAWrC,UAAW,GAAML,OAAOiC,eAAeK,EAAQI,EAAWC,IAAKD,IAAiB,MAAO,UAAUnD,EAAaqD,EAAYC,GAAiJ,MAA9HD,IAAYP,EAAiB9C,EAAYQ,UAAW6C,GAAiBC,GAAaR,EAAiB9C,EAAasD,GAAqBtD,MAE5hBmJ,EAA4B,kBAAX6B,SAAoD,gBAApBA,QAAOC,SAAwB,SAAUtL,GAAO,aAAcA,IAAS,SAAUA,GAAO,MAAOA,IAAyB,kBAAXqL,SAAyBrL,EAAIgB,cAAgBqK,OAAS,eAAkBrL,IGlL3OuL,EAAAjM,EAAA,GHsLKkM,EAAQzL,EAAuBwL,GGrLpCE,EAAAnM,EAAA,GHyLKoM,EAAa3L,EAAuB0L,GGxLzCE,EAAArM,EAAA,GH4LKsM,EAAa7L,EAAuB4L,GG1LzCE,EAAAvM,EAAA,GH8LKiK,EAAexJ,EAAuB8L,GG7L3CC,EAAAxM,EAAA,IHiMKoK,EAAc3J,EAAuB+L,GGhM1CC,EAAAzM,EAAA,IHoMK0I,EAAkBjI,EAAuBgM,GGnM9CC,EAAA1M,EAAA,IHuMK6K,EAAepK,EAAuBiM,GGtM3CC,EAAA3M,EAAA,GH0MKsH,EAAe7G,EAAuBkM,GGzM3CC,EAAA5M,EAAA,IH6MKmK,EAAY1J,EAAuBmM,GG3MxCC,EAAA7M,EAAA,IH+MK8M,EAAmBrM,EAAuBoM,GG9M/CE,EAAA/M,EAAA,IHkNKgN,EAAoBvM,EAAuBsM,GGjNhDE,EAAAjN,EAAA,IHqNKkN,EAAkBzM,EAAuBwM,GGpN9CE,EAAAnN,EAAA,GHwNKoN,EAAmB3M,EAAuB0M,EGtN/C7F,cAAW+F,SAAS,OAApBD,cACA9F,aAAW+F,UAAU,MAAO,QAA5BH,cACA5F,aAAW+F,SAAS,QAApBL,cACA1F,aAAW+F,SAAS,OAApBP,aAEA,IAAM/B,GAAkB,GAAIlB,KAgUPyD,EH2QN,WACZ,QAASA,KACPzM,EAAgBoE,KAAMqI,GA+ExB,MA5EA1J,GAAa0J,EAAS,OACpBnJ,IAAK,UACLxC,MAAO,SGhRKwB,GACb,MAAO4H,GAAgBE,IAAI9H,MHmR1BgB,IAAK,aACLxC,MAAO,SGjRQ2G,GAEhB,GAAMpB,GAAeG,IAAyBkG,OAAOlF,EAAUC,IACzDkF,GAAS,EAAAlB,cAASpF,EAAc,SAAAuG,GAAA,MAAKA,GAAEtK,MAAM,SAAAsK,GAAA,MAAKA,GAAEjF,UAE1DgF,GAAO/K,QAAQ,SAACiE,EAAMvD,GACpB,GAAM4E,GAAQ5E,EAAKiF,QAAQ,KAAOjF,EAAKuK,UAAU,EAAGvK,EAAKiF,QAAQ,MAAQ,IACzE2C,GAAgBhB,IAAI5G,EAAMmG,EAAU5C,EAAKc,KAAMO,SHyRhD5D,IAAK,aACLxC,MAAO,SGtRQgM,EAAOrF,GACvB,GAAMsF,GAAKtF,EAAKuF,aAAY,EAAA3B,cAAE,MAAQ4B,QAAO,cAE7CH,GAAMlL,QAAQ,SAAAO,GACZ,GAAM+K,GAAS,GAAIlE,IACf7G,GAAK+K,QACPvM,OAAOmG,KAAK3E,EAAK+K,QAAQtL,QAAQ,SAAA0B,GAC/B4J,EAAOhE,IAAI5F,EAAKmF,EAAUtG,EAAK+K,OAAO5J,MAG1C,IAAMoF,GAAM,GAAA6C,cAAapJ,EAAKgL,IAAKhL,EAAKiL,OAAQF,EAAQ/K,EAAKwE,KAAO8B,EAAUtG,EAAKwE,MAAQ,KAC3FoG,GAAGC,aAAY,EAAA3B,cAAE,KAAM3C,EAAI2E,WAG7B,IAAMC,IACJC,QACEC,qBAAsBpE,aAAWqE,UAEnCC,OACEC,gBAAiBpE,aAAUqE,WAC3BC,mBAAoBtE,aAAUuE,cAC9BC,oBAAqBlG,aAAcmG,cACnCC,aAAc1C,aAAS2C,OACvBC,eAAgB5C,aAAS6C,UAE3BC,UACEC,+CAAgD/C,aAASgD,YAK7D5N,QAAOmG,KAAKwG,GAAQ1L,QAAQ,SAAAiE,GAC1B4B,EAAK+G,iBAAiB3I,EAAM,SAAA4I,GACtBA,EAAExL,SAAQ,WACZ,GAAMyF,GAAM6C,aAASmD,QAAQD,EAAExL,OAC3ByF,IACF/H,OAAOmG,KAAKwG,EAAOzH,IAAOjE,QAAQ,SAAA+M,GAChC,GAAIF,EAAExL,OAAO2L,QAAQD,GAAW,CAC9B,GAAME,GAAOvB,EAAOzH,GAAM8I,EAC1BE,GAAKJ,EAAG/F,aAQpBU,aAAW0F,0BAA0BrH,OH4R/BgF,IAGTxN,cG/VoBwN,GHmWf,SAASzN,EAAQC,GAEtB,YIzrBD,SAAS8P,GAASlP,GAChB,MAAOA,KAAQc,OAAOd,KAASuH,MAAM4H,QAAQnP,GAG/C,QAASoP,GAAWC,EAASC,GAC3B,GAAIA,GAAWA,EAAQC,SACrBF,EAAQlC,YAAYmC,OACf,CACL,GAAME,GAAMC,SAASC,cAAc,MAGnC,KAFAF,EAAIG,UAAyB1M,SAAZqM,EAAyB,GAAKA,EAExCE,EAAII,YACTP,EAAQlC,YAAYqC,EAAII,aJ+qB7B9O,OAAOiC,eAAe3D,EAAS,cAC7B6B,OAAO,IAGT7B,aI7qBc,SAAUyQ,GAAkB,OAAAC,GAAApL,UAAAnB,OAANwM,EAAMxI,MAAAuI,EAAA,EAAAA,EAAA,KAAAE,EAAA,EAAAF,EAAAE,MAAND,EAAMC,EAAA,GAAAtL,UAAAsL,EACzC,IAAM/F,GAAc8F,EAAKxM,QAAU2L,EAASa,EAAK,MAAQA,EAAK,GAAGR,SAAYQ,EAAK,MAC5EE,EAAWF,EAAKpG,MAAOoG,EAAK,KAAO9F,EAAc,EAAI,GAErDiG,EAAOT,SAASC,cAAcG,EAsBpC,OApBA/O,QAAOmG,KAAKgD,GAAYlI,QAAQ,SAAAU,GAC1BA,EAAK0N,WAAW,SAClBD,EAAKE,QAAQ3N,EAAK4N,OAAO,IAAMpG,EAAWxH,GACjCA,EAAK0N,WAAW,KACzBD,EAAKzN,GAAQwH,EAAWxH,GAExByN,EAAKI,aAAa7N,EAAMwH,EAAWxH,MAIvCwN,EAASlO,QAAQ,SAACE,GACZsF,MAAM4H,QAAQlN,GAChBA,EAAMF,QAAQ,SAAClC,GACbuP,EAAWc,EAAMrQ,KAGnBuP,EAAWc,EAAMjO,KAIdiO,IJysBH,SAAS/Q,EAAQC,EAASE,GAE/B,YAkBA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GAEvF,QAASG,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCKzwBjH,QAASiQ,GAA2BL,EAAMM,GAExC,IADA,GAAI5B,GAAIsB,EAAKO,WACN7B,GAAG,CACR,GAAIA,EAAE8B,WAAa9B,EAAE8B,UAAUC,SAASH,GACtC,MAAO5B,EAETA,GAAIA,EAAE6B,WAER,MAAO,MAGT,QAASG,GAAoBC,EAAKpN,EAAKqN,GACjCvJ,MAAM4H,QAAQ0B,GAChBA,EAAI9O,QAAQ,SAAC0F,EAAMnE,GAAP,MACVsN,GAAoBnJ,EAAShE,EAA7B,IAAoCH,EAApC,IAA0CwN,KAEpB,YAAf,mBAAOD,GAAP,YAAArH,EAAOqH,IAChB/P,OAAOmG,KAAK4J,GAAK9O,QAAQ,SAACU,GAAD,MACvBmO,GAAoBC,EAAIpO,GAAUgB,EAAlC,IAAyChB,EAAzC,IAAkDqO,KAE5B,iBAARD,GAChBC,EAAMzH,IAAI5F,EAAKsN,UAAUF,EAAM,EAAI,IAEnCC,EAAMzH,IAAI5F,EAAKsN,UAAUF,ILguB5B/P,OAAOiC,eAAe3D,EAAS,cAC7B6B,OAAO,GAGT,IAAIiC,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWtC,WAAasC,EAAWtC,aAAc,EAAOsC,EAAWpC,cAAe,EAAU,SAAWoC,KAAYA,EAAWrC,UAAW,GAAML,OAAOiC,eAAeK,EAAQI,EAAWC,IAAKD,IAAiB,MAAO,UAAUnD,EAAaqD,EAAYC,GAAiJ,MAA9HD,IAAYP,EAAiB9C,EAAYQ,UAAW6C,GAAiBC,GAAaR,EAAiB9C,EAAasD,GAAqBtD,MAE5hBmJ,EAA4B,kBAAX6B,SAAoD,gBAApBA,QAAOC,SAAwB,SAAUtL,GAAO,aAAcA,IAAS,SAAUA,GAAO,MAAOA,IAAyB,kBAAXqL,SAAyBrL,EAAIgB,cAAgBqK,OAAS,eAAkBrL,IKhwB3OuL,EAAAjM,EAAA,GLowBKkM,EAAQzL,EAAuBwL,GKnwBpCyF,EAAA1R,EAAA,GLuwBK2R,EAAWlR,EAAuBiR,GK1uBlBE,EL2wBL,WKzwBd,QAAAA,GAAY5D,EAAKC,EAAQF,EAAQrH,GAAM7F,EAAAoE,KAAA2M,GACrC3M,KAAK4M,KAAO7D,EACZ/I,KAAK6M,QAAU7D,EACfhJ,KAAK8M,QAAWhE,GAAUA,EAAOrE,KAAQqE,EAAS,KAClD9I,KAAK+M,MAAQtL,EAEbzB,KAAKgN,MAAQ,KLm+Bd,MApNArO,GAAagO,IACXzN,IAAK,oBACLxC,MAAO,SK9wBQ6F,GACZvC,KAAK8M,SACHvK,EAAK0K,IACPjN,KAAKgN,MAAME,cAAc,eAAeC,aAAaC,SAAS7K,EAAK0K,OLmxBtE/N,IAAK,QACLxC,MAAO,WK9wBR,MAAKsD,MAAK+M,MAGH/M,KAAK+M,MAAMrQ,QAFT,QLoxBRwC,IAAK,WACLxC,MAAO,SKhxBD6F,EAAMhC,GACbP,KAAK+M,MAAMK,SAAS7K,EAAM,OAAQhC,MLmxBjCrB,IAAK,QACLxC,MAAO,WKhxBRsD,KAAK+M,MAAMM,WLoxBVnO,IAAK,OACLxC,MAAO,eAKPwC,IAAK,SACLxC,MAAO,eAIPwC,IAAK,kBACLxC,MAAO,WKnxBR,GAAM6P,GAAQ,GAAI3H,KACdmE,EAAM/I,KAAK4M,IAmBf,OAlBI5M,MAAK8M,SACP9J,MAAMC,KAAKjD,KAAKgN,MAAMM,iBAAiB,gBAAgB9P,QAAQ,SAAA+P,GAC7D,GAAMrO,GAAMqO,EAAM1B,QAAQ3N,KACpBsP,EAAA,IAAqBtO,EAArB,IACAoN,EAAMiB,EAAMJ,aAAazQ,OACK,MAAhCqM,EAAI5F,QAAQqK,GACF,OAARlB,GAAwB,KAARA,GAClBD,EAAoBC,EAAKpN,EAAKqN,GAGhCxD,EAAMA,EAAIrF,QAAQ8J,EAAgBhB,UAAUF,MAKlDvD,EAAM,GAAI0E,KAAI1E,EAAK2E,OAAOC,SAASC,MACnCrB,EAAM/O,QAAQ,SAACd,EAAOwC,GAAR,MAAgB6J,GAAI8E,aAAaC,OAAO5O,EAAKxC,KAEpDqM,KLyxBN7J,IAAK,QACLxC,MAAO,WKvxBF,GAAAqR,GAAA/N,IACNA,MAAKgN,OAAQ,EAAA/F,cAAE,OAAS4B,QAAA,4BAAmC7I,KAAK6M,QAAQmB,cAAiBC,YAAajO,OACpG,EAAAiH,cAAE,OAAS4B,QAAO,oBAChB,EAAA5B,cAAE,QAAU4B,QAAO,mBAAqB7I,KAAK6M,UAC7C,EAAA5F,cAAE,QAAU4B,QAAO,gBAAkB7I,KAAK4M,OAI9C,IAAM7O,GAAOiC,KAAKgN,MAAMpE,aAAY,EAAA3B,cAAE,OAAS4B,QAAO,kBA8CtD,OA5CI7I,MAAK8M,UAAS,WAChB,GAAMoB,GAAQH,EAAKnB,KAAKuB,MAAM,cAAc1N,IAAI,SAAApF,GAAA,MAAKA,GAAEyQ,OAAO,EAAGzQ,EAAE2D,OAAS,IAExE+O,GAAKjB,QAAQrI,KAAOyJ,EAAMlP,QAC5BkP,EAAM5R,UAAU0B,KAAKkC,MAAMgO,EAAOlL,MAAMC,KAAK8K,EAAKjB,QAAQpK,QAAQZ,OAAO,SAAAvG,GAAA,OAAM2S,EAAM/L,SAAS5G,KAGhG,IAAMuN,GAAS/K,EAAK6K,aAAY,EAAA3B,cAAE,OAAS4B,QAAO,yBAChD,EAAA5B,cAAE,OAAS4B,QAAO,uBAAyB,WAE7CC,GAAOF,aAAY,EAAA3B,cAAE,SACnB,EAAAA,cAAE,QACAiH,EAAMzN,IAAI,SAAA8M,GACR,GAAM9L,GAAOsM,EAAKjB,QAAQ9G,IAAIuH,EAC9B,IAAa7O,SAAT+C,EACF,KAAM,IAAIiD,OAAM,oCAElB,QAAO,EAAAuC,cAAE,MAAQ4B,QAAO,aAAcuF,YAAab,EAAOJ,aAAc1L,IACtE,EAAAwF,cAAE,KAAMsG,IACR,EAAAtG,cAAE,KAAMxF,EAAKwH,eAKA,QAAjB8E,EAAKlB,SACP9O,EAAK6K,aAAY,EAAA3B,cAAE,OAAS4B,QAAO,2BACjC,EAAA5B,cAAE,SAAWxF,KAAM,SAAU/E,MAAO,OAAQmM,QAAO,eACnD,EAAA5B,cAAE,QAAU4B,QAAO,+CAKrB7I,KAAK+M,OACPhP,EAAK6K,aAAY,EAAA3B,cAAE,OAAS4B,QAAO,uBACjC,EAAA5B,cAAE,OAAS4B,QAAO,uBAAyB,QAC3C7I,KAAK+M,MAAM9D,UAIflL,EAAK6K,aAAY,EAAA3B,cAAE,OAAS4B,QAAO,2BACjC,EAAA5B,cAAE,SAAWxF,KAAM,SAAU/E,MAAOsD,KAAK6M,QAAShE,QAAO,iBACzD,EAAA5B,cAAE,QAAU4B,QAAO,2BAGd7I,KAAKgN,SL2wBX9N,IAAK,SACLxC,MAAO,WKvwBR,GAAMqM,GAAM/I,KAAKqO,kBACX3R,EAAQsE,KAAKsN,UAAUtO,KAAKtD,SAE5ByB,GACJ6K,OAAQhJ,KAAK6M,QACb0B,SACEC,eAAgB,sBAGf,MAAO,OAAQ,SAASrM,SAASnC,KAAK6M,WACzC1O,EAAQsQ,KAAO/R,GAGjBgS,MAAM3F,EAAK5K,GAASwQ,KAAK,SAAAC,GACvB,GAAAlC,cAAW3D,EAAK6F,GAAK3N,UADvByN,SAES,SAAAG,GACP,GAAAnC,cAAW3D,EAAK8F,GAAO5N,aL6wBxB/B,IAAK,OACLxC,MAAO,WK1wBH,GAAAoS,GAAA9O,KACC+I,EAAM/I,KAAKqO,kBACXU,EAAS/O,KAAKgN,MAAME,cAAc,oBAExC6B,GAAOC,YAAc,GAErBhP,KAAKqN,QACLrN,KAAKiP,OAELP,MAAM3F,GAAK4F,KAAK,SAAAC,GASd,MAAKA,GAAIM,OAMTN,GAAIO,OAAOR,KAAK,SAAAQ,GACd,GAAI5M,GAAO4M,CAIPnM,OAAM4H,QAAQrI,KACZA,EAAKvD,QAAU8P,EAAKhC,SAAiC,IAAtBgC,EAAKhC,QAAQrI,MAC9CsK,EAAOC,YAAP,wBAA6CzM,EAAKvD,OAAlD,UACAuD,EAAOA,EAAK,GACZuM,EAAKM,kBAAkB7M,IAEvBA,EAAO,MAGPA,EACFuM,EAAK1B,SAAS7K,GAEdwM,EAAOC,YAAc,uBAGvBF,EAAKO,YAzBLN,EAAOC,YAAc,2BACrBF,GAAKO,YAXTX,SAqCS,SAAAG,GACPE,EAAOC,YAAcH,EAAMS,QAC3BR,EAAKO,gBLgxBNnQ,IAAK,aACLxC,MAAO,SK7wBQ6S,EAAOjL,GACH,KAAhBiL,EAAMC,QACRD,EAAME,kBACLnL,GAAOtE,KAAKsK,QAAQiF,EAAM1Q,SAAS6Q,aLixBrCxQ,IAAK,WACLxC,MAAO,SK9wBM6S,EAAOjL,IACpBA,GAAOtE,KAAKsK,QAAQiF,EAAM1Q,SAAS6Q,YLixBnCxQ,IAAK,SACLxC,MAAO,SK/wBI6S,EAAOjL,IAClBA,GAAOtE,KAAKsK,QAAQiF,EAAM1Q,SAAS8Q,ULkxBnCzQ,IAAK,UACLxC,MAAO,SKhxBKiP,GACb,GAAMiE,GAAO5D,EAA2BL,EAAM,WAC9C,OAAOiE,GAAOA,EAAK3B,YAAc,SLoxB3BtB,IAGT9R,cK9+BoB8R,GLk/Bf,SAAS/R,EAAQC,GAEtB,YAQA,SAASe,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCANhHQ,OAAOiC,eAAe3D,EAAS,cAC7B6B,OAAO,GAGT,IAAIiC,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWtC,WAAasC,EAAWtC,aAAc,EAAOsC,EAAWpC,cAAe,EAAU,SAAWoC,KAAYA,EAAWrC,UAAW,GAAML,OAAOiC,eAAeK,EAAQI,EAAWC,IAAKD,IAAiB,MAAO,UAAUnD,EAAaqD,EAAYC,GAAiJ,MAA9HD,IAAYP,EAAiB9C,EAAYQ,UAAW6C,GAAiBC,GAAaR,EAAiB9C,EAAasD,GAAqBtD,MMvhC5gB+T,EN2hCP,WMzhCZ,QAAAA,GAAYC,EAAaC,GAAUnU,EAAAoE,KAAA6P,GACjC7P,KAAKgQ,aAAeF,EACpB9P,KAAKiQ,UAAYF,EN8iClB,MAfApR,GAAakR,IACX3Q,IAAK,QACLxC,MAAO,WM7hCJsD,KAAKiQ,oBAAqBC,UACxBlQ,KAAKiQ,UAAUf,GAMnBiB,QAAQC,IAAIpQ,KAAKiQ,UAAUX,aNmiCvBO,IAGThV,cMrjCoBgV,GNyjCf,SAASjV,EAAQC,GAEtB,YAEA0B,QAAOiC,eAAe3D,EAAS,cAC7B6B,OAAO,IAGT7B,aOjkCc,SAAUwV,EAAUC,EAASC,GAC1C,GAAMC,GAAQ,GAAI5L,KACZ6L,KAEAC,EAAU,GAAI9L,IACpByL,GAAS7S,QAAQ,SAAAmO,GAAA,MAAQ+E,GAAQ5L,IAAIwL,EAAQ3E,GAAOA,KAEpD+E,EAAQlT,QAAQ,SAAAP,GACd,GAAMsG,GAAWgN,EAAYtT,EACzBsG,IAAYA,EAASvE,OACvBuE,EAAS/F,QAAQ,SAAAmT,GACf,IAAKD,EAAQ3K,IAAI4K,GACf,KAAM,IAAIjM,OAAJ,sBAAgCiM,EAEnCH,GAAMzK,IAAI4K,IACbH,EAAM1L,IAAI6L,MAEZH,EAAMxK,IAAI2K,GAAY3S,KAAKsS,EAAQrT,MAGrCwT,EAAEzS,KAAKf,IAMX,KAFA,GAAIkJ,GAAA,OACEoC,EAAS,GAAI3D,KACZ6L,EAAEzR,OAAS,GAAG,CACnB,GAAM4R,GAAUH,EAAErM,MACZyM,EAAIP,EAAQM,EAElB,IADArI,EAAOzD,IAAI+L,EAAGD,GACVJ,EAAMzK,IAAI8K,GAEZ,IADA1K,EAAUqK,EAAMxK,IAAI6K,GACb1K,EAAQnH,OAAS,GAAG,CACzB,GAAM3D,GAAI8K,EAAQ/B,MACZ0M,EAAUJ,EAAQ1K,IAAI3K,GACtBkI,EAAWgN,EAAYO,EACxBvN,IAAaA,EAASwN,KAAK,SAAAvI,GAAA,OAAMD,EAAOxC,IAAIyC,MAC/CiI,EAAEzS,KAAK8S,IAYf,MANAN,GAAMhT,QAAQ,SAAAd,GACZ,GAAIA,EAAM+H,KAAO,EACf,KAAM,IAAIC,OAAM,iCAIb6D,IP0kCH,SAAS3N,EAAQC,EAASE,GAE/B,YAoBA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GAEvF,QAASG,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCApBhHQ,OAAOiC,eAAe3D,EAAS,cAC7B6B,OAAO,GAGT,IAAIiC,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWtC,WAAasC,EAAWtC,aAAc,EAAOsC,EAAWpC,cAAe,EAAU,SAAWoC,KAAYA,EAAWrC,UAAW,GAAML,OAAOiC,eAAeK,EAAQI,EAAWC,IAAKD,IAAiB,MAAO,UAAUnD,EAAaqD,EAAYC,GAAiJ,MAA9HD,IAAYP,EAAiB9C,EAAYQ,UAAW6C,GAAiBC,GAAaR,EAAiB9C,EAAasD,GAAqBtD,MQpoCjiBkL,EAAAjM,EAAA,GRwoCKkM,EAAQzL,EAAuBwL,GQvoCpCgK,EAAAjW,EAAA,GR2oCKkW,EAAiBzV,EAAuBwV,GQ1oC7C9I,EAAAnN,EAAA,GR8oCKoN,EAAmB3M,EAAuB0M,GQ5oC1BgJ,ERkpCH,WQhpChB,QAAAA,GAAY3Q,GACV,GADiB3E,EAAAoE,KAAAkR,GACb3Q,EAAMkE,KAAO,EACf,KAAM,IAAIC,OAAM,yBAGlB1E,MAAKmR,OAAS5Q,EACdP,KAAKgN,MAAQ,KRqwCd,MA/GArO,GAAauS,IACXhS,IAAK,QACLxC,MAAO,WQhpCR,GAAM6D,GAAQ,GAAIqE,IAElB,OADA5E,MAAKmR,OAAO3T,QAAQ,SAACiE,EAAMvC,GAAP,MAAeqB,GAAMuE,IAAI5F,EAAKuC,EAAKkC,WAChD,GAAI3D,MAAKvD,YAAY8D,MRspC3BrB,IAAK,QACLxC,MAAO,WQ7oCR,MANAsD,MAAKgN,OAAQ,EAAA/F,cAAE,OAASkG,aAAcnN,OACpC,EAAAiH,cAAE,UAAY4B,QAAO,eACnB7F,MAAMC,KAAKjD,KAAKmR,OAAOzO,OAAQ,SAAAxD,GAAA,OAAO,EAAA+H,cAAE,SAAU/H,MAEpD8D,MAAMC,KAAKjD,KAAKmR,OAAO7K,SAAU,SAAA5J,GAAA,OAAS,EAAAuK,cAAE,OAAS4B,QAAO,eAAiBnM,EAAMuM,YAE9EjJ,KAAKgN,SRspCX9N,IAAK,QACLxC,MAAO,WQnpCR,MAAOsG,OAAMC,KAAKjD,KAAKmR,OAAO7K,UAAUtG,KAAKgN,MAAMoE,kBAAkBC,eAAe3U,WRupCnFwC,IAAK,WACLxC,MAAO,SQrpCD6F,GAEP,GAAMhC,GAAQyC,MAAMC,KAAKjD,KAAKmR,OAAO7K,UAC/BvH,EAAIwB,EAAM+Q,UAAU,SAAA7P,GAAA,MACxBA,GAAK8P,SAAShP,EAAM,IAAI,IAG1B,IAAU,KAANxD,EACF,KAAM,IAAI2F,OAAM,2BAGlB,IAAM8M,GAASxR,KAAKgN,MAAMoE,iBAC1BI,GAAOH,cAAgBtS,CAEvB,IAAMwQ,GAAQ,GAAIkC,OAAM,UAAYC,SAAS,GAC7CF,GAAOG,cAAcpC,GAErBhP,EAAMxB,GAAGqO,SAAS7K,MRwpCjBrD,IAAK,WACLxC,MAAO,SQtpCDA,EAAOkV,EAAMC,EAAQ9Q,GAC5B,IAAKiC,MAAMC,KAAKjD,KAAKmR,OAAO7K,UAAUwL,KAAK,SAAArQ,GAAA,MAAQA,GAAK8P,SAAS7U,EAAOkV,GAAM,EAAM7Q,KAAW,CAC7F,GAAI8Q,EACF,OAAO,CAET,MAAM,IAAInN,OAASkN,EAAb,iCAER,OAAO,KR2pCN1S,IAAK,QACLxC,MAAO,WQxpCRsD,KAAKmR,OAAO3T,QAAQ,SAAAiE,GAAA,MAAQA,GAAK4L,aR8pChCnO,IAAK,SACLxC,MAAO,WQ3pCR,OACEqV,EAAG,SACHxR,MAAOP,KAAKmR,WRgqCbjS,IAAK,QACL8G,IAAK,WQ7tCN,MAAOhG,MAAKmR,YRiuCXjS,IAAK,WACLxC,MAAO,SQlqCM6S,GAGd,IAFA,GAAIK,GAAOL,EAAM1Q,OACbE,EAAI,EACD6Q,EAAKoC,oBACVpC,EAAOA,EAAKoC,mBACZpC,EAAKzD,UAAU8F,OAAO,cAAelT,MAAQwQ,EAAM1Q,OAAOwS,kBRsqC3DnS,IAAK,4BACLxC,MAAO,SQnqCuB2G,GAC/BL,MAAMC,KAAKI,EAAKiK,iBAAiB,WAAW9P,QAAQ,SAAAmO,GAClD,GAAM4D,GAAQ,GAAIkC,OAAM,UAAYC,SAAS,GAC7C/F,GAAKgG,cAAcpC,QRuqCpBrQ,IAAK,SACLxC,MAAO,SQpqCI6D,GACZ,GAAmB,IAAfA,EAAMkE,KAAY,CACpB,GAAMyN,GAAelP,MAAMC,KAAK1C,EAAM+F,UAAUxE,OAAO,SAAAF,GAAA,QAAOA,YAAAuG,gBAC9D,IAA4B,IAAxB+J,EAAalT,OACf,MAAO,IAAAiS,cAAiBiB,EAAa,IAGzC,MAAO,IAAIhB,GAAW3Q,OR0qChB2Q,IAGTrW,cQhxCoBqW,GRoxCf,SAAStW,EAAQC,GAEtB,YAQA,SAASe,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCANhHQ,OAAOiC,eAAe3D,EAAS,cAC7B6B,OAAO,GAGT,IAAIiC,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWtC,WAAasC,EAAWtC,aAAc,EAAOsC,EAAWpC,cAAe,EAAU,SAAWoC,KAAYA,EAAWrC,UAAW,GAAML,OAAOiC,eAAeK,EAAQI,EAAWC,IAAKD,IAAiB,MAAO,UAAUnD,EAAaqD,EAAYC,GAAiJ,MAA9HD,IAAYP,EAAiB9C,EAAYQ,UAAW6C,GAAiBC,GAAaR,EAAiB9C,EAAasD,GAAqBtD,MShyC5gBqW,EToyCD,WSlyClB,QAAAA,GAAY1Q,GAAM7F,EAAAoE,KAAAmS,GAChBnS,KAAK+M,MAAQtL,ETy1Cd,MAjDA9C,GAAawT,IACXjT,IAAK,OACLxC,MAAO,WStyCR,MAAOsD,MAAK+M,MAAM7O,UT0yCjBgB,IAAK,QACLxC,MAAO,WSvyCR,MAAOsD,MAAK+M,MAAM9D,WT2yCjB/J,IAAK,QACLxC,MAAO,WSxyCR,MAAO,IAAIsD,MAAKvD,YAAYuD,KAAK+M,MAAMpJ,YT4yCtCzE,IAAK,QACLxC,MAAO,WSzyCR,GAAI4P,GAAMtM,KAAK+M,MAAMrQ,OAIrB,OAHY,KAAR4P,IACFA,EAAM,MAEDA,KT6yCNpN,IAAK,WACLxC,MAAO,SS3yCDA,EAAOkV,EAAMC,EAAQ9Q,GAC5B,MAAkB,QAAVrE,GAAmBsD,KAAK+M,MAAMwE,SAAS7U,EAAOkV,EAAMC,EAAQ9Q,MT8yCnE7B,IAAK,WACLxC,MAAO,SS5yCD6F,EAAMqP,EAAMrR,GACnBP,KAAK+M,MAAMK,SAAS7K,EAAMqP,EAAMrR,MT+yC/BrB,IAAK,QACLxC,MAAO,WS5yCRsD,KAAK+M,MAAMM,WTgzCVnO,IAAK,SACLxC,MAAO,WS7yCR,OACEqV,EAAG,WACHtQ,KAAMzB,KAAK+M,WTmzCPoF,IAGTtX,cS/1CoBsX,GTm2Cf,SAASvX,EAAQC,EAASE,GAE/B,YAYA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GAEvF,QAASG,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAEhH,QAASC,GAA2BC,EAAMb,GAAQ,IAAKa,EAAQ,KAAM,IAAIC,gBAAe,4DAAgE,QAAOd,GAAyB,gBAATA,IAAqC,kBAATA,GAA8Ba,EAAPb,EAElO,QAASe,GAAUC,EAAUC,GAAc,GAA0B,kBAAfA,IAA4C,OAAfA,EAAuB,KAAM,IAAIN,WAAU,iEAAoEM,GAAeD,GAASE,UAAYC,OAAOC,OAAOH,GAAcA,EAAWC,WAAaG,aAAeC,MAAON,EAAUO,YAAY,EAAOC,UAAU,EAAMC,cAAc,KAAeR,IAAYE,OAAOO,eAAiBP,OAAOO,eAAeV,EAAUC,GAAcD,EAASW,UAAYV,GAhBjeE,OAAOiC,eAAe3D,EAAS,cAC7B6B,OAAO,GAGT,IAAIiC,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWtC,WAAasC,EAAWtC,aAAc,EAAOsC,EAAWpC,cAAe,EAAU,SAAWoC,KAAYA,EAAWrC,UAAW,GAAML,OAAOiC,eAAeK,EAAQI,EAAWC,IAAKD,IAAiB,MAAO,UAAUnD,EAAaqD,EAAYC,GAAiJ,MAA9HD,IAAYP,EAAiB9C,EAAYQ,UAAW6C,GAAiBC,GAAaR,EAAiB9C,EAAasD,GAAqBtD,MU32CjiBuG,EAAAtH,EAAA,GV+2CKqX,EAAe5W,EAAuB6G,GU72CtBgQ,EVu3CC,SAAU3K,GAG7B,QAAS2K,KAGP,MAFAzW,GAAgBoE,KAAMqS,GAEfrW,EAA2BgE,KAAMzD,OAAO0D,eAAeoS,GAAgBnS,MAAMF,KAAMG,YAyB5F,MA9BAhE,GAAUkW,EAAgB3K,GAQ1B/I,EAAa0T,IACXnT,IAAK,iBACLxC,MAAO,WU/3CR,OAAO,KVm4CNwC,IAAK,SACLxC,MAAO,WUh4CR,MAAOwO,UAASoH,eAAe,OVo4C9BpT,IAAK,YACLxC,MAAO,SUl4CAA,GACR,MAAiB,QAAVA,KVq4CNwC,IAAK,QACLxC,MAAO,WUl4CR,MAAO,UVu4CD2V,GACPD,aAEFvX,cUz5CoBwX,GV65Cf,SAASzX,EAAQC,EAASE,GAE/B,YAYA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GAEvF,QAASG,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAZhHQ,OAAOiC,eAAe3D,EAAS,cAC7B6B,OAAO,GAGT,IAAIiC,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWtC,WAAasC,EAAWtC,aAAc,EAAOsC,EAAWpC,cAAe,EAAU,SAAWoC,KAAYA,EAAWrC,UAAW,GAAML,OAAOiC,eAAeK,EAAQI,EAAWC,IAAKD,IAAiB,MAAO,UAAUnD,EAAaqD,EAAYC,GAAiJ,MAA9HD,IAAYP,EAAiB9C,EAAYQ,UAAW6C,GAAiBC,GAAaR,EAAiB9C,EAAasD,GAAqBtD,MWv6CjiBkL,EAAAjM,EAAA,GX26CKkM,EAAQzL,EAAuBwL,GWz6C9BuL,EAAkB,GAAI3N,MAE1B,OACA,MACA,OACA,QACA,SACA,OACA,OACA,WACA,YACA,QACApH,QAAQ,SAAAiE,GAAA,MAAQ8Q,GAAgBzN,IAAIrD,EAAM,OXw6C3C,IWt6CoB+Q,GXs6CH,WWp6ChB,QAAAA,GAAY/Q,EAAM6E,GAAQ1K,EAAAoE,KAAAwS,GACxBxS,KAAK+M,MAAQtL,EACbzB,KAAKyS,QAAUzS,KAAK0S,OAAOpM,GAC3BtG,KAAKgN,MAAQ,KX8hDd,MApHArO,GAAa6T,IACXtT,IAAK,QACLxC,MAAO,WWp6CR,MAAO,IAAIsD,MAAKvD,YAAYuD,KAAK+M,MAAO/M,KAAKyS,YXw6C5CvT,IAAK,iBACLxC,MAAO,WWr6CR,OAAO,KXy6CNwC,IAAK,SACLxC,MAAO,SWv6CH4J,GACL,MAAOA,MX06CNpH,IAAK,SACLxC,MAAO,WWv6CR,MAAIsD,MAAKyS,QACqB,IAAxBzS,KAAKyS,QAAQzT,QACR,EAAAiI,cAAE,SAAWxF,KAAM,OAAQkR,UAAU,EAAMjW,MAAOsD,KAAKyS,QAAQ,MAEjE,EAAAxL,cAAE,SACPjH,KAAKyS,QAAQhS,IAAI,SAAAsE,GAAA,OAAK,EAAAkC,cAAE,SAAUlC,OAG/B,EAAAkC,cAAE,SAAWxF,KAAM,OAAQmR,YAAa5S,KAAK+M,WX26CnD7N,IAAK,QACLxC,MAAO,WWt6CR,MAFAsD,MAAKgN,MAAQhN,KAAK6S,SAClB7S,KAAKgN,MAAMG,aAAenN,KACnBA,KAAKgN,SX46CX9N,IAAK,QACLxC,MAAO,WWz6CR,MAAOsD,MAAKgN,MAAMtQ,SX66CjBwC,IAAK,WACLxC,MAAO,SW36CD6F,GACPvC,KAAKgN,MAAMtQ,MAAQ6F,KX86ClBrD,IAAK,YACLxC,MAAO,SW56CAA,GACR,MAAwB,gBAAVA,MX+6CbwC,IAAK,WACLxC,MAAO,SW76CDA,EAAOkV,EAAMC,GACpB,IAAK7R,KAAK8S,UAAUpW,EAAOkV,EAAMC,GAAS,CACxC,GAAIA,EACF,OAAO,CAET,MAAM,IAAInN,OAASkN,EAAb,oBAAqC5R,KAAK+M,OAGlD,GAAI/M,KAAKyS,UAAYzS,KAAKyS,QAAQtQ,SAASzF,GAAQ,CACjD,GAAImV,EACF,OAAO,CAET,MAAM,IAAInN,OAASkN,EAAb,MAAuBlV,EAAvB,iBAA6CsD,KAAKyS,QAAQ7U,KAAK,MAA/D,KAGR,OAAO,KXg7CNsB,IAAK,QACLxC,MAAO,WW76CJsD,KAAKyS,QAC0B/T,SAA7BsB,KAAKgN,MAAMqE,gBACbrR,KAAKgN,MAAMqE,cAAgB,GAG7BrR,KAAKgN,MAAMtQ,MAAQ,MXk7CpBwC,IAAK,SACLxC,MAAO,WWt6CR,OACEqV,EAAG,SACHtQ,KAAMzB,KAAK+M,UX26CZ7N,IAAK,OACL8G,IAAK,WWhgDN,MAAOhG,MAAK+M,WXogDX7N,IAAK,WACLxC,MAAO,SW57CM+E,EAAMsR,GAChB/P,MAAM4H,QAAQnJ,GAChBA,EAAKjE,QAAQ,SAAAoE,GAAA,MAAK2Q,GAAgBzN,IAAIlD,EAAGmR,KAEzCR,EAAgBzN,IAAIrD,EAAMsR,MXk8C3B7T,IAAK,SACLxC,MAAO,SWx7CI+E,EAAM6E,GAClB,MAAO,KAAKiM,EAAgBvM,IAAIvE,IAAS+Q,GAAY/Q,EAAM6E,MX27C1DpH,IAAK,iBACLxC,MAAO,WWx7CR,MAAOsG,OAAMC,KAAKsP,EAAgB7P,YX67C5B8P,IAGT3X,cWtiDoB2X,GX0iDf,SAAS5X,EAAQC,EAASE,GAE/B,YAgBA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GAEvF,QAASG,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAhBhHQ,OAAOiC,eAAe3D,EAAS,cAC7B6B,OAAO,GAGT,IAAIiC,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWtC,WAAasC,EAAWtC,aAAc,EAAOsC,EAAWpC,cAAe,EAAU,SAAWoC,KAAYA,EAAWrC,UAAW,GAAML,OAAOiC,eAAeK,EAAQI,EAAWC,IAAKD,IAAiB,MAAO,UAAUnD,EAAaqD,EAAYC,GAAiJ,MAA9HD,IAAYP,EAAiB9C,EAAYQ,UAAW6C,GAAiBC,GAAaR,EAAiB9C,EAAasD,GAAqBtD,MYlkDjiBkL,EAAAjM,EAAA,GZskDKkM,EAAQzL,EAAuBwL,GYrkDpCM,EAAAvM,EAAA,GZykDKiK,EAAexJ,EAAuB8L,GYvkDtB0L,EZ6kDJ,WY3kDf,QAAAA,GAAYvR,GAAM7F,EAAAoE,KAAAgT,GAChBhT,KAAK+M,MAAQtL,EACbzB,KAAKiT,SACLjT,KAAKgN,MAAQ,KACbhN,KAAKkT,MAAQ,KZ+qDd,MA9FAvU,GAAaqU,IACX9T,IAAK,OACLxC,MAAO,WY/kDR,MAAUsD,MAAK+M,MAAM7O,OAArB,QZmlDCgB,IAAK,QACLxC,MAAO,WYhlDR,MAAO,IAAIsD,MAAKvD,YAAYuD,KAAK+M,MAAMpJ,YZolDtCzE,IAAK,QACLxC,MAAO,WYvkDR,MAVAsD,MAAKgN,OAAQ,EAAA/F,cAAE,OAASkG,aAAcnN,OACpC,EAAAiH,cAAE,QACAjH,KAAKkT,OAAQ,EAAAjM,cAAE,UACf,EAAAA,cAAE,SACA,EAAAA,cAAE,MAAM,EAAAA,cAAE,SAAWxF,KAAM,SAAUoH,QAAO,eAAgBnM,MAAO,QACnE,EAAAuK,cAAE,OACF,EAAAA,cAAE,SAIDjH,KAAKgN,SZ4kDX9N,IAAK,WACLxC,MAAO,SY1kDD6F,EAAMqP,EAAMrR,GACnB,IAAK,GAAIxB,GAAI,EAAGA,EAAIwD,EAAKvD,OAAQD,IAAK,CACpC,GAAMoU,GAAMnT,KAAK2C,KACjBwQ,GAAI/F,SAAS7K,EAAKxD,GAAO6S,EAAzB,IAAiC7S,EAAjC,IAAuCwB,OZ8kDxCrB,IAAK,WACLxC,MAAO,SY3kDDA,EAAOkV,EAAMC,EAAQ9Q,GAAS,GAAAgN,GAAA/N,IACrC,KAAKgD,MAAM4H,QAAQlO,GAAQ,CACzB,GAAImV,EACF,OAAO,CAET,MAAM,IAAInN,OAASkN,EAAb,qBAGR,MAAOlV,GAAM6J,MAAM,SAACrD,EAAMnE,GAAP,MAAagP,GAAKhB,MAAMwE,SAASrO,EAAS0O,EAA7B,IAAqC7S,EAArC,IAA2C8S,EAAQ9Q,QZklDlF7B,IAAK,QACLxC,MAAO,WY/kDR,MAAOsD,MAAKiT,MAAMxS,IAAI,SAAC6L,GAAD,MAASA,GAAI5P,aZqlDlCwC,IAAK,QACLxC,MAAO,WYllDRsD,KAAKiT,SACLjT,KAAKkT,MAAM9H,UAAY,MZslDtBlM,IAAK,MACLxC,MAAO,WYnlDR,GAAMiH,GAAQ3D,KAAK+M,MAAMpJ,OAQzB,OAPA3D,MAAKiT,MAAMjV,KAAK2F,GAChB3D,KAAKkT,MAAMtK,aAAY,EAAA3B,cAAE,MACvB,EAAAA,cAAE,MAAM,EAAAA,cAAE,SAAWxF,KAAM,SAAUoH,QAAO,kBAAmBnM,MAAO,QACtE,EAAAuK,cAAE,KAAF,IAAYjH,KAAKkT,MAAMxH,SAAS1M,OAAhC,MACA,EAAAiI,cAAE,KAAMtD,EAAMsF,WAEhBjE,aAAW0F,0BAA0B1K,KAAKkT,MAAME,kBACzCzP,KZmlDNzE,IAAK,SACLxC,MAAO,SYjlDHqC,GACLiB,KAAKiT,MAAMjR,OAAOjD,EAAG,GACrBiB,KAAKkT,MAAMxH,SAAS3M,GAAGsU,QAEvB,KAAK,GAAI/R,GAAIvC,EAAGuC,EAAItB,KAAKkT,MAAMxH,SAAS1M,OAAQsC,IAC9CtB,KAAKkT,MAAMxH,SAASpK,GAAGoK,SAAS,GAAGsD,YAAnC,IAAqD1N,EAArD,OZqlDDpC,IAAK,SACLxC,MAAO,WYjlDR,OACEqV,EAAG,QACHtQ,KAAMzB,KAAK+M,YZslDZ7N,IAAK,aACLxC,MAAO,SYnlDQ6S,GAChBA,EAAM1Q,OAAOqN,WAAWA,WAAWA,WAAWA,WAAWiB,aAAaxK,SZslDrEzD,IAAK,gBACLxC,MAAO,SYplDW6S,GACnB,GAAM4D,GAAM5D,EAAM1Q,OAAOqN,WAAWA,WAC9BnN,EAAIiE,MAAM1G,UAAU6G,QAAQ/H,KAAK+X,EAAIjH,WAAWR,SAAUyH,EAChEA,GAAIjH,WAAWA,WAAWA,WAAWiB,aAAakG,OAAOtU,OZwlDnDiU,IAGTnY,cYxrDoBmY,GZ4rDf,SAASpY,EAAQC,EAASE,GAE/B,YAYA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GAEvF,QAASG,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAZhHQ,OAAOiC,eAAe3D,EAAS,cAC7B6B,OAAO,GAGT,IAAIiC,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWtC,WAAasC,EAAWtC,aAAc,EAAOsC,EAAWpC,cAAe,EAAU,SAAWoC,KAAYA,EAAWrC,UAAW,GAAML,OAAOiC,eAAeK,EAAQI,EAAWC,IAAKD,IAAiB,MAAO,UAAUnD,EAAaqD,EAAYC,GAAiJ,MAA9HD,IAAYP,EAAiB9C,EAAYQ,UAAW6C,GAAiBC,GAAaR,EAAiB9C,EAAasD,GAAqBtD,MavsDjiBkL,EAAAjM,EAAA,Gb2sDKkM,EAAQzL,EAAuBwL,GazsDfsM,Eb+sDA,Wa7sDnB,QAAAA,GAAYpV,EAAMuD,EAAM8R,GAAU3X,EAAAoE,KAAAsT,GAChCtT,KAAKwT,MAAQtV,EACb8B,KAAK+M,MAAQtL,EACbzB,KAAKyT,UAAYF,EACjBvT,KAAK0T,WAAY,EAEb1T,KAAKwT,MAAM5P,SAAS,MACtBuM,QAAQC,IAAIpQ,Mb8yDf,MA1FArB,GAAa2U,IACXpU,IAAK,OACLxC,MAAO,WajtDR,MAAOsD,MAAKwT,SbqtDXtU,IAAK,OACLxC,MAAO,WaltDR,MAAOsD,MAAK+M,SbstDX7N,IAAK,WACLxC,MAAO,WantDR,MAAOsD,MAAKyT,abutDXvU,IAAK,WACLxC,MAAO,WaptDR,MAAOsD,MAAK0T,abwtDXxU,IAAK,QACLxC,MAAO,WartDR,MAAO,IAAIsD,MAAKvD,YAAYuD,KAAKwT,MAAOxT,KAAK+M,MAAMpJ,QAAS3D,KAAKyT,cbytDhEvU,IAAK,QACLxC,MAAO,Wa3sDR,MAXAsD,MAAKgN,OAAQ,EAAA/F,cAAE,MAAQkG,aAAcnN,OACnC,EAAAiH,cAAE,OACF,EAAAA,cAAE,KAAMjH,KAAKwT,QACb,EAAAvM,cAAE,KAAMjH,KAAK+M,MAAM9D,UAEhBjJ,KAAKyT,WACRzT,KAAKgN,MAAMoE,kBAAkBxI,aAC3B,EAAA3B,cAAE,SAAWxF,KAAM,SAAUoH,QAAO,mBAAoBnM,MAAO,QAGnEsD,KAAK2T,SACE3T,KAAKgN,SbotDX9N,IAAK,QACLxC,MAAO,WajtDR,MAAOsD,MAAK+M,MAAMrQ,WbqtDjBwC,IAAK,WACLxC,MAAO,SantDD6F,EAAMqP,EAAMrR,GACnBP,KAAK+M,MAAMK,SAAS7K,EAASqP,EAA7B,IAAqC5R,KAAKwT,MAASjT,GACnDP,KAAK0T,WAAY,EACjB1T,KAAK2T,YbstDJzU,IAAK,WACLxC,MAAO,SaptDDA,EAAOkV,EAAMC,EAAQ9Q,GAC5B,MAAOf,MAAK+M,MAAMwE,SAAS7U,EAAOkV,EAAMC,EAAQ9Q,MbutD/C7B,IAAK,QACLxC,MAAO,WaptDRsD,KAAK+M,MAAMM,QACXrN,KAAK0T,WAAY,EACjB1T,KAAK2T,YbwtDJzU,IAAK,SACLxC,MAAO,WartDRsD,KAAK0T,WAAa1T,KAAK0T,UACvB1T,KAAK2T,YbytDJzU,IAAK,SACLxC,MAAO,WattDHsD,KAAKyT,YACRzT,KAAKgN,MAAMtB,SAAS,GAAG0F,kBAAkBjF,UAAU8F,OAAO,qBAAsBjS,KAAK0T,WACrF1T,KAAKgN,MAAMtB,SAAS,GAAGS,UAAU8F,OAAO,oBAAqBjS,KAAK0T,WAClE1T,KAAKgN,MAAMtB,SAAS,GAAG0F,kBAAkBjF,UAAU8F,OAAO,eAAgBjS,KAAK0T,eb2tDhFxU,IAAK,SACLxC,MAAO,WavtDR,OACEqV,EAAG,YACH7T,KAAM8B,KAAKwT,MACX/R,KAAMzB,KAAK+M,Yb4tDZ7N,IAAK,gBACLxC,MAAO,SaztDW6S,GACnBA,EAAM1Q,OAAOqN,WAAWA,WAAWiB,aAAa8E,ab6tD1CqB,IAGTzY,ca1zDoByY,Gb8zDf,SAAS1Y,EAAQC,EAASE,GAE/B,YAcA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GAEvF,QAASG,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAdhHQ,OAAOiC,eAAe3D,EAAS,cAC7B6B,OAAO,GAGT,IAAIuI,GAA4B,kBAAX6B,SAAoD,gBAApBA,QAAOC,SAAwB,SAAUtL,GAAO,aAAcA,IAAS,SAAUA,GAAO,MAAOA,IAAyB,kBAAXqL,SAAyBrL,EAAIgB,cAAgBqK,OAAS,eAAkBrL,IAEtOkD,EAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWtC,WAAasC,EAAWtC,aAAc,EAAOsC,EAAWpC,cAAe,EAAU,SAAWoC,KAAYA,EAAWrC,UAAW,GAAML,OAAOiC,eAAeK,EAAQI,EAAWC,IAAKD,IAAiB,MAAO,UAAUnD,EAAaqD,EAAYC,GAAiJ,MAA9HD,IAAYP,EAAiB9C,EAAYQ,UAAW6C,GAAiBC,GAAaR,EAAiB9C,EAAasD,GAAqBtD,Mc10DjiBkL,EAAAjM,EAAA,Gd80DKkM,EAAQzL,EAAuBwL,Gc50Df4M,Edk1DH,Wch1DhB,QAAAA,GAAYlO,GAAY9J,EAAAoE,KAAA4T,GACtB5T,KAAK6T,YAAcnO,EACnB1F,KAAKgN,MAAQ,Kd27Dd,MArGArO,GAAaiV,IACX1U,IAAK,aACLxC,MAAO,Wcp1DR,MAAOsD,MAAK6T,edw1DX3U,IAAK,QACLxC,MAAO,Wcr1DR,MAAO,IAAIsD,MAAKvD,YAAYuD,KAAK6T,YAAYpT,IAAI,SAAAkF,GAAA,MAAQA,GAAKhC,cd21D7DzE,IAAK,QACLxC,MAAO,Wcn1DR,MALAsD,MAAKgN,OAAQ,EAAA/F,cAAE,SAAWkG,aAAcnN,OACtC,EAAAiH,cAAE,QACAjH,KAAK6T,YAAYpT,IAAI,SAAAgB,GAAA,MAAQA,GAAKwH,YAG/BjJ,KAAKgN,Sd01DX9N,IAAK,QACLxC,MAAO,Wcv1DR,GAAM6F,KAMN,OALAvC,MAAK6T,YAAYrW,QAAQ,SAACmI,IACpBA,EAAK4N,YAAc5N,EAAKmO,cAC1BvR,EAAKoD,EAAKzH,QAAUyH,EAAKjJ,WAGtB6F,Kd21DNrD,IAAK,WACLxC,MAAO,Scz1DD6F,EAAMqP,EAAMrR,GACnBP,KAAK6T,YAAYrW,QAAQ,SAAAmI,GACvBA,EAAKyH,SAAS7K,EAAKoD,EAAKzH,QAAS0T,EAAMrR,Qd61DxCrB,IAAK,WACLxC,MAAO,Sc11DDA,EAAOkV,EAAMC,EAAQ9Q,GAAS,GAAAgN,GAAA/N,IAGrC,IAAqB,YAAjB,mBAAOtD,GAAP,YAAAuI,EAAOvI,KAAgC,OAAVA,EAAgB,CAC/C,GAAImV,EACF,OAAO,CAET,MAAM,IAAInN,OAASkN,EAAb,sBAGR,IAAK,GAAI7S,GAAI,EAAGA,EAAIiB,KAAK6T,YAAY7U,OAAQD,IAAK,CAChD,GAAM4G,GAAO3F,KAAK6T,YAAY9U,GACxBG,EAAMyG,EAAKzH,MAEjB,IAAmBQ,SAAfhC,EAAMwC,IACR,GAAIyG,EAAK4N,WAAY,CACnB,GAAI1B,EACF,OAAO,CAET,MAAM,IAAInN,OAASkN,EAAb,IAAqB1S,EAArB,qBAEH,KAAKyG,EAAK4L,SAAS7U,EAAMwC,GAAS0S,EAA7B,IAAqC1S,EAAO2S,EAAQ9Q,GAC9D,OAAO,EAYX,MARIA,GAAQgT,gCAA+B,WACzC,GAAMC,GAAc,GAAIvR,KAAIsL,EAAK8F,YAAYpT,IAAI,SAAAwT,GAAA,MAAKA,GAAE/V,UAClDgW,EAAO3X,OAAOmG,KAAKhG,GAAOoF,OAAO,SAAAqS,GAAA,OAAMH,EAAYjO,IAAIoO,IAC7D,IAAID,EAAKlV,OAAS,EAChB,KAAM,IAAI0F,OAAJ,uBAAkCwP,EAAKtW,KAAK,KAA5C,qBAAuEgU,EAAvE,SAIH,Kdq2DN1S,IAAK,QACLxC,MAAO,Wcl2DRsD,KAAK6T,YAAYrW,QAAQ,SAAAmI,GAAA,MAAQA,GAAK0H,adw2DrCnO,IAAK,SACLxC,MAAO,Wcr2DR,OACEqV,EAAG,SACHrM,WAAY1F,KAAK6T,iBd22DbD,IAGT/Y,ccl8DoB+Y,Gds8Df,SAAShZ,EAAQC,EAASE,GAE/B,YAkBA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GAEvF,QAASG,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAlBhHQ,OAAOiC,eAAe3D,EAAS,cAC7B6B,OAAO,GAGT,IAAIuI,GAA4B,kBAAX6B,SAAoD,gBAApBA,QAAOC,SAAwB,SAAUtL,GAAO,aAAcA,IAAS,SAAUA,GAAO,MAAOA,IAAyB,kBAAXqL,SAAyBrL,EAAIgB,cAAgBqK,OAAS,eAAkBrL,IAEtOkD,EAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWtC,WAAasC,EAAWtC,aAAc,EAAOsC,EAAWpC,cAAe,EAAU,SAAWoC,KAAYA,EAAWrC,UAAW,GAAML,OAAOiC,eAAeK,EAAQI,EAAWC,IAAKD,IAAiB,MAAO,UAAUnD,EAAaqD,EAAYC,GAAiJ,MAA9HD,IAAYP,EAAiB9C,EAAYQ,UAAW6C,GAAiBC,GAAaR,EAAiB9C,EAAasD,GAAqBtD,Mel9DjiBkL,EAAAjM,EAAA,Gfs9DKkM,EAAQzL,EAAuBwL,Ger9DpCM,EAAAvM,EAAA,Gfy9DKiK,EAAexJ,EAAuB8L,Gev9DtB8M,Ef69DN,We39Db,QAAAA,GAAYlV,EAAKuC,EAAM8R,GAAU3X,EAAAoE,KAAAoU,GAC/BpU,KAAK+M,MAAQtL,EACbzB,KAAKyL,KAAOvM,EACZc,KAAKyT,UAAYF,EACjBvT,KAAKiT,SACLjT,KAAKgN,MAAQ,KACbhN,KAAKkT,MAAQ,KfklEd,MAjHAvU,GAAayV,IACXlV,IAAK,OACLxC,MAAO,We/9DR,MAAUsD,MAAK+M,MAAM7O,OAArB,Qfm+DCgB,IAAK,QACLxC,MAAO,Weh+DR,MAAO,IAAIsD,MAAKvD,YAAYuD,KAAKyL,KAAK9H,QAAS3D,KAAK+M,MAAMpJ,QAAS3D,KAAKyT,UAAYzT,KAAKyT,UAAU9P,QAAU,Sfo+D5GzE,IAAK,QACLxC,MAAO,Wel+DF,GAAAqR,GAAA/N,IAgBN,OAfAA,MAAKgN,OAAQ,EAAA/F,cAAE,OAASkG,aAAcnN,OACpC,EAAAiH,cAAE,QACAjH,KAAKkT,OAAQ,EAAAjM,cAAE,UACf,EAAAA,cAAE,SACA,EAAAA,cAAE,MAAM,EAAAA,cAAE,SAAWxF,KAAM,SAAUoH,QAAO,eAAgBnM,MAAO,QACnE,EAAAuK,cAAE,OACF,EAAAA,cAAE,SAIJjH,KAAKyT,WACPzT,KAAKyT,UAAU/N,aAAalI,QAAQ,SAACmI,GACnCoI,EAAKpL,IAAIgD,EAAKlE,OAAQkE,EAAKzH,UAGxB8B,KAAKgN,Sf89DX9N,IAAK,WACLxC,MAAO,Se59DD6F,EAAMqP,EAAMrR,GAAO,GAAAuO,GAAA9O,IAC1BzD,QAAOmG,KAAKH,GAAM/E,QAAQ,SAAC0B,EAAKH,GAC9B,GAAMoU,GAAMrE,EAAKnM;AACjBmM,EAAKoE,MAAMxH,SAAS3M,GAAGqS,kBAAkBpC,YAAc9P,EACvDiU,EAAI/F,SAAS7K,EAAKrD,GAAS0S,EAA3B,IAAmC1S,EAAnC,IAA2CqB,Qfk+D5CrB,IAAK,WACLxC,MAAO,Se/9DDA,EAAOkV,EAAMC,EAAQ9Q,GAC5B,GAAqB,YAAjB,mBAAOrE,GAAP,YAAAuI,EAAOvI,KAAgC,OAAVA,EAAgB,CAC/C,GAAImV,EACF,OAAO,CAET,MAAM,IAAInN,OAASkN,EAAb,sBAIR,IAAK,GADClP,GAAOnG,OAAOmG,KAAKhG,GAChBqC,EAAI,EAAGA,EAAI2D,EAAK1D,OAAQD,IAAK,CACpC,GAAMG,GAAMwD,EAAK3D,EAEjB,KAAKiB,KAAKyL,KAAK8F,SAASrS,EAAQ0S,EAA3B,IAAmC1S,EAAnC,KAA4C2S,EAAQ9Q,GACvD,OAAO,CAGT,KAAKf,KAAK+M,MAAMwE,SAAS7U,EAAMwC,GAAS0S,EAAnC,IAA2C1S,EAA3C,IAAmD2S,EAAQ9Q,GAC9D,OAAO,EAIX,OAAIf,KAAKyT,WACFzT,KAAK+M,MAAMwE,SAAS7U,EAAOkV,EAAMC,EAAQ9Q,Mfu+D/C7B,IAAK,QACLxC,MAAO,Weh+DF,GAAA2X,GAAArU,KACAvE,IAKN,OAJAuE,MAAKiT,MAAMzV,QAAQ,SAAC2V,EAAKpU,GACvB,GAAMG,GAAMmV,EAAKnB,MAAMxH,SAAS3M,GAAG2M,SAAS,GAAG0F,kBAAkB1U,KACjEjB,GAAIyD,GAAOiU,EAAIzW,UAEVjB,Kfq+DNyD,IAAK,QACLxC,MAAO,Wel+DRsD,KAAKiT,SACLjT,KAAKkT,MAAM9H,UAAY,Mfs+DtBlM,IAAK,MACLxC,MAAO,Sep+DN+E,EAAMvC,GACR,GAAMyE,GAAQlC,GAAQzB,KAAK+M,MAAMpJ,OACjC3D,MAAKiT,MAAMjV,KAAK2F,EAChB,IAAM2Q,GAAWtU,KAAKyL,KAAOzL,KAAKyL,KAAKxC,SAAU,EAAAhC,cAAE,SAAWxF,KAAM,OAAQmR,YAAa,OAUzF,OATI1T,KACFoV,EAAS5X,MAAQwC,GAEnBc,KAAKkT,MAAMtK,aAAY,EAAA3B,cAAE,MACrB,EAAAA,cAAE,MAAM,EAAAA,cAAE,SAAWxF,KAAM,SAAUoH,QAAO,kBAAmBnM,MAAO,QACtE,EAAAuK,cAAE,KAAMqN,IACR,EAAArN,cAAE,KAAMtD,EAAMsF,WAElBjE,aAAW0F,0BAA0B1K,KAAKkT,MAAME,kBACzCzP,Kfm+DNzE,IAAK,SACLxC,MAAO,Sej+DHqC,GACLiB,KAAKiT,MAAMjR,OAAOjD,EAAG,GACrBiB,KAAKkT,MAAMxH,SAAS3M,GAAGsU,Yfo+DtBnU,IAAK,SACLxC,MAAO,Wej+DR,OACEqV,EAAG,MACH7S,IAAKc,KAAKyL,KACVhK,KAAMzB,KAAK+M,Wfu+DPqH,IAGTvZ,ce7lEoBuZ,GfimEf,SAASxZ,EAAQC,EAASE,GAE/B,YAgBA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GAEvF,QAASG,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAEhH,QAASC,GAA2BC,EAAMb,GAAQ,IAAKa,EAAQ,KAAM,IAAIC,gBAAe,4DAAgE,QAAOd,GAAyB,gBAATA,IAAqC,kBAATA,GAA8Ba,EAAPb,EAElO,QAASe,GAAUC,EAAUC,GAAc,GAA0B,kBAAfA,IAA4C,OAAfA,EAAuB,KAAM,IAAIN,WAAU,iEAAoEM,GAAeD,GAASE,UAAYC,OAAOC,OAAOH,GAAcA,EAAWC,WAAaG,aAAeC,MAAON,EAAUO,YAAY,EAAOC,UAAU,EAAMC,cAAc,KAAeR,IAAYE,OAAOO,eAAiBP,OAAOO,eAAeV,EAAUC,GAAcD,EAASW,UAAYV,GApBjeE,OAAOiC,eAAe3D,EAAS,cAC7B6B,OAAO,GAGT,IAAIiC,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWtC,WAAasC,EAAWtC,aAAc,EAAOsC,EAAWpC,cAAe,EAAU,SAAWoC,KAAYA,EAAWrC,UAAW,GAAML,OAAOiC,eAAeK,EAAQI,EAAWC,IAAKD,IAAiB,MAAO,UAAUnD,EAAaqD,EAAYC,GAAiJ,MAA9HD,IAAYP,EAAiB9C,EAAYQ,UAAW6C,GAAiBC,GAAaR,EAAiB9C,EAAasD,GAAqBtD,MgB5mEjiBkL,EAAAjM,EAAA,GhBgnEKkM,EAAQzL,EAAuBwL,GgB/mEpC3E,EAAAtH,EAAA,GhBmnEKqX,EAAe5W,EAAuB6G,GgBjnEtBkS,EhB2nEC,SAAU7M,GAG7B,QAAS6M,KAGP,MAFA3Y,GAAgBoE,KAAMuU,GAEfvY,EAA2BgE,KAAMzD,OAAO0D,eAAesU,GAAgBrU,MAAMF,KAAMG,YAqC5F,MA1CAhE,GAAUoY,EAAgB7M,GAQ1B/I,EAAa4V,IACXrV,IAAK,SACLxC,MAAO,SgBpoEH4J,GACL,MAAOA,GAASA,EAAO7F,IAAI,SAAAsE,GAAA,MAAKA,MAAM,GAAc,SAANA,IAAgB,QhByoE7D7F,IAAK,SACLxC,MAAO,WgBtoER,OAAO,EAAAuK,cAAE,SAAWxF,KAAM,gBhB0oEzBvC,IAAK,YACLxC,MAAO,SgBxoEAA,GACR,MAAwB,iBAAVA,MhB2oEbwC,IAAK,QACLxC,MAAO,WgBxoER,MAAOsD,MAAKgN,MAAMwH,WhB4oEjBtV,IAAK,WACLxC,MAAO,SgB1oED6F,GACPvC,KAAKgN,MAAMwH,QAAUjS,KhB6oEpBrD,IAAK,QACLxC,MAAO,WgB1oERsD,KAAKgN,MAAMwH,SAAU,MhB+oEfD,GACPnC,aAEFvX,cgBzqEoB0Z,GhB6qEf,SAAS3Z,EAAQC,EAASE,GAE/B,YAYA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GAEvF,QAASG,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAEhH,QAASC,GAA2BC,EAAMb,GAAQ,IAAKa,EAAQ,KAAM,IAAIC,gBAAe,4DAAgE,QAAOd,GAAyB,gBAATA,IAAqC,kBAATA,GAA8Ba,EAAPb,EAElO,QAASe,GAAUC,EAAUC,GAAc,GAA0B,kBAAfA,IAA4C,OAAfA,EAAuB,KAAM,IAAIN,WAAU,iEAAoEM,GAAeD,GAASE,UAAYC,OAAOC,OAAOH,GAAcA,EAAWC,WAAaG,aAAeC,MAAON,EAAUO,YAAY,EAAOC,UAAU,EAAMC,cAAc,KAAeR,IAAYE,OAAOO,eAAiBP,OAAOO,eAAeV,EAAUC,GAAcD,EAASW,UAAYV,GAhBjeE,OAAOiC,eAAe3D,EAAS,cAC7B6B,OAAO,GAGT,IAAIiC,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWtC,WAAasC,EAAWtC,aAAc,EAAOsC,EAAWpC,cAAe,EAAU,SAAWoC,KAAYA,EAAWrC,UAAW,GAAML,OAAOiC,eAAeK,EAAQI,EAAWC,IAAKD,IAAiB,MAAO,UAAUnD,EAAaqD,EAAYC,GAAiJ,MAA9HD,IAAYP,EAAiB9C,EAAYQ,UAAW6C,GAAiBC,GAAaR,EAAiB9C,EAAasD,GAAqBtD,MiBxrEjiBuG,EAAAtH,EAAA,GjB4rEKqX,EAAe5W,EAAuB6G,GiB1rEtBoS,EjBosEE,SAAU/M,GAG9B,QAAS+M,KAGP,MAFA7Y,GAAgBoE,KAAMyU,GAEfzY,EAA2BgE,KAAMzD,OAAO0D,eAAewU,GAAiBvU,MAAMF,KAAMG,YAsB7F,MA3BAhE,GAAUsY,EAAiB/M,GAQ3B/I,EAAa8V,IACXvV,IAAK,SACLxC,MAAO,SiB7sEH4J,GACL,MAAOA,GAASA,EAAO7F,IAAI,SAAAsE,GAAA,MAAK2P,YAAW3P,KAAM,QjBktEhD7F,IAAK,YACLxC,MAAO,SiBhtEAA,GACR,MAAwB,gBAAVA,MjBmtEbwC,IAAK,QACLxC,MAAO,WiBhtER,MAAOgY,YAAW1U,KAAKgN,MAAMtQ,WjBqtEvB+X,GACPrC,aAEFvX,ciBnuEoB4Z,GjBuuEf,SAAS7Z,EAAQC,EAASE,GAE/B,YAYA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GAEvF,QAASG,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAEhH,QAASC,GAA2BC,EAAMb,GAAQ,IAAKa,EAAQ,KAAM,IAAIC,gBAAe,4DAAgE,QAAOd,GAAyB,gBAATA,IAAqC,kBAATA,GAA8Ba,EAAPb,EAElO,QAASe,GAAUC,EAAUC,GAAc,GAA0B,kBAAfA,IAA4C,OAAfA,EAAuB,KAAM,IAAIN,WAAU,iEAAoEM,GAAeD,GAASE,UAAYC,OAAOC,OAAOH,GAAcA,EAAWC,WAAaG,aAAeC,MAAON,EAAUO,YAAY,EAAOC,UAAU,EAAMC,cAAc,KAAeR,IAAYE,OAAOO,eAAiBP,OAAOO,eAAeV,EAAUC,GAAcD,EAASW,UAAYV,GAhBjeE,OAAOiC,eAAe3D,EAAS,cAC7B6B,OAAO,GAGT,IAAIiC,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWtC,WAAasC,EAAWtC,aAAc,EAAOsC,EAAWpC,cAAe,EAAU,SAAWoC,KAAYA,EAAWrC,UAAW,GAAML,OAAOiC,eAAeK,EAAQI,EAAWC,IAAKD,IAAiB,MAAO,UAAUnD,EAAaqD,EAAYC,GAAiJ,MAA9HD,IAAYP,EAAiB9C,EAAYQ,UAAW6C,GAAiBC,GAAaR,EAAiB9C,EAAasD,GAAqBtD,MkBjvEjiBuG,EAAAtH,EAAA,GlBqvEKqX,EAAe5W,EAAuB6G,GkBnvEtBsS,ElB6vEA,SAAUjN,GkB3vE7B,QAAAiN,GAAYlT,EAAM6E,GAAQ1K,EAAAoE,KAAA2U,EAAA,IAAA5G,GAAA/R,EAAAgE,KAAAzD,OAAA0D,eAAA0U,GAAAvZ,KAAA4E,KAClByB,EAAM6E,GADY,OAExByH,GAAK6G,WAAa,KAFM7G,ElBi1EzB,MArFA5R,GAAUwY,EAAejN,GAWzB/I,EAAagW,IACXzV,IAAK,SACLxC,MAAO,SkBpwEH4J,GACL,IAAKA,EACH,MAAO,KAGT,IAAMhD,GAASgD,EAAOuO,OAAO,SAAC9S,EAAU+S,GACtC,GAAuB,gBAAZA,GAAsB,CAC/B,IAAe,EAAVA,KAAiBA,EACpB,KAAM,IAAIpQ,OAAM,aAElB3C,GAAS/D,KAAK8W,OACT,IAA6B,KAAzBA,EAAQ3R,QAAQ,KAAa,CACtC,GAAM4R,GAAQD,EAAQnT,MAAM,KACtBqT,EAAQC,SAASF,EAAM,GAAI,IAC3BG,EAAMD,SAASF,EAAM,GAAI,GAC/BhT,GAAS/D,MAAMgX,EAAOE,QAEtBnT,GAAS/D,KAAKiX,SAASH,EAAS,IAElC,OAAO/S,QAGHoT,EAAS7R,EAAOxB,OAAO,SAAAvG,GAAA,MAAKyH,OAAM4H,QAAQrP,IAEhD,KAAK4Z,EAAOnW,OACV,MAAOsE,GAAO8R,KAAK,SAACnB,EAAGoB,GAAJ,MAAUpB,GAAIoB,GAGnC,IAAMC,GAAQhS,EAAOxB,OAAO,SAAAvG,GAAA,OAAMyH,MAAM4H,QAAQrP,KAE1Cga,EAAYJ,EAAON,OAAO,SAAC9S,EAAU+S,GAAX,MAAuB/S,IAAY+S,EAAQ,GAAKA,EAAQ,KAAK,EAG7F,OAAIS,GAAYD,EAAMtW,QAAU,KAC9BmW,EAAO3X,QAAQ,SAAAgY,GACb,IAAK,GAAIzW,GAAIyW,EAAE,GAAIzW,GAAKyW,EAAE,GAAIzW,IAC5BuW,EAAMtX,KAAKe,KAGRuW,EAAMF,KAAK,SAACnB,EAAGoB,GAAJ,MAAUpB,GAAIoB,MAGlCrV,KAAK4U,WAAa,SAAClY,GAAD,MAAW4Y,GAAMnT,SAASzF,IAAUyY,EAAOrD,KAAK,SAAA0D,GAAA,MAAKA,GAAE,IAAM9Y,GAASA,GAAS8Y,EAAE,MAE5F,SlBqxENtW,IAAK,YACLxC,MAAO,SkBnxEAA,GACR,MAAwB,gBAAVA,KAA+B,EAARA,KAAeA,KlBsxEnDwC,IAAK,QACLxC,MAAO,WkBnxER,MAAOuY,UAASjV,KAAKgN,MAAMtQ,MAAO,QlBwxE5BiY,GACPvC,aAEFvX,ckBt1EoB8Z,GlB01Ef,SAAS/Z,EAAQC,EAASE,GAE/B,YA2BA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GAEvF,QAASG,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCA3BhHQ,OAAOiC,eAAe3D,EAAS,cAC7B6B,OAAO,GAGT,IAAIiC,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWtC,WAAasC,EAAWtC,aAAc,EAAOsC,EAAWpC,cAAe,EAAU,SAAWoC,KAAYA,EAAWrC,UAAW,GAAML,OAAOiC,eAAeK,EAAQI,EAAWC,IAAKD,IAAiB,MAAO,UAAUnD,EAAaqD,EAAYC,GAAiJ,MAA9HD,IAAYP,EAAiB9C,EAAYQ,UAAW6C,GAAiBC,GAAaR,EAAiB9C,EAAasD,GAAqBtD,MmBj2EjiB2Z,EAAA1a,EAAA,IACAqM,GnBu2EgB5L,EAAuBia,GmBv2EvC1a,EAAA,InB22EKsM,EAAa7L,EAAuB4L,GmB12EzCsO,EAAA3a,EAAA,InB82EK4a,EAAcna,EAAuBka,GmB72E1CE,EAAA7a,EAAA,InBi3EK8a,EAAsBra,EAAuBoa,GmB/2E7BE,EnBq3EC,WmBn3EpB,QAAAA,GAAY5X,EAAMC,GAASvC,EAAAoE,KAAA8V,GACzB9V,KAAKwT,MAAQtV,EACb8B,KAAK+V,QAAU,KACf/V,KAAKgW,SAAU,EACfhW,KAAKiW,eAAkB9X,OAAe+X,WACtClW,KAAKmW,mBAAqB,GAAAN,iBACpB1X,OAAeiY,8BnBw8EtB,MAhFAzX,GAAamX,IACX5W,IAAK,SACLxC,MAAO,SmBt3EHqZ,GAEL,MADA/V,MAAK+V,QAAUA,EACR/V,QnBy3ENd,IAAK,wBACLxC,MAAO,WmBn3ER,MAHIsD,MAAK+V,UAAY/V,KAAKqW,sBACxBrW,KAAKqW,oBAAsBrW,KAAK+V,QAAQlB,OAAO,SAACZ,EAAGoB,GAAJ,MAAWpB,GAAET,MAAMxU,OAASqW,EAAE7B,MAAMxU,OAASiV,EAAIoB,IAAI7B,MAAMxU,QAErGgB,KAAKqW,uBnB43EXnX,IAAK,UACLxC,MAAO,SmB13EF4Z,GAAS,GAAAvI,GAAA/N,KACTuW,EAAYC,KAAKC,MAEnBpT,EAAOqT,QAAQC,UACb5V,EAAU,GAAI6D,IAChB0R,IACF/Z,OAAOmG,KAAK4T,GAAS9Y,QAAQ,SAAAmJ,GAAA,MAAK5F,GAAQ+D,IAAI6B,EAAG2P,EAAQ3P,KAG3D,IAAMiQ,GAAY5W,KAAK+V,QAAQlB,OAAO,SAACZ,EAAGoB,GAAJ,MAAUpB,GAAIoB,EAAEwB,OAAO7X,QAAQ,GAE/Db,IAgBN,OAfI6B,MAAKiW,aACP9X,EAAQH,KAAK,cAEXgC,KAAKmW,mBAAmBpC,+BAC1B5V,EAAQH,KAAK,gCAGfmS,QAAQC,MACRD,QAAQC,IAAI,uBAAwBpQ,KAAKwT,MAAMsD,MAAO3Y,EAAQa,OAAS,EAAjB,IAAyBb,EAAQP,KAAK,KAAtC,IAAgD,IACtGuS,QAAQC,MAERpQ,KAAK+V,QAAU/S,MAAMC,MAAK,EAAAoE,cAASrH,KAAK+V,QAAS,SAAAgB,GAAA,MAAKA,GAAEvD,OAAO,SAAAuD,GAAA,MAC5DA,GAAEC,UAAYD,EAAEC,UAAUvW,IAAI,SAAA+U,GAAA,MAAKA,GAAEhC,QAAS,OAC/ClN,UAEKoQ,QAAQO,IAAIjX,KAAK+V,QAAQtV,IAAI,SAACsW,EAAGhY,EAAGkV,GAIzC,MAHIlG,GAAKkI,aAAelX,EAAI,IAC1BsE,EAAO4Q,EAAElV,EAAI,GAAGmC,WAEX6V,EAAE7V,QAAQH,EAAVgN,EAAyB1K,MAC9BsL,KAAK,WACPwB,QAAQC,MACRD,QAAQC,IAAI,iBACPwG,EAAH,YAAuBE,OACnBN,KAAKC,MAAQF,EAAjB,OAAiCW,SAEnC/G,QAAQC,QAXHsG,SAYE,SAAA7H,GACHd,EAAKiI,UAITjI,EAAKiI,SAAU,EAEXnH,YAAA8G,cACF9G,EAAMuB,IAAIrP,EAASwV,GAEnBpG,QAAQC,IAAIvB,UnBu4EViH,IAGTjb,cmBn9EoBib,GnBu9Ef,SAASlb,EAAQC,GoB/9EvBD,EAAAC,QAAAsc,QAAA,WpBq+EM,SAASvc,EAAQC,GAEtB,YAQA,SAASuc,GAAgB3b,EAAKyD,EAAKxC,GAAiK,MAApJwC,KAAOzD,GAAOc,OAAOiC,eAAe/C,EAAKyD,GAAOxC,MAAOA,EAAOC,YAAY,EAAME,cAAc,EAAMD,UAAU,IAAkBnB,EAAIyD,GAAOxC,EAAgBjB,EAE3M,QAASG,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCARhHQ,OAAOiC,eAAe3D,EAAS,cAC7B6B,OAAO,GAGT,IAAIiC,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWtC,WAAasC,EAAWtC,aAAc,EAAOsC,EAAWpC,cAAe,EAAU,SAAWoC,KAAYA,EAAWrC,UAAW,GAAML,OAAOiC,eAAeK,EAAQI,EAAWC,IAAKD,IAAiB,MAAO,UAAUnD,EAAaqD,EAAYC,GAAiJ,MAA9HD,IAAYP,EAAiB9C,EAAYQ,UAAW6C,GAAiBC,GAAaR,EAAiB9C,EAAasD,GAAqBtD,MqB5+E5gBub,ErBk/EJ,WqBh/Ef,QAAAA,GAAYtZ,EAAMM,EAAOJ,EAAYqZ,EAAQvH,GAAUnU,EAAAoE,KAAAqX,GACrDrX,KAAKuX,MAAQxZ,EACbiC,KAAKwX,OAASnZ,EACd2B,KAAKyX,YAAcxZ,EACnB+B,KAAK0X,QAAUJ,EACftX,KAAKiQ,UAAYF,ErB8jFlB,MAxEApR,GAAa0Y,IACXnY,IAAK,MACLxC,MAAO,SqBr/ENqE,GACF,GAAM4W,IACJ1Z,WAAY+B,KAAKyX,YAAYjE,MAC7BnV,MAAO2B,KAAKwX,OAAOhE,MAgBrB,IAbyB9U,SAArBsB,KAAKuX,MAAM/D,OAA4C,OAArBxT,KAAKuX,MAAM/D,OAAkBxT,KAAKuX,MAAM/D,MAAMxU,OAAS,EAC3F2Y,EAAK5Z,KAAOiC,KAAKuX,MAAM/D,MAEvBmE,EAAK5Z,KAAL,IAAgBiC,KAAKwX,OAAOX,OAAO1T,QAAQnD,KAAKuX,OAGlDI,EAAK,WAAa3X,KAAKiQ,UAAU2H,QAAQC,IAAIjK,KAC7C+J,EAAK,cAAgB3X,KAAKiQ,UAAU2H,QAAQ5O,OAAO8O,eAE9C,OAAQ,MAAO,SAAS3V,SAASnC,KAAKiQ,UAAU2H,QAAQ5O,UAC3D2O,EAAK,YAAc3X,KAAKiQ,UAAU2H,QAAQnJ,MAGxCzO,KAAKiQ,UAAU8H,YAAc,OAAS,IAAK,KAAK5V,SAASnC,KAAKiQ,UAAU8H,YAAa,CAEvF,GAAMC,IAAuBhY,KAAKiQ,UAAU1B,QAAQ,iBAAmB,IACpE5M,MAAM,KAAK,GAAGqM,cAAcnM,MAG/B,IAAImW,EAAqB,CACvB,GAAIC,GAAejY,KAAKiQ,UAAUxB,KAC9ByJ,EAAe,IAES,eAAxBF,EACgC,MAA9BhY,KAAKiQ,UAAU8H,YAAsB,6BAA6Bha,KAAKka,KACzEC,EAAe,wDACfD,EAAeA,EAAavU,QAAQ,+BAAgC,OAErC,qBAAxBsU,IACTC,EAAejX,KAAKsN,UAAUtN,KAAKC,MAAMgX,GAAe,KAAM,IAG5DjY,KAAKuX,MAAMxK,QACb4K,EAAK,oBAAsB3X,KAAKuX,MAAMxK,OAGxC4K,EAAK,oBAAsBK,EAC3BL,EAAK,aAAkBO,EAAA,IAAmBA,EAAnB,IAAqC,IAA5D,KAAoED,GAIxEN,EAAK5W,QAAUC,KAAKsN,UAAUtL,MAAMC,KAAKlC,EAAQ2B,QAAQmS,OAAO,SAACZ,EAAGoB,GAAJ,MAC9D9Y,QAAOiE,OAAOyT,EAAdmD,KAAA,GAAuB/B,EAAMtU,EAAQiF,IAAIqP,UAAY,KAAM,GAEzDrV,KAAK0X,kBAAmBhT,OAC1BiT,EAAK9I,MAAQ7O,KAAK0X,QAAQxT,MAE1ByT,EAAKL,OAAStX,KAAK0X,OAGrB,IAAMS,GAAoB5b,OAAOmG,KAAKiV,GAAM9C,OAAO,SAACZ,EAAGoB,GAAJ,MAAW+C,MAAKC,IAAIpE,EAAGoB,EAAErW,SAAU,EAEtFmR,SAAQC,MACRD,QAAQC,IAAI,WAAWkI,KACvBnI,QAAQC,MACR7T,OAAOmG,KAAKiV,GAAMna,QAAQ,SAAAmJ,GAAA,MAAKwJ,SAAQC,IAAI,gBACzCzJ,EAAE4R,OACwB,KAA1BZ,EAAKhR,GAAGxD,QAAQ,MACZ,IAAIqV,OAAOL,EAAoBxR,EAAE3H,QACjC,GACJ2Y,EAAKhR,GAAGjD,QAAQ,MAAhB,KAA4B,IAAI8U,OAAO,OAEzCrI,QAAQC,UrBu/EFiH,IAGTxc,cqBxkFoBwc,GrB4kFf,SAASzc,EAAQC,GAEtB,YAMA,SAASe,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAJhHQ,OAAOiC,eAAe3D,EAAS,cAC7B6B,OAAO,GAKT,IsBtlFoB+b,GAEnB,QAAAA,GAAYrC,GAA8Bxa,EAAAoE,KAAAyY,GACxCzY,KAAK+T,gCAAkCqC,EtBylF1Cvb,csB5lFoB4d,GtBgmFf,SAAS7d,EAAQC,GAEtB,YAQA,SAASe,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCANhHQ,OAAOiC,eAAe3D,EAAS,cAC7B6B,OAAO,GAGT,IAAIiC,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWtC,WAAasC,EAAWtC,aAAc,EAAOsC,EAAWpC,cAAe,EAAU,SAAWoC,KAAYA,EAAWrC,UAAW,GAAML,OAAOiC,eAAeK,EAAQI,EAAWC,IAAKD,IAAiB,MAAO,UAAUnD,EAAaqD,EAAYC,GAAiJ,MAA9HD,IAAYP,EAAiB9C,EAAYQ,UAAW6C,GAAiBC,GAAaR,EAAiB9C,EAAasD,GAAqBtD,MuBxmF5gB4c,EvB4mFJ,WuB1mFf,QAAAA,GAAYxa,GAAMtC,EAAAoE,KAAA0Y,GAChB1Y,KAAKwT,MAAQtV,EACb8B,KAAKgX,UAAY,KACjBhX,KAAK2Y,WAAY,EACjB3Y,KAAK4Y,SAAW,KAChB5Y,KAAK6W,OAAS,KACd7W,KAAK6Y,SAAW,KvBsrFjB,MAtEAla,GAAa+Z,IACXxZ,IAAK,WACLxC,MAAO,SuB/mFDoc,GAEP,MADA9Y,MAAKgX,UAAYhU,MAAM4H,QAAQkO,GAAUA,GAAUA,GAC5C9Y,QvBknFNd,IAAK,WACLxC,MAAO,WuB9mFR,MADAsD,MAAK2Y,WAAY,EACV3Y,QvBmnFNd,IAAK,UACLxC,MAAO,SuBjnFFwB,GAEN,MADA8B,MAAK4Y,SAAW1a,EACT8B,QvBonFNd,IAAK,QACLxC,MAAO,SuBlnFJma,GAEJ,MADA7W,MAAK6W,OAASA,EACP7W,QvBqnFNd,IAAK,UACLxC,MAAO,SuBnnFFqE,EAAS9C,EAAYoF,GAAM,GAAA0K,GAAA/N,IA8BjC,OA7BKA,MAAK6Y,WAAU,WAClB,IAAK5a,IAAeoF,EAClB,KAAM,IAAIqB,OAAM,wBAGlB,IAAIqU,GAAO1V,CACP0K,GAAKiJ,YACP+B,EAAOrC,QAAQO,IAAIlJ,EAAKiJ,UAAUvW,IAAI,SAAAsW,GAAA,MAAKA,GAAE7V,QAAQmC,EAAMtC,KAAUuH,QAAQjF,MAE/E0K,EAAK8K,SAAW,GAAInC,SAAQ,SAACC,EAASqC,GAChCjL,EAAK4K,YAAc1a,EAAWgY,YAChC8C,EAAKpK,KAAK,WACR+H,QAAQO,IAAIlJ,EAAK8I,OAAOpW,IAAI,SAAAmB,GAAA,MAAKA,GAAEV,QAAQH,EAAVgN,EAAyB9P,MAAc0Q,KAAKgI,EAASqC,MAEnF,WACL,GAAMtQ,GAAQqF,EAAK8I,OAAOzR,QAAQ6T,UAE5BC,EAAY,QAAZA,KACAxQ,EAAM1J,OACR0J,EAAMtE,MAAMlD,QAAQH,EAApBgN,EAAmC9P,GAAY0Q,KAAKuK,EAAWF,GAE/DrC,IAIJoC,GAAKpK,KAAKuK,EAAWF,WAIpBhZ,KAAK6Y,avBioFNH,IAGT7d,cuBjsFoB6d,GvBqsFf,SAAS9d,EAAQC,EAASE,GAE/B,YAwBA,SAASS,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GAEvF,QAASG,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCwB3tFjH,QAASod,GAASC,EAAKC,GAAmB,GAAZC,GAAYnZ,UAAAnB,QAAA,GAAAN,SAAAyB,UAAA,GAAL,IAAKA,UAAA,EACxC,OAAIiZ,GAAIpa,OAASqa,EACRD,EAAME,EAAKd,OAAOa,EAAQD,EAAIpa,QAEhCoa,EAKT,QAASG,GAAc9O,GACrB,GAAM+O,GAAQ/O,EAAKgP,WAAW/V,QAAQgW,EAAgB,IAClD3W,EAASyW,EAAMpU,MAAMoU,EAAMrW,QAAQ,KAAO,EAAGqW,EAAMrW,QAAQ,MAAMgL,MAAMwL,EAI3E,OAHe,QAAX5W,IACFA,MAEKA,EAGT,QAAS6W,GAA2BnP,EAAMsF,EAAUtB,EAAM1N,GACxD,GAAM8Y,GAAe,GAAIjV,IACzBiV,GAAa/U,IAAI,WAAYiL,GAC7B8J,EAAa/U,IAAI,OAAQ2J,GACzBoL,EAAa/U,IAAI,UAAW/D,EAC5B,IAAM+Y,IAAQD,EAGd,OAFA7W,OAAMC,KAAK4W,EAAavT,UAAUxE,OAAO,SAAAvG,GAAA,MAAKA,aAAaqJ,OAAKpH,QAAQ,SAAAiD,GAAA,MAAOqZ,GAAK9b,KAAKyC,KAElFgK,EAAKvK,MAAM,KAAMqZ,EAAc9O,GAAMhK,IAAI,SAAAvC,GAC9C,GAAMuC,GAAMqZ,EAAK/I,KAAK,SAAA1V,GAAA,MAAKA,GAAE0K,IAAI7H,IACjC,OAAIuC,GACKA,EAAIuF,IAAI9H,GADjB,UxBuqFH3B,OAAOiC,eAAe3D,EAAS,cAC7B6B,OAAO,GAGT,IAAIiC,GAAe,WAAc,QAASC,GAAiBC,EAAQC,GAAS,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,GAAIE,GAAaH,EAAMC,EAAIE,GAAWtC,WAAasC,EAAWtC,aAAc,EAAOsC,EAAWpC,cAAe,EAAU,SAAWoC,KAAYA,EAAWrC,UAAW,GAAML,OAAOiC,eAAeK,EAAQI,EAAWC,IAAKD,IAAiB,MAAO,UAAUnD,EAAaqD,EAAYC,GAAiJ,MAA9HD,IAAYP,EAAiB9C,EAAYQ,UAAW6C,GAAiBC,GAAaR,EAAiB9C,EAAasD,GAAqBtD,MwB5sFjiBiE,EAAAhF,EAAA,GxBgtFKsE,EAAY7D,EAAuBuE,GwB/sFxCga,EAAAhf,EAAA,IxBmtFKif,EAAmBxe,EAAuBue,GwBltF/CtE,EAAA1a,EAAA,IACA2a,GxBqtFgBla,EAAuBia,GwBrtFvC1a,EAAA,KxBytFK4a,EAAcna,EAAuBka,GwBhtFpCgE,EAAiB,mCACjBC,EAAiB,aA2BFM,ExBquFT,WwBnuFV,QAAAA,GAAY/b,GAAMtC,EAAAoE,KAAAia,GAChBja,KAAKwT,MAAQtV,EACb8B,KAAK6M,QAAU,KACf7M,KAAK4M,KAAO,KACZ5M,KAAKka,aAAe,KACpBla,KAAKma,qBAAuB,KAC5Bna,KAAKkT,MAAQ,KACblT,KAAKoa,QAAU,KACfpa,KAAK+M,MAAQ,KACb/M,KAAKqa,MAAQ,KACbra,KAAKsa,QAAU,KACfta,KAAK6Y,SAAW,KxB28FjB,MAlOAla,GAAasb,IACX/a,IAAK,UACLxC,MAAO,SwBxuFFqE,EAAS1C,EAAOJ,GAAY,GAAA8P,GAAA/N,IAuIlC,OAtIKA,MAAK6Y,WAAU,WAClB,GAAI9P,GAAMgF,EAAKnB,IACI,mBAAR7D,KACTA,EAAMA,EAAIhI,GAGZ,IAAMwZ,GAAoB,SAAClf,EAAG6C,GAAJ,MAAc6C,GAAQgF,IAAI7H,GAAQ6C,EAAQiF,IAAI9H,GAAQ7C,EAEhF0N,GAAMA,EAAIrF,QAAQ,qBAAsB6W,GACxCxR,EAAMA,EAAIrF,QAAQ,mBAAoB6W,EAEtC,IAAMC,GAASzZ,EAAQiF,IAAI,WAAa+C,EAEpC0F,EAAOV,EAAKmF,KACI,mBAATzE,KACTA,EAAOA,EAAK1N,GAGd,IAAMiY,GAAS,SAAC1B,EAAQvH,GAAT,MACb2G,SAAQsC,OAAO,GAAArD,cAAA5H,EAAoB1P,EAAOJ,EAAYqZ,EAAQvH,KAE1DhB,EAAS,SAACgB,GACd,IAAKhC,EAAKqM,SAAmC,gBAAjBrM,GAAKqM,QAC/B,MAAOpB,GAAO,0BAA2BjJ,EAE3C,IAAIA,EAASgI,aAAehK,EAAKqM,QAC/B,MAAOpB,GAAA,mBAA0BjJ,EAASgI,WAAnC,4BAAyEhK,EAAKqM,QAAWrK,EAElG,IAAIhC,EAAKoM,qBAAsB,CAC7B,GAAMM,IAAe1K,EAASxB,QAAQ,iBAAmB,IAAI5M,MAAM,IAAK,GAAG,EAC3E,IAAI8Y,IAAgB1M,EAAKoM,qBACvB,MAAOnB,GAAA,yBAAgCyB,EAAhC,4BAAuE1M,EAAKoM,qBACjFpK,GAGN,MAAO2G,SAAQC,QAAQ5G,IAGnBtO,EAAO,SAACsO,GACZ,GAAIhC,EAAKhB,MAAO,CACd,GAAM2N,GAAerb,aAAQsb,QAAQ5M,EAAKhB,MAC1C,KAAK2N,EACH,MAAO1B,GAAA,kCAAyCjL,EAAKhB,MAASgD,EAEhE,KACE,GAAMZ,GAAOnO,KAAKC,MAAM8O,EAAStB,KACjCsB,GAAS6K,SAAWzL,EACpBuL,EAAanJ,SAASpC,EAAM,QAAQ,EAAOlR,EAAWkY,oBACtD,MAAO9L,GACP,MAAO2O,GAAO3O,EAAG0F,GAEnB,MAAO2G,SAAQC,QAAQ5G,GAEzB,MAAO2G,SAAQC,QAAQ5G,IAGnB8K,EAAS,SAAC9K,GACd,MAAIhC,GAAKuM,QACA5D,QAAQO,IAAIlJ,EAAKuM,QAAQ7Z,IAAI,SAACgK,EAAM1L,GAAP,MAClC2X,SAAQC,QAAQiD,EACdnP,EACAsF,EACsBrR,SAAtBqR,EAAS6K,SAAyB7K,EAAS6K,SAAW7K,EAAStB,KAC/D1N,IACC4N,KAAK,SAAAmM,GACN,MAAKA,GAGEpE,QAAQC,QAAQ5G,GAFdiJ,EAAA,gBAAuBja,EAAvB,WAAoCgR,QAI9CpB,KAAK,iBAAM+H,SAAQC,QAAQ5G,KAEzB2G,QAAQC,QAAQ5G,IAGnBgL,EAAO,SAAChL,GACZ,MAAIhC,GAAKsM,MACA3D,QAAQO,IAAIjU,MAAMC,KAAK8K,EAAKsM,MAAM3X,QAAQjC,IAAI,SAAAvB,GAAA,MACnDwX,SAAQC,QACNiD,EACE7L,EAAKsM,MAAMrU,IAAI9G,GACf6Q,EACsBrR,SAAtBqR,EAAS6K,SAAyB7K,EAAS6K,SAAW7K,EAAStB,KAC/D1N,IAEF4N,KAAK,SAAA5J,GACL,GAAIhE,EAAQgF,IAAI7G,GACd,KAAM,IAAIwF,OAAJ,qCAA+CxF,EAA/C,IAER6B,GAAQ+D,IAAI5F,EAAK6F,QAGlB4J,KAAK,iBAAM+H,SAAQC,QAAQ5G,KAEzB2G,QAAQC,QAAQ5G,IAGnB5R,GACJ0Z,IAAK2C,EACLxR,OAAQ+E,EAAKlB,QACb0B,SACEC,eAAgBT,EAAKmM,cAAgB,mBACrCc,OAAQja,EAAQiF,IAAI3H,EAAMua,WAE5BqC,yBAAyB,EACzBC,QAAQ,EAGgB,uCAAtBnN,EAAKmM,aACP/b,EAAQgd,KAAO1M,EACgB,wBAAtBV,EAAKmM,aACd/b,EAAQid,SAAW3M,EAEnBtQ,EAAQsQ,KAAOA,EAGjBV,EAAK8K,UAAW,EAAAmB,cAAG7b,GAChBwQ,KAAK,SAAAC,GAAA,MAAOG,GAAOH,KACnBD,KAAK,SAAAC,GAAA,MAAOnN,GAAKmN,KACjBD,KAAK,SAAAC,GAAA,MAAOiM,GAAOjM,KACnBD,KAAK,SAAAC,GAAA,MAAOmM,GAAKnM,KACjBD,KAAK,WACJ,MAAI1Q,GAAW+X,QACNU,QAAQsC,UAEjB7I,QAAQC,IAAI,kBACV+I,EAAS9a,EAAMmV,MAAOvV,EAAWod,yBAAyBC,KAC1DnC,EAASpL,EAAKlB,QAAQiL,cAAe,GAAGZ,QACxCnO,EACAgF,EAAKyF,MAAM+H,MAEN7E,QAAQC,gBAGd3W,KAAK6Y,YxBuuFX3Z,IAAK,MACLxC,MAAO,SwBruFNqM,GAIF,MAHA/I,MAAK6M,QAAU,MACf7M,KAAK4M,KAAO7D,EACZ/I,KAAKoa,QAAUpa,KAAKoa,SAAW,IACxBpa,QxBwuFNd,IAAK,OACLxC,MAAO,SwBtuFLqM,GAIH,MAHA/I,MAAK6M,QAAU,OACf7M,KAAK4M,KAAO7D,EACZ/I,KAAKoa,QAAUpa,KAAKoa,SAAW,IACxBpa,QxByuFNd,IAAK,MACLxC,MAAO,SwBvuFNqM,GAIF,MAHA/I,MAAK6M,QAAU,MACf7M,KAAK4M,KAAO7D,EACZ/I,KAAKoa,QAAUpa,KAAKoa,SAAW,IACxBpa,QxB0uFNd,IAAK,SACLxC,MAAO,SwBxuFHqM,GAIL,MAHA/I,MAAK6M,QAAU,SACf7M,KAAK4M,KAAO7D,EACZ/I,KAAKoa,QAAUpa,KAAKoa,SAAW,IACxBpa,QxB2uFNd,IAAK,OACLxC,MAAO,SwBzuFL6F,GAOH,MANAvC,MAAKka,aAAe,mBACA,kBAAT3X,GACTvC,KAAKkT,MAAQ,SAAAnS,GAAA,MAAWC,MAAKsN,UAAU/L,EAAKxB,KAE5Cf,KAAKkT,MAAQlS,KAAKsN,UAAU/L,GAEvBvC,QxB8uFNd,IAAK,OACLxC,MAAO,SwB5uFL6F,GAGH,MAFAvC,MAAKka,aAAe,oCACpBla,KAAKkT,MAAQ3Q,EACNvC,QxB+uFNd,IAAK,WACLxC,MAAO,SwB7uFD6F,GACPvC,KAAKka,aAAe,qBACpB,IAAMiB,GAAO,GAAIK,SAGjB,OAFAjf,QAAOmG,KAAKH,GAAM/E,QAAQ,SAAA0B,GAAA,MAAOic,GAAKrW,IAAI5F,EAAKqD,EAAKrD,MACpDc,KAAKkT,MAAQiI,EACNnb,QxBkvFNd,IAAK,OACLxC,MAAO,SwBhvFLwB,EAAMuM,GAKT,MAJKzK,MAAKqa,QACRra,KAAKqa,MAAQ,GAAIzV,MAEnB5E,KAAKqa,MAAMvV,IAAI5G,EAAMuM,GACdzK,QxBmvFNd,IAAK,SACLxC,MAAO,SwBjvFH+E,GAaL,MAZoB,kBAATA,IACJzB,KAAKsa,UACRta,KAAKsa,YAEPta,KAAKsa,QAAQtc,KAAKyD,IACO,gBAATA,GAChBzB,KAAKoa,QAAU3Y,EACgB,KAAtBA,EAAK0B,QAAQ,KACtBnD,KAAKma,qBAAuB1Y,EAE5BzB,KAAK+M,MAAQtL,EAERzB,SxBqvFDia,IAGTpf,cwB39FoBof,GxB+9Ff,SAASrf,EAAQC,GyBzgGvBD,EAAAC,QAAAsc,QAAA,oBzB+gGM,SAASvc,EAAQC,G0B/gGvBD,EAAAC,QAAAsc,QAAA,S1BqhGM,SAASvc,EAAQC,G2BrhGvBD,EAAAC,QAAAsc,QAAA,O3B2hGM,SAASvc,EAAQC,G4B3hGvBD,EAAAC,QAAAsc,QAAA","file":"squalus-node.js","sourcesContent":["module.exports =\n/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"lib/\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.test = exports.group = exports.collection = exports.squalus = undefined;\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Squalus2 = __webpack_require__(1);\n\t\n\tvar _Squalus3 = _interopRequireDefault(_Squalus2);\n\t\n\tvar _TestCollection = __webpack_require__(17);\n\t\n\tvar _TestCollection2 = _interopRequireDefault(_TestCollection);\n\t\n\tvar _TestGroup = __webpack_require__(21);\n\t\n\tvar _TestGroup2 = _interopRequireDefault(_TestGroup);\n\t\n\tvar _Test = __webpack_require__(22);\n\t\n\tvar _Test2 = _interopRequireDefault(_Test);\n\t\n\tvar _path = __webpack_require__(24);\n\t\n\tvar _path2 = _interopRequireDefault(_path);\n\t\n\tvar _fs = __webpack_require__(25);\n\t\n\tvar _fs2 = _interopRequireDefault(_fs);\n\t\n\tvar _jsYaml = __webpack_require__(26);\n\t\n\tvar _jsYaml2 = _interopRequireDefault(_jsYaml);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tfunction getFiles(source, regex) {\n\t  var files = [];\n\t\n\t  var findChildren = function findChildren(dir) {\n\t    return _fs2.default.readdirSync(dir).forEach(function (f) {\n\t      var child = _path2.default.join(dir, f);\n\t      if (_fs2.default.statSync(child).isDirectory()) {\n\t        findChildren(child);\n\t      } else if (regex.test(f)) {\n\t        files.push(child);\n\t      }\n\t    });\n\t  };\n\t\n\t  if (_fs2.default.statSync(source).isDirectory()) {\n\t    findChildren(source);\n\t  } else {\n\t    files.push(source);\n\t  }\n\t\n\t  return files;\n\t}\n\t\n\tvar SqualusNode = function (_Squalus) {\n\t  _inherits(SqualusNode, _Squalus);\n\t\n\t  function SqualusNode() {\n\t    _classCallCheck(this, SqualusNode);\n\t\n\t    return _possibleConstructorReturn(this, Object.getPrototypeOf(SqualusNode).apply(this, arguments));\n\t  }\n\t\n\t  _createClass(SqualusNode, null, [{\n\t    key: 'execute',\n\t    value: function execute(typePath, collectionInstance, initialContextPath) {\n\t      var files = getFiles(typePath, /\\.yaml$/);\n\t\n\t      if (files.length) {\n\t        var types = Object.assign.apply(null, files.map(function (file) {\n\t          return _jsYaml2.default.safeLoad(_fs2.default.readFileSync(file, { encoding: 'utf8' }));\n\t        }));\n\t\n\t        _Squalus3.default.buildTypes(types);\n\t      }\n\t\n\t      var context = undefined;\n\t      if (initialContextPath) {\n\t        context = JSON.parse(_fs2.default.readFileSync(initialContextPath, { encoding: 'utf8' }));\n\t      }\n\t\n\t      return collectionInstance.execute(context);\n\t    }\n\t  }]);\n\t\n\t  return SqualusNode;\n\t}(_Squalus3.default);\n\t\n\tfunction collection(name, options) {\n\t  return new _TestCollection2.default(name, options);\n\t}\n\t\n\tfunction group(name) {\n\t  return new _TestGroup2.default(name);\n\t}\n\t\n\tfunction test(name) {\n\t  return new _Test2.default(name);\n\t}\n\t\n\texports.squalus = SqualusNode;\n\texports.collection = collection;\n\texports.group = group;\n\texports.test = test;\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\t\n\tvar _Tag = __webpack_require__(2);\n\t\n\tvar _Tag2 = _interopRequireDefault(_Tag);\n\t\n\tvar _Endpoint = __webpack_require__(3);\n\t\n\tvar _Endpoint2 = _interopRequireDefault(_Endpoint);\n\t\n\tvar _TopoSort = __webpack_require__(5);\n\t\n\tvar _TopoSort2 = _interopRequireDefault(_TopoSort);\n\t\n\tvar _BranchType = __webpack_require__(6);\n\t\n\tvar _BranchType2 = _interopRequireDefault(_BranchType);\n\t\n\tvar _ArrayType = __webpack_require__(10);\n\t\n\tvar _ArrayType2 = _interopRequireDefault(_ArrayType);\n\t\n\tvar _AttributeType = __webpack_require__(11);\n\t\n\tvar _AttributeType2 = _interopRequireDefault(_AttributeType);\n\t\n\tvar _ObjectType = __webpack_require__(12);\n\t\n\tvar _ObjectType2 = _interopRequireDefault(_ObjectType);\n\t\n\tvar _ScalarType = __webpack_require__(9);\n\t\n\tvar _ScalarType2 = _interopRequireDefault(_ScalarType);\n\t\n\tvar _MapType = __webpack_require__(13);\n\t\n\tvar _MapType2 = _interopRequireDefault(_MapType);\n\t\n\tvar _BoolScalarType = __webpack_require__(14);\n\t\n\tvar _BoolScalarType2 = _interopRequireDefault(_BoolScalarType);\n\t\n\tvar _FloatScalarType = __webpack_require__(15);\n\t\n\tvar _FloatScalarType2 = _interopRequireDefault(_FloatScalarType);\n\t\n\tvar _IntScalarType = __webpack_require__(16);\n\t\n\tvar _IntScalarType2 = _interopRequireDefault(_IntScalarType);\n\t\n\tvar _NullScalarType = __webpack_require__(8);\n\t\n\tvar _NullScalarType2 = _interopRequireDefault(_NullScalarType);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\t_ScalarType2.default.register('null', _NullScalarType2.default);\n\t_ScalarType2.default.register(['int', 'uint'], _IntScalarType2.default);\n\t_ScalarType2.default.register('float', _FloatScalarType2.default);\n\t_ScalarType2.default.register('bool', _BoolScalarType2.default);\n\t\n\tvar registeredTypes = new Map();\n\t\n\tfunction findPreviousTokenGroupStart(tokens, i) {\n\t  if (tokens[i] === ')') {\n\t    var depth = 0;\n\t    for (var j = i - 1; j >= 0; j--) {\n\t      if (tokens[j] === ')') {\n\t        ++depth;\n\t      } else if (tokens[j] === '(') {\n\t        if (depth === 0) {\n\t          return findPreviousTokenGroupStart(tokens, j - 1);\n\t        }\n\t        --depth;\n\t      }\n\t    }\n\t  } else if (tokens[i] === '}') {\n\t    for (var _j = i - 1; _j >= 0; _j--) {\n\t      if (tokens[_j] === '{') {\n\t        return findPreviousTokenGroupStart(tokens, _j - 1);\n\t      }\n\t    }\n\t  } else if (tokens[i] === '[]') {\n\t    return findPreviousTokenGroupStart(tokens, i - 1);\n\t  }\n\t\n\t  return i >= 0 ? i : 0;\n\t}\n\t\n\tfunction parseTokensFromType(type, dependenciesOnly) {\n\t  /*\n\t   * e.g.\n\t   *   type\n\t   *   type:map(Name,Value)\n\t   *   type1|type2|type3\n\t   *   type1 => type2\n\t   *   int{1,2,7-9}?\n\t   *   string?[]?\n\t   *   (string => int{2,4-9}|bool|string?)?[]?\n\t   *   type1,type2 # this only applies to inheritance\n\t   * todo:\n\t   *   content-type(image/png) && signature(89 50 4E 47 0D 0A 1A 0A)\n\t   */\n\t  var tokens = type.split(/([|{}()?:,]|&&|\\[]|=>)/).map(function (t) {\n\t    return t.trim();\n\t  }).filter(function (t) {\n\t    return t !== '';\n\t  });\n\t\n\t  // expand shortcuts\n\t  for (var i = 0; i < tokens.length; i++) {\n\t    if (tokens[i] === '?') {\n\t      var previous = findPreviousTokenGroupStart(tokens, i - 1);\n\t      tokens.splice(previous, 0, '(');\n\t      tokens.splice(i + 1, 1, '|', 'null', ')');\n\t      --i;\n\t    }\n\t  }\n\t\n\t  if (!dependenciesOnly) {\n\t    return tokens;\n\t  }\n\t\n\t  /*\n\t   * remove\n\t   *   |\n\t   *   []\n\t   *   {...}\n\t   *   :func(...)\n\t   */\n\t  var dependencies = [];\n\t  for (var _i = 0; _i < tokens.length; _i++) {\n\t    if (tokens[_i] === '{') {\n\t      while (tokens[_i] !== '}') {\n\t        ++_i;\n\t      }\n\t      continue;\n\t    } else if (tokens[_i] === ':') {\n\t      while (tokens[_i] !== ')') {\n\t        ++_i;\n\t      }\n\t      continue;\n\t    } else if (['[]', '=>', '|', ',', '(', ')'].includes(tokens[_i])) {\n\t      continue;\n\t    }\n\t    dependencies.push(tokens[_i]);\n\t  }\n\t\n\t  return dependencies;\n\t}\n\t\n\tfunction buildKnownDependencies() {\n\t  return _ScalarType2.default.getScalarTypes().map(function (t) {\n\t    return {\n\t      name: t,\n\t      data: t\n\t    };\n\t  });\n\t}\n\t\n\tfunction parseChild(types) {\n\t  var dependencies = new Set();\n\t\n\t  Object.keys(types).forEach(function (key) {\n\t    var type = types[key];\n\t\n\t    if (typeof type === 'string') {\n\t      parseTokensFromType(type, true).forEach(function (t) {\n\t        return dependencies.add(t);\n\t      });\n\t    } else {\n\t      parseChild(type).forEach(function (t) {\n\t        return dependencies.add(t);\n\t      });\n\t    }\n\t  });\n\t\n\t  return dependencies;\n\t}\n\t\n\tfunction scopify(iter, scope) {\n\t  var source = iter;\n\t  if (typeof iter === 'string') {\n\t    source = [iter];\n\t  }\n\t  var result = Array.from(source, function (item) {\n\t    return item.indexOf('{') === -1 && item.indexOf('[') === -1 && item.indexOf('|') === -1 && item.indexOf('.') === -1 && !_ScalarType2.default.getScalarTypes().includes(item) ? scope + '.' + item : item;\n\t  });\n\t\n\t  return typeof iter === 'string' ? result[0] : result;\n\t}\n\t\n\tfunction parseRoot(root) {\n\t  var parsed = [];\n\t\n\t  Object.keys(root).forEach(function (scope) {\n\t    Object.keys(root[scope]).forEach(function (name) {\n\t      var type = root[scope][name];\n\t\n\t      var requires = new Set();\n\t\n\t      if (typeof type === 'string') {\n\t        parseTokensFromType(type, true).forEach(function (t) {\n\t          return requires.add(t);\n\t        });\n\t      } else {\n\t        parseChild(type).forEach(function (t) {\n\t          return requires.add(t);\n\t        });\n\t      }\n\t\n\t      parsed.push({\n\t        name: scopify(name, scope),\n\t        requires: scopify(requires, scope),\n\t        data: type\n\t      });\n\t    });\n\t  });\n\t\n\t  return parsed;\n\t}\n\t\n\tfunction createAttrFromName(name, type) {\n\t  return new _AttributeType2.default(name.replace(/\\?$/, ''), type.clone(), !name.endsWith('?'));\n\t}\n\t\n\tfunction stripOuterParens(array) {\n\t  if (array[0] === '(' && array[array.length - 1] === ')') {\n\t    array.splice(array.length - 1);\n\t    array.splice(0, 1);\n\t  }\n\t}\n\t\n\tfunction splitArray(array, split) {\n\t  stripOuterParens(array);\n\t\n\t  var chunks = [];\n\t  var chunk = [];\n\t  var stack = [];\n\t  array.forEach(function (token) {\n\t    if (token === '(') {\n\t      stack.push(true);\n\t      chunk.push(token);\n\t    } else if (token === ')') {\n\t      stack.pop();\n\t      chunk.push(token);\n\t    } else if (!stack.length && token === split) {\n\t      if (chunk.length) {\n\t        chunks.push(chunk);\n\t      }\n\t      chunk = [];\n\t    } else {\n\t      chunk.push(token);\n\t    }\n\t  });\n\t  if (chunk.length) {\n\t    chunks.push(chunk);\n\t  }\n\t\n\t  chunks.forEach(function (c) {\n\t    return stripOuterParens(c);\n\t  });\n\t\n\t  return chunks;\n\t}\n\t\n\tfunction buildType(def, scope) {\n\t  // shortcuts\n\t  if (typeof def === 'boolean') {\n\t    def = def ? 'bool{true}' : 'bool{false}'; // eslint-disable-line no-param-reassign\n\t  }\n\t\n\t  // references\n\t  if (typeof def === 'string') {\n\t    var tokens = parseTokensFromType(def);\n\t\n\t    var branches = splitArray(tokens, '|');\n\t    if (branches.length > 1) {\n\t      var _ret = function () {\n\t        if (branches.length !== new Set(branches).size) {\n\t          throw new Error('duplicate types in branch list');\n\t        }\n\t        var branchMap = new Map();\n\t        branches.forEach(function (branch) {\n\t          branchMap.set(branch, buildType(scopify(branch.join(''), scope)));\n\t        });\n\t        return {\n\t          v: _BranchType2.default.create(branchMap)\n\t        };\n\t      }();\n\t\n\t      if ((typeof _ret === 'undefined' ? 'undefined' : _typeof(_ret)) === \"object\") return _ret.v;\n\t    }\n\t\n\t    var map = splitArray(tokens, '=>');\n\t    if (map.length > 1) {\n\t      return new _MapType2.default(buildType(map[0].join(''), scope), buildType(map[1].join(''), scope));\n\t    }\n\t\n\t    if (tokens[tokens.length - 1] === '[]') {\n\t      return new _ArrayType2.default(buildType(tokens.slice(0, tokens.length - 1).join(''), scope));\n\t    }\n\t\n\t    if (tokens[tokens.length - 1] === '}') {\n\t      return _ScalarType2.default.create(tokens[tokens.indexOf('{') - 1], tokens.slice(tokens.indexOf('{') + 1, tokens.length - 1).filter(function (t) {\n\t        return t !== ',';\n\t      }));\n\t    }\n\t\n\t    if (tokens[tokens.length - 1] === ')') {\n\t      var _ret2 = function () {\n\t        var transformStart = tokens.indexOf(':');\n\t        var transformName = tokens[transformStart + 1];\n\t        var transformArgs = tokens.slice(transformStart + 3, tokens.length - 1).filter(function (t) {\n\t          return t !== ',';\n\t        });\n\t\n\t        var transforms = {\n\t          map: function map(type) {\n\t            var branchMap = new Map();\n\t            type.attributes().forEach(function (attr) {\n\t              return branchMap.set(attr.name(), new _ObjectType2.default([new _AttributeType2.default(transformArgs[0], _ScalarType2.default.create('string', [attr.name()]), true), new _AttributeType2.default(transformArgs[1], attr.type().clone(), true)]));\n\t            });\n\t            return new _BranchType2.default(branchMap);\n\t          }\n\t        };\n\t        if (!transforms[transformName]) {\n\t          throw new Error('unsupported transform');\n\t        }\n\t        return {\n\t          v: transforms[transformName](buildType(tokens.slice(0, transformStart).join(''), scope))\n\t        };\n\t      }();\n\t\n\t      if ((typeof _ret2 === 'undefined' ? 'undefined' : _typeof(_ret2)) === \"object\") return _ret2.v;\n\t    }\n\t\n\t    var scopedName = scopify(tokens.join(''), scope);\n\t    if (registeredTypes.has(scopedName)) {\n\t      return registeredTypes.get(scopedName).clone();\n\t    }\n\t    return _ScalarType2.default.create(scopedName);\n\t  }\n\t\n\t  // check for inheritance\n\t  var attributeNames = Object.keys(def).filter(function (key) {\n\t    return key !== '^';\n\t  });\n\t  var inheritanceAttr = def['^'];\n\t  if (inheritanceAttr) {\n\t    if (typeof inheritanceAttr !== 'string') {\n\t      throw new Error('inheritance attribute must be a string');\n\t    }\n\t\n\t    var parents = parseTokensFromType(inheritanceAttr).filter(function (t) {\n\t      return t !== ',';\n\t    }).map(function (parent) {\n\t      return registeredTypes.get(scopify(parent, scope));\n\t    });\n\t\n\t    if (parents.length === 1 && parents[0] instanceof _BranchType2.default) {\n\t      var _ret3 = function () {\n\t        var parent = parents[0];\n\t        if (!Array.from(parent.types.values()).every(function (branchType) {\n\t          return branchType instanceof Object;\n\t        })) {\n\t          throw new Error('inheritance from branch with non-object');\n\t        }\n\t        // create inherited version of each object and re-aggregate\n\t        var inheritedTypes = new Map();\n\t        parent.types.forEach(function (branchType, key) {\n\t          var builder = function builder(t, k) {\n\t            // add attributes to each branch\n\t            var attributes = new Map();\n\t            t.attributes().forEach(function (attr) {\n\t              attributes.set(attr.name(), attr.clone());\n\t            });\n\t            attributeNames.forEach(function (attr) {\n\t              return attributes.set(attr.trim('?'), createAttrFromName(attr, buildType(def[attr], scope)));\n\t            });\n\t            inheritedTypes.set(k, new _ObjectType2.default(Array.from(attributes.values())));\n\t          };\n\t\n\t          if (branchType instanceof _BranchType2.default) {\n\t            branchType.types.forEach(function (t, k) {\n\t              return builder(t, key + '-' + k);\n\t            });\n\t          } else {\n\t            builder(branchType, key);\n\t          }\n\t        });\n\t        return {\n\t          v: new _BranchType2.default(inheritedTypes)\n\t        };\n\t      }();\n\t\n\t      if ((typeof _ret3 === 'undefined' ? 'undefined' : _typeof(_ret3)) === \"object\") return _ret3.v;\n\t    } else if (parents.every(function (parent) {\n\t      return parent instanceof _ObjectType2.default;\n\t    })) {\n\t      var _ret4 = function () {\n\t        // simple inheritance\n\t        var attributes = new Map();\n\t        parents.forEach(function (parent) {\n\t          parent.attributes().forEach(function (parentAttr) {\n\t            attributes.set(parentAttr, parentAttr.clone());\n\t          });\n\t        });\n\t        attributeNames.forEach(function (attr) {\n\t          return attributes.set(attr.trim('?'), createAttrFromName(attr, buildType(def[attr], scope)));\n\t        });\n\t        return {\n\t          v: new _ObjectType2.default(Array.from(attributes.values()))\n\t        };\n\t      }();\n\t\n\t      if ((typeof _ret4 === 'undefined' ? 'undefined' : _typeof(_ret4)) === \"object\") return _ret4.v;\n\t    }\n\t\n\t    throw new Error('invalid parent type');\n\t  }\n\t\n\t  // no inheritance\n\t  return new _ObjectType2.default(attributeNames.map(function (attr) {\n\t    return createAttrFromName(attr, buildType(def[attr], scope));\n\t  }));\n\t}\n\t\n\tvar Squalus = function () {\n\t  function Squalus() {\n\t    _classCallCheck(this, Squalus);\n\t  }\n\t\n\t  _createClass(Squalus, null, [{\n\t    key: 'getType',\n\t    value: function getType(name) {\n\t      return registeredTypes.get(name);\n\t    }\n\t  }, {\n\t    key: 'buildTypes',\n\t    value: function buildTypes(root) {\n\t      // check names and dependencies\n\t      var dependencies = buildKnownDependencies().concat(parseRoot(root));\n\t      var sorted = (0, _TopoSort2.default)(dependencies, function (d) {\n\t        return d.name;\n\t      }, function (d) {\n\t        return d.requires;\n\t      });\n\t\n\t      sorted.forEach(function (type, name) {\n\t        var scope = name.indexOf('.') ? name.substring(0, name.indexOf('.')) : null;\n\t        registeredTypes.set(name, buildType(type.data, scope));\n\t      });\n\t    }\n\t  }, {\n\t    key: 'buildTests',\n\t    value: function buildTests(tests, root) {\n\t      var ul = root.appendChild((0, _Tag2.default)('ul', { class: 'api-tests' }));\n\t\n\t      tests.forEach(function (test) {\n\t        var params = new Map();\n\t        if (test.params) {\n\t          Object.keys(test.params).forEach(function (key) {\n\t            params.set(key, buildType(test.params[key]));\n\t          });\n\t        }\n\t        var def = new _Endpoint2.default(test.url, test.method, params, test.data ? buildType(test.data) : null);\n\t        ul.appendChild((0, _Tag2.default)('li', def.build()));\n\t      });\n\t\n\t      var events = {\n\t        change: {\n\t          'select.test-option': _BranchType2.default.onChange\n\t        },\n\t        click: {\n\t          '.test-row-add': _ArrayType2.default.onClickAdd,\n\t          '.test-row-remove': _ArrayType2.default.onClickRemove,\n\t          '.test-attr-toggle': _AttributeType2.default.onClickToggle,\n\t          '.test-edit': _Endpoint2.default.onEdit,\n\t          '.test-submit': _Endpoint2.default.onSubmit\n\t        },\n\t        keypress: {\n\t          'input[type=text],input[type=checkbox],select': _Endpoint2.default.onKeyPress\n\t        }\n\t      };\n\t\n\t      // handle events\n\t      Object.keys(events).forEach(function (type) {\n\t        root.addEventListener(type, function (e) {\n\t          if (e.target) {\n\t            (function () {\n\t              var def = _Endpoint2.default.closest(e.target);\n\t              if (def) {\n\t                Object.keys(events[type]).forEach(function (selector) {\n\t                  if (e.target.matches(selector)) {\n\t                    var func = events[type][selector];\n\t                    func(e, def);\n\t                  }\n\t                });\n\t              }\n\t            })();\n\t          }\n\t        });\n\t      });\n\t\n\t      _BranchType2.default.initializeSelectionStates(root);\n\t    }\n\t  }]);\n\t\n\t  return Squalus;\n\t}();\n\t\n\texports.default = Squalus;\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\texports.default = function (tagName) {\n\t  for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n\t    args[_key - 1] = arguments[_key];\n\t  }\n\t\n\t  var attributes = args.length && isObject(args[0]) && !args[0].nodeType ? args[0] : {};\n\t  var children = args.slice(args[0] === attributes ? 1 : 0);\n\t\n\t  var elem = document.createElement(tagName);\n\t\n\t  Object.keys(attributes).forEach(function (name) {\n\t    if (name.startsWith('data-')) {\n\t      elem.dataset[name.substr(5)] = attributes[name];\n\t    } else if (name.startsWith('_')) {\n\t      elem[name] = attributes[name];\n\t    } else {\n\t      elem.setAttribute(name, attributes[name]);\n\t    }\n\t  });\n\t\n\t  children.forEach(function (child) {\n\t    if (Array.isArray(child)) {\n\t      child.forEach(function (c) {\n\t        appendNode(elem, c);\n\t      });\n\t    } else {\n\t      appendNode(elem, child);\n\t    }\n\t  });\n\t\n\t  return elem;\n\t};\n\t\n\tfunction isObject(obj) {\n\t  return obj === Object(obj) && !Array.isArray(obj);\n\t}\n\t\n\tfunction appendNode(element, content) {\n\t  if (content && content.nodeType) {\n\t    element.appendChild(content);\n\t  } else {\n\t    var div = document.createElement('div');\n\t    div.innerHTML = content === undefined ? '' : content;\n\t\n\t    while (div.firstChild) {\n\t      element.appendChild(div.firstChild);\n\t    }\n\t  }\n\t}\n\t\n\t// (tagName, attributes?, children?, children?)\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\t\n\tvar _Tag = __webpack_require__(2);\n\t\n\tvar _Tag2 = _interopRequireDefault(_Tag);\n\t\n\tvar _Result = __webpack_require__(4);\n\t\n\tvar _Result2 = _interopRequireDefault(_Result);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction closestAncestorByClassName(elem, className) {\n\t  var e = elem.parentNode;\n\t  while (e) {\n\t    if (e.classList && e.classList.contains(className)) {\n\t      return e;\n\t    }\n\t    e = e.parentNode;\n\t  }\n\t  return null;\n\t}\n\t\n\tfunction convertValueToParam(val, key, query) {\n\t  if (Array.isArray(val)) {\n\t    val.forEach(function (item, i) {\n\t      return convertValueToParam(item, key + '[' + i + ']', query);\n\t    });\n\t  } else if ((typeof val === 'undefined' ? 'undefined' : _typeof(val)) === 'object') {\n\t    Object.keys(val).forEach(function (name) {\n\t      return convertValueToParam(val[name], key + '[' + name + ']', query);\n\t    });\n\t  } else if (typeof val === 'boolean') {\n\t    query.set(key, encodeURI(val ? 1 : 0));\n\t  } else {\n\t    query.set(key, encodeURI(val));\n\t  }\n\t}\n\t\n\tvar Endpoint = function () {\n\t  function Endpoint(url, method, params, type) {\n\t    _classCallCheck(this, Endpoint);\n\t\n\t    this._url = url;\n\t    this._method = method;\n\t    this._params = params && params.size ? params : null;\n\t    this._type = type;\n\t\n\t    this._node = null;\n\t  }\n\t\n\t  _createClass(Endpoint, [{\n\t    key: 'updateSingleParam',\n\t    value: function updateSingleParam(data) {\n\t      if (this._params) {\n\t        if (data.Id) {\n\t          this._node.querySelector('.test-param')._squalusType.populate(data.Id);\n\t        }\n\t      }\n\t    }\n\t  }, {\n\t    key: 'value',\n\t    value: function value() {\n\t      if (!this._type) {\n\t        return null;\n\t      }\n\t      return this._type.value();\n\t    }\n\t  }, {\n\t    key: 'populate',\n\t    value: function populate(data, types) {\n\t      this._type.populate(data, 'body', types);\n\t    }\n\t  }, {\n\t    key: 'clear',\n\t    value: function clear() {\n\t      this._type.clear();\n\t    }\n\t  }, {\n\t    key: 'lock',\n\t    value: function lock() {\n\t      // this causes problems with the \"edit\" populate\n\t      // this._body.find('*').prop('disabled', true);\n\t    }\n\t  }, {\n\t    key: 'unlock',\n\t    value: function unlock() {\n\t      // this._body.find('*').prop('disabled', false);\n\t    }\n\t  }, {\n\t    key: 'getPopulatedUrl',\n\t    value: function getPopulatedUrl() {\n\t      var query = new Map();\n\t      var url = this._url;\n\t      if (this._params) {\n\t        Array.from(this._node.querySelectorAll('.test-param')).forEach(function (param) {\n\t          var key = param.dataset.name;\n\t          var keyPlaceholder = '{' + key + '}';\n\t          var val = param._squalusType.value();\n\t          if (url.indexOf(keyPlaceholder) === -1) {\n\t            if (val !== null && val !== '') {\n\t              convertValueToParam(val, key, query);\n\t            }\n\t          } else {\n\t            url = url.replace(keyPlaceholder, encodeURI(val));\n\t          }\n\t        });\n\t      }\n\t\n\t      url = new URL(url, window.location.href);\n\t      query.forEach(function (value, key) {\n\t        return url.searchParams.append(key, value);\n\t      });\n\t\n\t      return url;\n\t    }\n\t  }, {\n\t    key: 'build',\n\t    value: function build() {\n\t      var _this = this;\n\t\n\t      this._node = (0, _Tag2.default)('div', { class: 'endpoint endpoint-method-' + this._method.toLowerCase(), _squalusDef: this }, (0, _Tag2.default)('div', { class: 'endpoint-header' }, (0, _Tag2.default)('span', { class: 'endpoint-method' }, this._method), (0, _Tag2.default)('span', { class: 'endpoint-url' }, this._url)));\n\t\n\t      var test = this._node.appendChild((0, _Tag2.default)('div', { class: 'endpoint-test' }));\n\t\n\t      if (this._params) {\n\t        (function () {\n\t          var names = _this._url.match(/{[^}\\s]+}/g).map(function (m) {\n\t            return m.substr(1, m.length - 2);\n\t          });\n\t\n\t          if (_this._params.size > names.length) {\n\t            names.prototype.push.apply(names, Array.from(_this._params.keys()).filter(function (p) {\n\t              return !names.includes(p);\n\t            }));\n\t          }\n\t\n\t          var params = test.appendChild((0, _Tag2.default)('div', { class: 'endpoint-test-params' }, (0, _Tag2.default)('div', { class: 'endpoint-test-label' }, 'params')));\n\t          params.appendChild((0, _Tag2.default)('table', (0, _Tag2.default)('tbody', names.map(function (param) {\n\t            var type = _this._params.get(param);\n\t            if (type === undefined) {\n\t              throw new Error('required param type not specified');\n\t            }\n\t            return (0, _Tag2.default)('tr', { class: 'test-param', 'data-name': param, _squalusType: type }, (0, _Tag2.default)('th', param), (0, _Tag2.default)('td', type.build()));\n\t          }))));\n\t          if (_this._method === 'PUT') {\n\t            test.appendChild((0, _Tag2.default)('div', { class: 'endpoint-test-controls' }, (0, _Tag2.default)('input', { type: 'button', value: 'EDIT', class: 'test-edit' }), (0, _Tag2.default)('span', { class: 'endpoint-test-status test-edit-status' })));\n\t          }\n\t        })();\n\t      }\n\t\n\t      if (this._type) {\n\t        test.appendChild((0, _Tag2.default)('div', { class: 'endpoint-test-body' }, (0, _Tag2.default)('div', { class: 'endpoint-test-label' }, 'body'), this._type.build()));\n\t      }\n\t\n\t      test.appendChild((0, _Tag2.default)('div', { class: 'endpoint-test-controls' }, (0, _Tag2.default)('input', { type: 'button', value: this._method, class: 'test-submit' }), (0, _Tag2.default)('span', { class: 'endpoint-test-status' })));\n\t\n\t      return this._node;\n\t    }\n\t  }, {\n\t    key: 'submit',\n\t    value: function submit() {\n\t      // todo: trap parse errors\n\t      var url = this.getPopulatedUrl();\n\t      var value = JSON.stringify(this.value());\n\t\n\t      var options = {\n\t        method: this._method,\n\t        headers: {\n\t          'Content-Type': 'application/json'\n\t        }\n\t      };\n\t      if (['PUT', 'POST', 'PATCH'].includes(this._method)) {\n\t        options.body = value;\n\t      }\n\t\n\t      fetch(url, options).then(function (res) {\n\t        new _Result2.default(url, res).parse();\n\t      }).catch(function (error) {\n\t        new _Result2.default(url, error).parse();\n\t      });\n\t    }\n\t  }, {\n\t    key: 'edit',\n\t    value: function edit() {\n\t      var _this2 = this;\n\t\n\t      var url = this.getPopulatedUrl();\n\t      var status = this._node.querySelector('.test-edit-status');\n\t\n\t      status.textContent = '';\n\t\n\t      this.clear();\n\t      this.lock();\n\t\n\t      fetch(url).then(function (res) {\n\t        // testing\n\t        // const json = {\n\t        //   IntervalUnit: 'monthly',\n\t        //   IntervalOffset: 15,\n\t        //   TemplateId: 4,\n\t        //   Id: 3990,\n\t        // };\n\t\n\t        if (!res.ok) {\n\t          status.textContent = 'something went wrong';\n\t          _this2.unlock();\n\t          return;\n\t        }\n\t\n\t        res.json().then(function (json) {\n\t          var data = json;\n\t          // todo: this is going to require the actual validation implementation to handle branching\n\t\n\t          // if data is array, edit the first one (for convenience, to support shared id/search path)\n\t          if (Array.isArray(data)) {\n\t            if (data.length && _this2._params && _this2._params.size === 1) {\n\t              status.textContent = 'Loaded first record (' + data.length + ' total)';\n\t              data = data[0];\n\t              _this2.updateSingleParam(data);\n\t            } else {\n\t              data = null;\n\t            }\n\t          }\n\t          if (data) {\n\t            _this2.populate(data);\n\t          } else {\n\t            status.textContent = 'No match for pattern';\n\t          }\n\t\n\t          _this2.unlock();\n\t        });\n\t      }).catch(function (error) {\n\t        status.textContent = error.message;\n\t        _this2.unlock();\n\t      });\n\t    }\n\t  }], [{\n\t    key: 'onKeyPress',\n\t    value: function onKeyPress(event, def) {\n\t      if (event.which === 13) {\n\t        event.preventDefault();\n\t        (def || this.closest(event.target)).submit();\n\t      }\n\t    }\n\t  }, {\n\t    key: 'onSubmit',\n\t    value: function onSubmit(event, def) {\n\t      (def || this.closest(event.target)).submit();\n\t    }\n\t  }, {\n\t    key: 'onEdit',\n\t    value: function onEdit(event, def) {\n\t      (def || this.closest(event.target)).edit();\n\t    }\n\t  }, {\n\t    key: 'closest',\n\t    value: function closest(elem) {\n\t      var node = closestAncestorByClassName(elem, 'endpoint');\n\t      return node ? node._squalusDef : null;\n\t    }\n\t  }]);\n\t\n\t  return Endpoint;\n\t}();\n\t\n\texports.default = Endpoint;\n\n/***/ },\n/* 4 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Result = function () {\n\t  function Result(relativeUrl, response) {\n\t    _classCallCheck(this, Result);\n\t\n\t    this._relativeUrl = relativeUrl;\n\t    this._response = response;\n\t  }\n\t\n\t  _createClass(Result, [{\n\t    key: \"parse\",\n\t    value: function parse() {\n\t      if (this._response instanceof Response) {\n\t        if (this._response.ok) {\n\t          //\n\t        } else {\n\t            //\n\t          }\n\t      } else {\n\t          console.log(this._response.message);\n\t        }\n\t    }\n\t  }]);\n\t\n\t  return Result;\n\t}();\n\t\n\texports.default = Result;\n\n/***/ },\n/* 5 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\texports.default = function (elements, getName, getRequires) {\n\t  var edges = new Map();\n\t  var s = [];\n\t\n\t  var sources = new Map();\n\t  elements.forEach(function (elem) {\n\t    return sources.set(getName(elem), elem);\n\t  });\n\t\n\t  sources.forEach(function (source) {\n\t    var requires = getRequires(source);\n\t    if (requires && requires.length) {\n\t      requires.forEach(function (dependency) {\n\t        if (!sources.has(dependency)) {\n\t          throw new Error('Unknown dependency ' + dependency);\n\t        }\n\t        if (!edges.has(dependency)) {\n\t          edges.set(dependency, []);\n\t        }\n\t        edges.get(dependency).push(getName(source));\n\t      });\n\t    } else {\n\t      s.push(source);\n\t    }\n\t  });\n\t\n\t  var parents = void 0;\n\t  var sorted = new Map();\n\t  while (s.length > 0) {\n\t    var nSource = s.pop();\n\t    var n = getName(nSource);\n\t    sorted.set(n, nSource);\n\t    if (edges.has(n)) {\n\t      parents = edges.get(n);\n\t      while (parents.length > 0) {\n\t        var m = parents.pop();\n\t        var mSource = sources.get(m);\n\t        var requires = getRequires(mSource);\n\t        if (!requires || !requires.find(function (d) {\n\t          return !sorted.has(d);\n\t        })) {\n\t          s.push(mSource);\n\t        }\n\t      }\n\t    }\n\t  }\n\t\n\t  edges.forEach(function (value) {\n\t    if (value.size > 0) {\n\t      throw new Error('Graph cycle; unable to sort');\n\t    }\n\t  });\n\t\n\t  return sorted;\n\t};\n\n/***/ },\n/* 6 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Tag = __webpack_require__(2);\n\t\n\tvar _Tag2 = _interopRequireDefault(_Tag);\n\t\n\tvar _NullableType = __webpack_require__(7);\n\t\n\tvar _NullableType2 = _interopRequireDefault(_NullableType);\n\t\n\tvar _NullScalarType = __webpack_require__(8);\n\t\n\tvar _NullScalarType2 = _interopRequireDefault(_NullScalarType);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar BranchType = function () {\n\t  function BranchType(types) {\n\t    _classCallCheck(this, BranchType);\n\t\n\t    if (types.size < 2) {\n\t      throw new Error('degenerate branch type');\n\t    }\n\t\n\t    this._types = types;\n\t    this._node = null;\n\t  }\n\t\n\t  _createClass(BranchType, [{\n\t    key: 'clone',\n\t    value: function clone() {\n\t      var types = new Map();\n\t      this._types.forEach(function (type, key) {\n\t        return types.set(key, type.clone());\n\t      });\n\t      return new this.constructor(types);\n\t    }\n\t  }, {\n\t    key: 'build',\n\t    value: function build() {\n\t      this._node = (0, _Tag2.default)('div', { _squalusType: this }, (0, _Tag2.default)('select', { class: 'test-option' }, Array.from(this._types.keys(), function (key) {\n\t        return (0, _Tag2.default)('option', key);\n\t      })), Array.from(this._types.values(), function (value) {\n\t        return (0, _Tag2.default)('div', { class: 'test-option' }, value.build());\n\t      }));\n\t      return this._node;\n\t    }\n\t  }, {\n\t    key: 'value',\n\t    value: function value() {\n\t      return Array.from(this._types.values())[this._node.firstElementChild.selectedIndex].value();\n\t    }\n\t  }, {\n\t    key: 'populate',\n\t    value: function populate(data) {\n\t      // validate data to determine branch\n\t      var types = Array.from(this._types.values());\n\t      var i = types.findIndex(function (type) {\n\t        return type.validate(data, '', true);\n\t      });\n\t\n\t      if (i === -1) {\n\t        throw new Error('branch validation failed');\n\t      }\n\t\n\t      var select = this._node.firstElementChild;\n\t      select.selectedIndex = i;\n\t\n\t      var event = new Event('change', { bubbles: true });\n\t      select.dispatchEvent(event);\n\t\n\t      types[i].populate(data);\n\t    }\n\t  }, {\n\t    key: 'validate',\n\t    value: function validate(value, path, silent, context) {\n\t      if (!Array.from(this._types.values()).some(function (type) {\n\t        return type.validate(value, path, true, context);\n\t      })) {\n\t        if (silent) {\n\t          return false;\n\t        }\n\t        throw new Error(path + ' does not match any candidate');\n\t      }\n\t      return true;\n\t    }\n\t  }, {\n\t    key: 'clear',\n\t    value: function clear() {\n\t      this._types.forEach(function (type) {\n\t        return type.clear();\n\t      });\n\t    }\n\t  }, {\n\t    key: 'toJSON',\n\t    value: function toJSON() {\n\t      return {\n\t        _: 'branch',\n\t        types: this._types\n\t      };\n\t    }\n\t  }, {\n\t    key: 'types',\n\t    get: function get() {\n\t      return this._types;\n\t    }\n\t  }], [{\n\t    key: 'onChange',\n\t    value: function onChange(event) {\n\t      var node = event.target;\n\t      var i = 0;\n\t      while (node.nextElementSibling) {\n\t        node = node.nextElementSibling;\n\t        node.classList.toggle('test-hidden', i++ !== event.target.selectedIndex);\n\t      }\n\t    }\n\t  }, {\n\t    key: 'initializeSelectionStates',\n\t    value: function initializeSelectionStates(root) {\n\t      Array.from(root.querySelectorAll('select')).forEach(function (elem) {\n\t        var event = new Event('change', { bubbles: true });\n\t        elem.dispatchEvent(event);\n\t      });\n\t    }\n\t  }, {\n\t    key: 'create',\n\t    value: function create(types) {\n\t      if (types.size === 2) {\n\t        var nonNullTypes = Array.from(types.values()).filter(function (t) {\n\t          return !(t instanceof _NullScalarType2.default);\n\t        });\n\t        if (nonNullTypes.length === 1) {\n\t          return new _NullableType2.default(nonNullTypes[0]);\n\t        }\n\t      }\n\t      return new BranchType(types);\n\t    }\n\t  }]);\n\t\n\t  return BranchType;\n\t}();\n\t\n\texports.default = BranchType;\n\n/***/ },\n/* 7 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar NullableType = function () {\n\t  function NullableType(type) {\n\t    _classCallCheck(this, NullableType);\n\t\n\t    this._type = type;\n\t  }\n\t\n\t  _createClass(NullableType, [{\n\t    key: 'name',\n\t    value: function name() {\n\t      return this._type.name();\n\t    }\n\t  }, {\n\t    key: 'build',\n\t    value: function build() {\n\t      return this._type.build();\n\t    }\n\t  }, {\n\t    key: 'clone',\n\t    value: function clone() {\n\t      return new this.constructor(this._type.clone());\n\t    }\n\t  }, {\n\t    key: 'value',\n\t    value: function value() {\n\t      var val = this._type.value();\n\t      if (val === '') {\n\t        val = null;\n\t      }\n\t      return val;\n\t    }\n\t  }, {\n\t    key: 'validate',\n\t    value: function validate(value, path, silent, context) {\n\t      return value === null || this._type.validate(value, path, silent, context);\n\t    }\n\t  }, {\n\t    key: 'populate',\n\t    value: function populate(data, path, types) {\n\t      this._type.populate(data, path, types);\n\t    }\n\t  }, {\n\t    key: 'clear',\n\t    value: function clear() {\n\t      this._type.clear();\n\t    }\n\t  }, {\n\t    key: 'toJSON',\n\t    value: function toJSON() {\n\t      return {\n\t        _: 'nullable',\n\t        type: this._type\n\t      };\n\t    }\n\t  }]);\n\t\n\t  return NullableType;\n\t}();\n\t\n\texports.default = NullableType;\n\n/***/ },\n/* 8 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _ScalarType2 = __webpack_require__(9);\n\t\n\tvar _ScalarType3 = _interopRequireDefault(_ScalarType2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar NullScalarType = function (_ScalarType) {\n\t  _inherits(NullScalarType, _ScalarType);\n\t\n\t  function NullScalarType() {\n\t    _classCallCheck(this, NullScalarType);\n\t\n\t    return _possibleConstructorReturn(this, Object.getPrototypeOf(NullScalarType).apply(this, arguments));\n\t  }\n\t\n\t  _createClass(NullScalarType, [{\n\t    key: 'supportsValues',\n\t    value: function supportsValues() {\n\t      return false;\n\t    }\n\t  }, {\n\t    key: '_build',\n\t    value: function _build() {\n\t      return document.createTextNode('');\n\t    }\n\t  }, {\n\t    key: '_validate',\n\t    value: function _validate(value) {\n\t      return value === null;\n\t    }\n\t  }, {\n\t    key: 'value',\n\t    value: function value() {\n\t      return null;\n\t    }\n\t  }]);\n\t\n\t  return NullScalarType;\n\t}(_ScalarType3.default);\n\t\n\texports.default = NullScalarType;\n\n/***/ },\n/* 9 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Tag = __webpack_require__(2);\n\t\n\tvar _Tag2 = _interopRequireDefault(_Tag);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar implementations = new Map();\n\t['null', 'int', 'uint', 'float', 'string', 'bool', 'date', 'datetime', 'timestamp', 'guid'].forEach(function (type) {\n\t  return implementations.set(type, null);\n\t});\n\t\n\tvar ScalarType = function () {\n\t  function ScalarType(type, values) {\n\t    _classCallCheck(this, ScalarType);\n\t\n\t    this._type = type;\n\t    this._values = this._parse(values);\n\t    this._node = null;\n\t  }\n\t\n\t  _createClass(ScalarType, [{\n\t    key: 'clone',\n\t    value: function clone() {\n\t      return new this.constructor(this._type, this._values);\n\t    }\n\t  }, {\n\t    key: 'supportsValues',\n\t    value: function supportsValues() {\n\t      return true;\n\t    }\n\t  }, {\n\t    key: '_parse',\n\t    value: function _parse(values) {\n\t      return values;\n\t    }\n\t  }, {\n\t    key: '_build',\n\t    value: function _build() {\n\t      if (this._values) {\n\t        if (this._values.length === 1) {\n\t          return (0, _Tag2.default)('input', { type: 'text', disabled: true, value: this._values[0] });\n\t        }\n\t        return (0, _Tag2.default)('select', this._values.map(function (v) {\n\t          return (0, _Tag2.default)('option', v);\n\t        }));\n\t      }\n\t      return (0, _Tag2.default)('input', { type: 'text', placeholder: this._type });\n\t    }\n\t  }, {\n\t    key: 'build',\n\t    value: function build() {\n\t      this._node = this._build();\n\t      this._node._squalusType = this;\n\t      return this._node;\n\t    }\n\t  }, {\n\t    key: 'value',\n\t    value: function value() {\n\t      return this._node.value;\n\t    }\n\t  }, {\n\t    key: 'populate',\n\t    value: function populate(data) {\n\t      this._node.value = data;\n\t    }\n\t  }, {\n\t    key: '_validate',\n\t    value: function _validate(value) {\n\t      return typeof value === 'string';\n\t    }\n\t  }, {\n\t    key: 'validate',\n\t    value: function validate(value, path, silent) {\n\t      if (!this._validate(value, path, silent)) {\n\t        if (silent) {\n\t          return false;\n\t        }\n\t        throw new Error(path + ' must be of type ' + this._type);\n\t      }\n\t\n\t      if (this._values && !this._values.includes(value)) {\n\t        if (silent) {\n\t          return false;\n\t        }\n\t        throw new Error(path + ': \\'' + value + '\\' must be in [' + this._values.join(', ') + ']');\n\t      }\n\t\n\t      return true;\n\t    }\n\t  }, {\n\t    key: 'clear',\n\t    value: function clear() {\n\t      if (this._values) {\n\t        if (this._node.selectedIndex !== undefined) {\n\t          this._node.selectedIndex = 0;\n\t        }\n\t      } else {\n\t        this._node.value = '';\n\t      }\n\t    }\n\t  }, {\n\t    key: 'toJSON',\n\t    value: function toJSON() {\n\t      return {\n\t        _: 'scalar',\n\t        type: this._type\n\t      };\n\t    }\n\t  }, {\n\t    key: 'name',\n\t    get: function get() {\n\t      return this._type;\n\t    }\n\t  }], [{\n\t    key: 'register',\n\t    value: function register(type, implementation) {\n\t      if (Array.isArray(type)) {\n\t        type.forEach(function (t) {\n\t          return implementations.set(t, implementation);\n\t        });\n\t      } else {\n\t        implementations.set(type, implementation);\n\t      }\n\t    }\n\t  }, {\n\t    key: 'create',\n\t    value: function create(type, values) {\n\t      return new (implementations.get(type) || ScalarType)(type, values);\n\t    }\n\t  }, {\n\t    key: 'getScalarTypes',\n\t    value: function getScalarTypes() {\n\t      return Array.from(implementations.keys());\n\t    }\n\t  }]);\n\t\n\t  return ScalarType;\n\t}();\n\t\n\texports.default = ScalarType;\n\n/***/ },\n/* 10 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Tag = __webpack_require__(2);\n\t\n\tvar _Tag2 = _interopRequireDefault(_Tag);\n\t\n\tvar _BranchType = __webpack_require__(6);\n\t\n\tvar _BranchType2 = _interopRequireDefault(_BranchType);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar ArrayType = function () {\n\t  function ArrayType(type) {\n\t    _classCallCheck(this, ArrayType);\n\t\n\t    this._type = type;\n\t    this._rows = [];\n\t    this._node = null;\n\t    this._body = null;\n\t  }\n\t\n\t  _createClass(ArrayType, [{\n\t    key: 'name',\n\t    value: function name() {\n\t      return this._type.name() + '[]';\n\t    }\n\t  }, {\n\t    key: 'clone',\n\t    value: function clone() {\n\t      return new this.constructor(this._type.clone());\n\t    }\n\t  }, {\n\t    key: 'build',\n\t    value: function build() {\n\t      this._node = (0, _Tag2.default)('div', { _squalusType: this }, (0, _Tag2.default)('table', this._body = (0, _Tag2.default)('tbody'), (0, _Tag2.default)('tfoot', (0, _Tag2.default)('th', (0, _Tag2.default)('input', { type: 'button', class: 'test-row-add', value: '+' })), (0, _Tag2.default)('th'), (0, _Tag2.default)('td'))));\n\t      return this._node;\n\t    }\n\t  }, {\n\t    key: 'populate',\n\t    value: function populate(data, path, types) {\n\t      for (var i = 0; i < data.length; i++) {\n\t        var row = this.add();\n\t        row.populate(data[i], path + '[' + i + ']', types);\n\t      }\n\t    }\n\t  }, {\n\t    key: 'validate',\n\t    value: function validate(value, path, silent, context) {\n\t      var _this = this;\n\t\n\t      if (!Array.isArray(value)) {\n\t        if (silent) {\n\t          return false;\n\t        }\n\t        throw new Error(path + ' must be an array');\n\t      }\n\t\n\t      return value.every(function (item, i) {\n\t        return _this._type.validate(item, path + '[' + i + ']', silent, context);\n\t      });\n\t    }\n\t  }, {\n\t    key: 'value',\n\t    value: function value() {\n\t      return this._rows.map(function (val) {\n\t        return val.value();\n\t      });\n\t    }\n\t  }, {\n\t    key: 'clear',\n\t    value: function clear() {\n\t      this._rows = [];\n\t      this._body.innerHTML = '';\n\t    }\n\t  }, {\n\t    key: 'add',\n\t    value: function add() {\n\t      var clone = this._type.clone();\n\t      this._rows.push(clone);\n\t      this._body.appendChild((0, _Tag2.default)('tr', (0, _Tag2.default)('th', (0, _Tag2.default)('input', { type: 'button', class: 'test-row-remove', value: '-' })), (0, _Tag2.default)('th', '[' + this._body.children.length + ']'), (0, _Tag2.default)('td', clone.build())));\n\t      _BranchType2.default.initializeSelectionStates(this._body.lastElementChild);\n\t      return clone;\n\t    }\n\t  }, {\n\t    key: 'remove',\n\t    value: function remove(i) {\n\t      this._rows.splice(i, 1);\n\t      this._body.children[i].remove();\n\t\n\t      for (var j = i; j < this._body.children.length; j++) {\n\t        this._body.children[j].children[1].textContent = '[' + j + ']';\n\t      }\n\t    }\n\t  }, {\n\t    key: 'toJSON',\n\t    value: function toJSON() {\n\t      return {\n\t        _: 'array',\n\t        type: this._type\n\t      };\n\t    }\n\t  }], [{\n\t    key: 'onClickAdd',\n\t    value: function onClickAdd(event) {\n\t      event.target.parentNode.parentNode.parentNode.parentNode._squalusType.add();\n\t    }\n\t  }, {\n\t    key: 'onClickRemove',\n\t    value: function onClickRemove(event) {\n\t      var row = event.target.parentNode.parentNode;\n\t      var i = Array.prototype.indexOf.call(row.parentNode.children, row);\n\t      row.parentNode.parentNode.parentNode._squalusType.remove(i);\n\t    }\n\t  }]);\n\t\n\t  return ArrayType;\n\t}();\n\t\n\texports.default = ArrayType;\n\n/***/ },\n/* 11 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Tag = __webpack_require__(2);\n\t\n\tvar _Tag2 = _interopRequireDefault(_Tag);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar AttributeType = function () {\n\t  function AttributeType(name, type, required) {\n\t    _classCallCheck(this, AttributeType);\n\t\n\t    this._name = name;\n\t    this._type = type;\n\t    this._required = required;\n\t    this._included = false;\n\t\n\t    if (this._name.endsWith('?')) {\n\t      console.log(this);\n\t    }\n\t  }\n\t\n\t  _createClass(AttributeType, [{\n\t    key: 'name',\n\t    value: function name() {\n\t      return this._name;\n\t    }\n\t  }, {\n\t    key: 'type',\n\t    value: function type() {\n\t      return this._type;\n\t    }\n\t  }, {\n\t    key: 'required',\n\t    value: function required() {\n\t      return this._required;\n\t    }\n\t  }, {\n\t    key: 'included',\n\t    value: function included() {\n\t      return this._included;\n\t    }\n\t  }, {\n\t    key: 'clone',\n\t    value: function clone() {\n\t      return new this.constructor(this._name, this._type.clone(), this._required);\n\t    }\n\t  }, {\n\t    key: 'build',\n\t    value: function build() {\n\t      this._node = (0, _Tag2.default)('tr', { _squalusType: this }, (0, _Tag2.default)('th'), (0, _Tag2.default)('th', this._name), (0, _Tag2.default)('td', this._type.build()));\n\t      if (!this._required) {\n\t        this._node.firstElementChild.appendChild((0, _Tag2.default)('input', { type: 'button', class: 'test-attr-toggle', value: '' }));\n\t      }\n\t      this.update();\n\t      return this._node;\n\t    }\n\t  }, {\n\t    key: 'value',\n\t    value: function value() {\n\t      return this._type.value();\n\t    }\n\t  }, {\n\t    key: 'populate',\n\t    value: function populate(data, path, types) {\n\t      this._type.populate(data, path + '.' + this._name, types);\n\t      this._included = true;\n\t      this.update();\n\t    }\n\t  }, {\n\t    key: 'validate',\n\t    value: function validate(value, path, silent, context) {\n\t      return this._type.validate(value, path, silent, context);\n\t    }\n\t  }, {\n\t    key: 'clear',\n\t    value: function clear() {\n\t      this._type.clear();\n\t      this._included = false;\n\t      this.update();\n\t    }\n\t  }, {\n\t    key: 'toggle',\n\t    value: function toggle() {\n\t      this._included = !this._included;\n\t      this.update();\n\t    }\n\t  }, {\n\t    key: 'update',\n\t    value: function update() {\n\t      if (!this._required) {\n\t        this._node.children[0].firstElementChild.classList.toggle('test-attr-included', this._included);\n\t        this._node.children[1].classList.toggle('test-attr-toggle', !this._included);\n\t        this._node.children[2].firstElementChild.classList.toggle('test-hidden', !this._included);\n\t      }\n\t    }\n\t  }, {\n\t    key: 'toJSON',\n\t    value: function toJSON() {\n\t      return {\n\t        _: 'attribute',\n\t        name: this._name,\n\t        type: this._type\n\t      };\n\t    }\n\t  }], [{\n\t    key: 'onClickToggle',\n\t    value: function onClickToggle(event) {\n\t      event.target.parentNode.parentNode._squalusType.toggle();\n\t    }\n\t  }]);\n\t\n\t  return AttributeType;\n\t}();\n\t\n\texports.default = AttributeType;\n\n/***/ },\n/* 12 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Tag = __webpack_require__(2);\n\t\n\tvar _Tag2 = _interopRequireDefault(_Tag);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar ObjectType = function () {\n\t  function ObjectType(attributes) {\n\t    _classCallCheck(this, ObjectType);\n\t\n\t    this._attributes = attributes;\n\t    this._node = null;\n\t  }\n\t\n\t  _createClass(ObjectType, [{\n\t    key: 'attributes',\n\t    value: function attributes() {\n\t      return this._attributes;\n\t    }\n\t  }, {\n\t    key: 'clone',\n\t    value: function clone() {\n\t      return new this.constructor(this._attributes.map(function (attr) {\n\t        return attr.clone();\n\t      }));\n\t    }\n\t  }, {\n\t    key: 'build',\n\t    value: function build() {\n\t      this._node = (0, _Tag2.default)('table', { _squalusType: this }, (0, _Tag2.default)('tbody', this._attributes.map(function (type) {\n\t        return type.build();\n\t      })));\n\t      return this._node;\n\t    }\n\t  }, {\n\t    key: 'value',\n\t    value: function value() {\n\t      var data = {};\n\t      this._attributes.forEach(function (attr) {\n\t        if (attr.required() || attr.included()) {\n\t          data[attr.name()] = attr.value();\n\t        }\n\t      });\n\t      return data;\n\t    }\n\t  }, {\n\t    key: 'populate',\n\t    value: function populate(data, path, types) {\n\t      this._attributes.forEach(function (attr) {\n\t        attr.populate(data[attr.name()], path, types);\n\t      });\n\t    }\n\t  }, {\n\t    key: 'validate',\n\t    value: function validate(value, path, silent, context) {\n\t      var _this = this;\n\t\n\t      // todo: filter/warn on unrecognized attributes\n\t\n\t      if ((typeof value === 'undefined' ? 'undefined' : _typeof(value)) !== 'object' || value === null) {\n\t        if (silent) {\n\t          return false;\n\t        }\n\t        throw new Error(path + ' must be an object');\n\t      }\n\t\n\t      for (var i = 0; i < this._attributes.length; i++) {\n\t        var attr = this._attributes[i];\n\t        var key = attr.name();\n\t\n\t        if (value[key] === undefined) {\n\t          if (attr.required()) {\n\t            if (silent) {\n\t              return false;\n\t            }\n\t            throw new Error(path + '.' + key + ' is required');\n\t          }\n\t        } else if (!attr.validate(value[key], path + '.' + key, silent, context)) {\n\t          return false;\n\t        }\n\t      }\n\t\n\t      if (context._throwUnknownObjectAttributes) {\n\t        (function () {\n\t          var allowedKeys = new Set(_this._attributes.map(function (a) {\n\t            return a.name();\n\t          }));\n\t          var diff = Object.keys(value).filter(function (x) {\n\t            return !allowedKeys.has(x);\n\t          });\n\t          if (diff.length > 0) {\n\t            throw new Error('Unknown attributes `' + diff.join(',') + '` not allowed in `' + path + '`');\n\t          }\n\t        })();\n\t      }\n\t\n\t      return true;\n\t    }\n\t  }, {\n\t    key: 'clear',\n\t    value: function clear() {\n\t      this._attributes.forEach(function (attr) {\n\t        return attr.clear();\n\t      });\n\t    }\n\t  }, {\n\t    key: 'toJSON',\n\t    value: function toJSON() {\n\t      return {\n\t        _: 'object',\n\t        attributes: this._attributes\n\t      };\n\t    }\n\t  }]);\n\t\n\t  return ObjectType;\n\t}();\n\t\n\texports.default = ObjectType;\n\n/***/ },\n/* 13 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Tag = __webpack_require__(2);\n\t\n\tvar _Tag2 = _interopRequireDefault(_Tag);\n\t\n\tvar _BranchType = __webpack_require__(6);\n\t\n\tvar _BranchType2 = _interopRequireDefault(_BranchType);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar MapType = function () {\n\t  function MapType(key, type, required) {\n\t    _classCallCheck(this, MapType);\n\t\n\t    this._type = type;\n\t    this._key = key;\n\t    this._required = required;\n\t    this._rows = [];\n\t    this._node = null;\n\t    this._body = null;\n\t  }\n\t\n\t  _createClass(MapType, [{\n\t    key: 'name',\n\t    value: function name() {\n\t      return this._type.name() + '{}';\n\t    }\n\t  }, {\n\t    key: 'clone',\n\t    value: function clone() {\n\t      return new this.constructor(this._key.clone(), this._type.clone(), this._required ? this._required.clone() : null);\n\t    }\n\t  }, {\n\t    key: 'build',\n\t    value: function build() {\n\t      var _this = this;\n\t\n\t      this._node = (0, _Tag2.default)('div', { _squalusType: this }, (0, _Tag2.default)('table', this._body = (0, _Tag2.default)('tbody'), (0, _Tag2.default)('tfoot', (0, _Tag2.default)('th', (0, _Tag2.default)('input', { type: 'button', class: 'test-row-add', value: '+' })), (0, _Tag2.default)('th'), (0, _Tag2.default)('td'))));\n\t      if (this._required) {\n\t        this._required.attributes().forEach(function (attr) {\n\t          _this.add(attr.type(), attr.name());\n\t        });\n\t      }\n\t      return this._node;\n\t    }\n\t  }, {\n\t    key: 'populate',\n\t    value: function populate(data, path, types) {\n\t      var _this2 = this;\n\t\n\t      Object.keys(data).forEach(function (key, i) {\n\t        var row = _this2.add();\n\t        _this2._body.children[i].firstElementChild.textContent = key;\n\t        row.populate(data[key], path + '[' + key + ']', types);\n\t      });\n\t    }\n\t  }, {\n\t    key: 'validate',\n\t    value: function validate(value, path, silent, context) {\n\t      if ((typeof value === 'undefined' ? 'undefined' : _typeof(value)) !== 'object' || value === null) {\n\t        if (silent) {\n\t          return false;\n\t        }\n\t        throw new Error(path + ' must be an object');\n\t      }\n\t\n\t      var keys = Object.keys(value);\n\t      for (var i = 0; i < keys.length; i++) {\n\t        var key = keys[i];\n\t\n\t        if (!this._key.validate(key, path + '[' + key + ']*', silent, context)) {\n\t          return false;\n\t        }\n\t\n\t        if (!this._type.validate(value[key], path + '[' + key + ']', silent, context)) {\n\t          return false;\n\t        }\n\t      }\n\t\n\t      if (this._required) {\n\t        if (!this._type.validate(value, path, silent, context)) {\n\t          return false;\n\t        }\n\t      }\n\t\n\t      return true;\n\t    }\n\t  }, {\n\t    key: 'value',\n\t    value: function value() {\n\t      var _this3 = this;\n\t\n\t      var obj = {};\n\t      this._rows.forEach(function (row, i) {\n\t        var key = _this3._body.children[i].children[1].firstElementChild.value;\n\t        obj[key] = row.value();\n\t      });\n\t      return obj;\n\t    }\n\t  }, {\n\t    key: 'clear',\n\t    value: function clear() {\n\t      this._rows = [];\n\t      this._body.innerHTML = '';\n\t    }\n\t  }, {\n\t    key: 'add',\n\t    value: function add(type, key) {\n\t      var clone = type || this._type.clone();\n\t      this._rows.push(clone);\n\t      var keyField = this._key ? this._key.build() : (0, _Tag2.default)('input', { type: 'text', placeholder: 'key' });\n\t      if (key) {\n\t        keyField.value = key;\n\t      }\n\t      this._body.appendChild((0, _Tag2.default)('tr', (0, _Tag2.default)('th', (0, _Tag2.default)('input', { type: 'button', class: 'test-row-remove', value: '-' })), (0, _Tag2.default)('th', keyField), (0, _Tag2.default)('td', clone.build())));\n\t      _BranchType2.default.initializeSelectionStates(this._body.lastElementChild);\n\t      return clone;\n\t    }\n\t  }, {\n\t    key: 'remove',\n\t    value: function remove(i) {\n\t      this._rows.splice(i, 1);\n\t      this._body.children[i].remove();\n\t    }\n\t  }, {\n\t    key: 'toJSON',\n\t    value: function toJSON() {\n\t      return {\n\t        _: 'map',\n\t        key: this._key,\n\t        type: this._type\n\t      };\n\t    }\n\t  }]);\n\t\n\t  return MapType;\n\t}();\n\t\n\texports.default = MapType;\n\n/***/ },\n/* 14 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _Tag = __webpack_require__(2);\n\t\n\tvar _Tag2 = _interopRequireDefault(_Tag);\n\t\n\tvar _ScalarType2 = __webpack_require__(9);\n\t\n\tvar _ScalarType3 = _interopRequireDefault(_ScalarType2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar BoolScalarType = function (_ScalarType) {\n\t  _inherits(BoolScalarType, _ScalarType);\n\t\n\t  function BoolScalarType() {\n\t    _classCallCheck(this, BoolScalarType);\n\t\n\t    return _possibleConstructorReturn(this, Object.getPrototypeOf(BoolScalarType).apply(this, arguments));\n\t  }\n\t\n\t  _createClass(BoolScalarType, [{\n\t    key: '_parse',\n\t    value: function _parse(values) {\n\t      return values ? values.map(function (v) {\n\t        return v === true || v === 'true';\n\t      }) : null;\n\t    }\n\t  }, {\n\t    key: '_build',\n\t    value: function _build() {\n\t      return (0, _Tag2.default)('input', { type: 'checkbox' });\n\t    }\n\t  }, {\n\t    key: '_validate',\n\t    value: function _validate(value) {\n\t      return typeof value === 'boolean';\n\t    }\n\t  }, {\n\t    key: 'value',\n\t    value: function value() {\n\t      return this._node.checked;\n\t    }\n\t  }, {\n\t    key: 'populate',\n\t    value: function populate(data) {\n\t      this._node.checked = data;\n\t    }\n\t  }, {\n\t    key: 'clear',\n\t    value: function clear() {\n\t      this._node.checked = false;\n\t    }\n\t  }]);\n\t\n\t  return BoolScalarType;\n\t}(_ScalarType3.default);\n\t\n\texports.default = BoolScalarType;\n\n/***/ },\n/* 15 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _ScalarType2 = __webpack_require__(9);\n\t\n\tvar _ScalarType3 = _interopRequireDefault(_ScalarType2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar FloatScalarType = function (_ScalarType) {\n\t  _inherits(FloatScalarType, _ScalarType);\n\t\n\t  function FloatScalarType() {\n\t    _classCallCheck(this, FloatScalarType);\n\t\n\t    return _possibleConstructorReturn(this, Object.getPrototypeOf(FloatScalarType).apply(this, arguments));\n\t  }\n\t\n\t  _createClass(FloatScalarType, [{\n\t    key: '_parse',\n\t    value: function _parse(values) {\n\t      return values ? values.map(function (v) {\n\t        return parseFloat(v);\n\t      }) : null;\n\t    }\n\t  }, {\n\t    key: '_validate',\n\t    value: function _validate(value) {\n\t      return typeof value === 'number';\n\t    }\n\t  }, {\n\t    key: 'value',\n\t    value: function value() {\n\t      return parseFloat(this._node.value);\n\t    }\n\t  }]);\n\t\n\t  return FloatScalarType;\n\t}(_ScalarType3.default);\n\t\n\texports.default = FloatScalarType;\n\n/***/ },\n/* 16 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _ScalarType2 = __webpack_require__(9);\n\t\n\tvar _ScalarType3 = _interopRequireDefault(_ScalarType2);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\t\n\tfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\t\n\tvar IntScalarType = function (_ScalarType) {\n\t  _inherits(IntScalarType, _ScalarType);\n\t\n\t  function IntScalarType(type, values) {\n\t    _classCallCheck(this, IntScalarType);\n\t\n\t    var _this = _possibleConstructorReturn(this, Object.getPrototypeOf(IntScalarType).call(this, type, values));\n\t\n\t    _this._validator = null;\n\t    return _this;\n\t  }\n\t\n\t  _createClass(IntScalarType, [{\n\t    key: '_parse',\n\t    value: function _parse(values) {\n\t      if (!values) {\n\t        return null;\n\t      }\n\t\n\t      var parsed = values.reduce(function (previous, current) {\n\t        if (typeof current === 'number') {\n\t          if ((current | 0) !== current) {\n\t            throw new Error('not an int');\n\t          }\n\t          previous.push(current);\n\t        } else if (current.indexOf('-') !== -1) {\n\t          var parts = current.split('-');\n\t          var start = parseInt(parts[0], 10);\n\t          var end = parseInt(parts[1], 10);\n\t          previous.push([start, end]);\n\t        } else {\n\t          previous.push(parseInt(current, 10));\n\t        }\n\t        return previous;\n\t      }, []);\n\t\n\t      var ranges = parsed.filter(function (p) {\n\t        return Array.isArray(p);\n\t      });\n\t\n\t      if (!ranges.length) {\n\t        return parsed.sort(function (a, b) {\n\t          return a - b;\n\t        });\n\t      }\n\t\n\t      var fixed = parsed.filter(function (p) {\n\t        return !Array.isArray(p);\n\t      });\n\t\n\t      var rangeSize = ranges.reduce(function (previous, current) {\n\t        return previous + (current[1] - current[0]);\n\t      }, 0);\n\t\n\t      // if the ranges are small enough, just enumerate them\n\t      if (rangeSize + fixed.length <= 100) {\n\t        ranges.forEach(function (r) {\n\t          for (var i = r[0]; i <= r[1]; i++) {\n\t            fixed.push(i);\n\t          }\n\t        });\n\t        return fixed.sort(function (a, b) {\n\t          return a - b;\n\t        });\n\t      }\n\t\n\t      this._validator = function (value) {\n\t        return fixed.includes(value) || ranges.some(function (r) {\n\t          return r[0] <= value && value >= r[1];\n\t        });\n\t      };\n\t\n\t      return null;\n\t    }\n\t  }, {\n\t    key: '_validate',\n\t    value: function _validate(value) {\n\t      return typeof value === 'number' && (value | 0) === value;\n\t    }\n\t  }, {\n\t    key: 'value',\n\t    value: function value() {\n\t      return parseInt(this._node.value, 10);\n\t    }\n\t  }]);\n\t\n\t  return IntScalarType;\n\t}(_ScalarType3.default);\n\t\n\texports.default = IntScalarType;\n\n/***/ },\n/* 17 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"^colors$\" }] */\n\t\n\t// colors is imported for the side effects\n\t\n\t\n\tvar _colors = __webpack_require__(18);\n\t\n\tvar _colors2 = _interopRequireDefault(_colors);\n\t\n\tvar _TopoSort = __webpack_require__(5);\n\t\n\tvar _TopoSort2 = _interopRequireDefault(_TopoSort);\n\t\n\tvar _TestError = __webpack_require__(19);\n\t\n\tvar _TestError2 = _interopRequireDefault(_TestError);\n\t\n\tvar _ValidationContext = __webpack_require__(20);\n\t\n\tvar _ValidationContext2 = _interopRequireDefault(_ValidationContext);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar TestCollection = function () {\n\t  function TestCollection(name, options) {\n\t    _classCallCheck(this, TestCollection);\n\t\n\t    this._name = name;\n\t    this._groups = null;\n\t    this._cancel = false;\n\t    this._sequential = !!(options || {}).sequential;\n\t    this._validationContext = new _ValidationContext2.default(!!(options || {}).throwUnknownObjectAttributes);\n\t  }\n\t\n\t  _createClass(TestCollection, [{\n\t    key: 'groups',\n\t    value: function groups(_groups) {\n\t      this._groups = _groups;\n\t      return this;\n\t    }\n\t  }, {\n\t    key: 'getMaxGroupNameLength',\n\t    value: function getMaxGroupNameLength() {\n\t      if (this._groups && !this._maxGroupNameLength) {\n\t        this._maxGroupNameLength = this._groups.reduce(function (a, b) {\n\t          return a._name.length > b._name.length ? a : b;\n\t        })._name.length;\n\t      }\n\t      return this._maxGroupNameLength;\n\t    }\n\t  }, {\n\t    key: 'execute',\n\t    value: function execute(initial) {\n\t      var _this = this;\n\t\n\t      var startTime = Date.now();\n\t\n\t      var root = Promise.resolve();\n\t      var context = new Map();\n\t      if (initial) {\n\t        Object.keys(initial).forEach(function (k) {\n\t          return context.set(k, initial[k]);\n\t        });\n\t      }\n\t\n\t      var testCount = this._groups.reduce(function (a, b) {\n\t        return a + b._tests.length;\n\t      }, 0);\n\t\n\t      var options = [];\n\t      if (this._sequential) {\n\t        options.push('sequential');\n\t      }\n\t      if (this._validationContext._throwUnknownObjectAttributes) {\n\t        options.push('throwUnknownObjectAttributes');\n\t      }\n\t\n\t      console.log();\n\t      console.log('  collection [%s] %s', this._name.green, options.length > 0 ? '(' + options.join(',') + ')' : '');\n\t      console.log();\n\t\n\t      this._groups = Array.from((0, _TopoSort2.default)(this._groups, function (g) {\n\t        return g._name;\n\t      }, function (g) {\n\t        return g._requires ? g._requires.map(function (r) {\n\t          return r._name;\n\t        }) : null;\n\t      }).values());\n\t\n\t      return Promise.all(this._groups.map(function (g, i, a) {\n\t        if (_this._sequential && i > 0) {\n\t          root = a[i - 1].execute();\n\t        }\n\t        return g.execute(context, _this, root);\n\t      })).then(function () {\n\t        console.log();\n\t        console.log('  %s after %s', (testCount + ' passing').green, (Date.now() - startTime + ' ms').magenta);\n\t        console.log();\n\t      }).catch(function (error) {\n\t        if (_this._cancel) {\n\t          return;\n\t        }\n\t\n\t        _this._cancel = true;\n\t\n\t        if (error instanceof _TestError2.default) {\n\t          error.log(context, startTime);\n\t        } else {\n\t          console.log(error);\n\t        }\n\t      });\n\t    }\n\t  }]);\n\t\n\t  return TestCollection;\n\t}();\n\t\n\texports.default = TestCollection;\n\n/***/ },\n/* 18 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"colors\");\n\n/***/ },\n/* 19 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar TestError = function () {\n\t  function TestError(test, group, collection, reason, response) {\n\t    _classCallCheck(this, TestError);\n\t\n\t    this._test = test;\n\t    this._group = group;\n\t    this._collection = collection;\n\t    this._reason = reason;\n\t    this._response = response;\n\t  }\n\t\n\t  _createClass(TestError, [{\n\t    key: 'log',\n\t    value: function log(context) {\n\t      var info = {\n\t        collection: this._collection._name,\n\t        group: this._group._name\n\t      };\n\t\n\t      if (this._test._name !== undefined && this._test._name !== null && this._test._name.length > 0) {\n\t        info.test = this._test._name;\n\t      } else {\n\t        info.test = '#' + this._group._tests.indexOf(this._test);\n\t      }\n\t\n\t      info['req-url'] = this._response.request.uri.href;\n\t      info['req-method'] = this._response.request.method.toUpperCase();\n\t\n\t      if (['post', 'put', 'patch'].includes(this._response.request.method)) {\n\t        info['req-body'] = this._response.request.body;\n\t      }\n\t\n\t      if (this._response.statusCode >= 200 && ![204, 205].includes(this._response.statusCode)) {\n\t        // the response MAY include an entity\n\t        var responseContentType = (this._response.headers['content-type'] || '').split(';')[0].toLowerCase().trim();\n\t        // technically, the content-type header is only a SHOULD, rather than a MUST for entity responses,\n\t        // but I don't care enough to sniff the response to determine the media response\n\t        if (responseContentType) {\n\t          var responseBody = this._response.body;\n\t          var responseNote = null;\n\t\n\t          if (responseContentType === 'text/html') {\n\t            if (this._response.statusCode === 500 && /<span><H1>Server Error in/i.test(responseBody)) {\n\t              responseNote = 'including only error trace from ASP.NET YSOD response';\n\t              responseBody = responseBody.replace(/^[\\s\\S]*<!--([\\s\\S]*)-->\\s*$/, '$1');\n\t            }\n\t          } else if (responseContentType === 'application/json') {\n\t            responseBody = JSON.stringify(JSON.parse(responseBody), null, 4);\n\t          }\n\t\n\t          if (this._test._type) {\n\t            info['res-squalus-type'] = this._test._type;\n\t          }\n\t\n\t          info['res-content-type'] = responseContentType;\n\t          info['res-body'] = (responseNote ? '(' + responseNote + ')' : '') + '\\n' + responseBody;\n\t        }\n\t      }\n\t\n\t      info.context = JSON.stringify(Array.from(context.keys()).reduce(function (a, b) {\n\t        return Object.assign(a, _defineProperty({}, '' + b, context.get(b)));\n\t      }, {}), null, 4);\n\t\n\t      if (this._reason instanceof Error) {\n\t        info.error = this._reason.stack;\n\t      } else {\n\t        info.reason = this._reason;\n\t      }\n\t\n\t      var maxInfoNameLength = Object.keys(info).reduce(function (a, b) {\n\t        return Math.max(a, b.length);\n\t      }, 0);\n\t\n\t      console.log();\n\t      console.log('  failed'.red);\n\t      console.log();\n\t      Object.keys(info).forEach(function (k) {\n\t        return console.log('    %s%s : %s', k.yellow, info[k].indexOf('\\n') === -1 ? ' '.repeat(maxInfoNameLength - k.length) : '', info[k].replace(/\\n/g, '\\n' + ' '.repeat(4 + 4)));\n\t      });\n\t      console.log();\n\t    }\n\t  }]);\n\t\n\t  return TestError;\n\t}();\n\t\n\texports.default = TestError;\n\n/***/ },\n/* 20 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar ValidationContext = function ValidationContext(throwUnknownObjectAttributes) {\n\t  _classCallCheck(this, ValidationContext);\n\t\n\t  this._throwUnknownObjectAttributes = !!throwUnknownObjectAttributes;\n\t};\n\t\n\texports.default = ValidationContext;\n\n/***/ },\n/* 21 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar TestGroup = function () {\n\t  function TestGroup(name) {\n\t    _classCallCheck(this, TestGroup);\n\t\n\t    this._name = name;\n\t    this._requires = null;\n\t    this._parallel = false;\n\t    this._session = null;\n\t    this._tests = null;\n\t    this._promise = null;\n\t  }\n\t\n\t  _createClass(TestGroup, [{\n\t    key: 'requires',\n\t    value: function requires(groups) {\n\t      this._requires = Array.isArray(groups) ? groups : [groups];\n\t      return this;\n\t    }\n\t  }, {\n\t    key: 'parallel',\n\t    value: function parallel() {\n\t      this._parallel = true;\n\t      return this;\n\t    }\n\t  }, {\n\t    key: 'session',\n\t    value: function session(name) {\n\t      this._session = name;\n\t      return this;\n\t    }\n\t  }, {\n\t    key: 'tests',\n\t    value: function tests(_tests) {\n\t      this._tests = _tests;\n\t      return this;\n\t    }\n\t  }, {\n\t    key: 'execute',\n\t    value: function execute(context, collection, root) {\n\t      var _this = this;\n\t\n\t      if (!this._promise) {\n\t        (function () {\n\t          if (!collection || !root) {\n\t            throw new Error('uninitialized promise');\n\t          }\n\t\n\t          var when = root;\n\t          if (_this._requires) {\n\t            when = Promise.all(_this._requires.map(function (g) {\n\t              return g.execute(root, context);\n\t            }).concat([root]));\n\t          }\n\t          _this._promise = new Promise(function (resolve, reject) {\n\t            if (_this._parallel && !collection._sequential) {\n\t              when.then(function () {\n\t                Promise.all(_this._tests.map(function (t) {\n\t                  return t.execute(context, _this, collection);\n\t                })).then(resolve, reject);\n\t              });\n\t            } else {\n\t              (function () {\n\t                var tests = _this._tests.slice().reverse();\n\t\n\t                var onResolve = function onResolve() {\n\t                  if (tests.length) {\n\t                    tests.pop().execute(context, _this, collection).then(onResolve, reject);\n\t                  } else {\n\t                    resolve();\n\t                  }\n\t                };\n\t\n\t                when.then(onResolve, reject);\n\t              })();\n\t            }\n\t          });\n\t        })();\n\t      }\n\t      return this._promise;\n\t    }\n\t  }]);\n\t\n\t  return TestGroup;\n\t}();\n\t\n\texports.default = TestGroup;\n\n/***/ },\n/* 22 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"^colors$\" }] */\n\t\n\tvar _Squalus = __webpack_require__(1);\n\t\n\tvar _Squalus2 = _interopRequireDefault(_Squalus);\n\t\n\tvar _requestPromise = __webpack_require__(23);\n\t\n\tvar _requestPromise2 = _interopRequireDefault(_requestPromise);\n\t\n\tvar _colors = __webpack_require__(18);\n\t\n\tvar _colors2 = _interopRequireDefault(_colors);\n\t\n\tvar _TestError = __webpack_require__(19);\n\t\n\tvar _TestError2 = _interopRequireDefault(_TestError);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tfunction padRight(str, width) {\n\t  var char = arguments.length <= 2 || arguments[2] === undefined ? ' ' : arguments[2];\n\t\n\t  if (str.length < width) {\n\t    return str + char.repeat(width - str.length);\n\t  }\n\t  return str;\n\t}\n\t\n\tvar STRIP_COMMENTS = /((\\/\\/.*$)|(\\/\\*[\\s\\S]*?\\*\\/))/mg;\n\tvar ARGUMENT_NAMES = /([^\\s,]+)/g;\n\tfunction getParamNames(func) {\n\t  var fnStr = func.toString().replace(STRIP_COMMENTS, '');\n\t  var result = fnStr.slice(fnStr.indexOf('(') + 1, fnStr.indexOf(')')).match(ARGUMENT_NAMES);\n\t  if (result === null) {\n\t    result = [];\n\t  }\n\t  return result;\n\t}\n\t\n\tfunction callFuncWithParamInjection(func, response, body, context) {\n\t  var sourceParams = new Map();\n\t  sourceParams.set('response', response);\n\t  sourceParams.set('body', body);\n\t  sourceParams.set('context', context);\n\t  var maps = [sourceParams];\n\t  Array.from(sourceParams.values()).filter(function (p) {\n\t    return p instanceof Map;\n\t  }).forEach(function (map) {\n\t    return maps.push(map);\n\t  });\n\t\n\t  return func.apply(null, getParamNames(func).map(function (name) {\n\t    var map = maps.find(function (m) {\n\t      return m.has(name);\n\t    });\n\t    if (map) {\n\t      return map.get(name);\n\t    }\n\t    return undefined;\n\t  }));\n\t}\n\t\n\tvar Test = function () {\n\t  function Test(name) {\n\t    _classCallCheck(this, Test);\n\t\n\t    this._name = name;\n\t    this._method = null;\n\t    this._url = null;\n\t    this._contentType = null;\n\t    this._responseContentType = null;\n\t    this._body = null;\n\t    this._status = null;\n\t    this._type = null;\n\t    this._save = null;\n\t    this._expect = null;\n\t    this._promise = null;\n\t  }\n\t\n\t  _createClass(Test, [{\n\t    key: 'execute',\n\t    value: function execute(context, group, collection) {\n\t      var _this = this;\n\t\n\t      if (!this._promise) {\n\t        (function () {\n\t          var url = _this._url;\n\t          if (typeof url === 'function') {\n\t            url = url(context);\n\t          }\n\t\n\t          var populateVariables = function populateVariables(m, name) {\n\t            return context.has(name) ? context.get(name) : m;\n\t          };\n\t\n\t          url = url.replace(/[@:]([a-z0-9_]+)/gi, populateVariables);\n\t          url = url.replace(/{([a-z0-9_]+)}/gi, populateVariables);\n\t\n\t          var absUrl = context.get('baseUrl') + url;\n\t\n\t          var body = _this._body;\n\t          if (typeof body === 'function') {\n\t            body = body(context);\n\t          }\n\t\n\t          var reject = function reject(reason, response) {\n\t            return Promise.reject(new _TestError2.default(_this, group, collection, reason, response));\n\t          };\n\t\n\t          var status = function status(response) {\n\t            if (!_this._status || typeof _this._status !== 'number') {\n\t              return reject('invalid response status', response);\n\t            }\n\t            if (response.statusCode !== _this._status) {\n\t              return reject('response status ' + response.statusCode + ' does not match expected ' + _this._status, response);\n\t            }\n\t            if (_this._responseContentType) {\n\t              var contentType = (response.headers['content-type'] || '').split(';', 2)[0];\n\t              if (contentType !== _this._responseContentType) {\n\t                return reject('response content type ' + contentType + ' does not match expected ' + _this._responseContentType, response);\n\t              }\n\t            }\n\t            return Promise.resolve(response);\n\t          };\n\t\n\t          var type = function type(response) {\n\t            if (_this._type) {\n\t              var responseType = _Squalus2.default.getType(_this._type);\n\t              if (!responseType) {\n\t                return reject('failed to create response type ' + _this._type, response);\n\t              }\n\t              try {\n\t                var json = JSON.parse(response.body);\n\t                response.bodyJson = json; // eslint-disable-line no-param-reassign\n\t                responseType.validate(json, 'body', false, collection._validationContext);\n\t              } catch (e) {\n\t                return reject(e, response);\n\t              }\n\t              return Promise.resolve(response);\n\t            }\n\t            return Promise.resolve(response);\n\t          };\n\t\n\t          var expect = function expect(response) {\n\t            if (_this._expect) {\n\t              return Promise.all(_this._expect.map(function (func, i) {\n\t                return Promise.resolve(callFuncWithParamInjection(func, response, response.bodyJson !== undefined ? response.bodyJson : response.body, context)).then(function (passed) {\n\t                  if (!passed) {\n\t                    return reject('expect test \\'' + i + '\\' failed', response);\n\t                  }\n\t                  return Promise.resolve(response);\n\t                });\n\t              })).then(function () {\n\t                return Promise.resolve(response);\n\t              });\n\t            }\n\t            return Promise.resolve(response);\n\t          };\n\t\n\t          var save = function save(response) {\n\t            if (_this._save) {\n\t              return Promise.all(Array.from(_this._save.keys()).map(function (key) {\n\t                return Promise.resolve(callFuncWithParamInjection(_this._save.get(key), response, response.bodyJson !== undefined ? response.bodyJson : response.body, context)).then(function (v) {\n\t                  if (context.has(key)) {\n\t                    throw new Error('The context already contains key \\'' + key + '\\'');\n\t                  }\n\t                  context.set(key, v);\n\t                  // console.log(`  [${key}] = ${v}`);\n\t                });\n\t              })).then(function () {\n\t                return Promise.resolve(response);\n\t              });\n\t            }\n\t            return Promise.resolve(response);\n\t          };\n\t\n\t          var options = {\n\t            uri: absUrl,\n\t            method: _this._method,\n\t            headers: {\n\t              'Content-Type': _this._contentType || 'application/json',\n\t              Cookie: context.get(group._session)\n\t            },\n\t            resolveWithFullResponse: true,\n\t            simple: false\n\t          };\n\t\n\t          if (_this._contentType === 'application/x-www-form-urlencoded') {\n\t            options.form = body;\n\t          } else if (_this._contentType === 'multipart/form-data') {\n\t            options.formData = body;\n\t          } else {\n\t            options.body = body;\n\t          }\n\t\n\t          _this._promise = (0, _requestPromise2.default)(options).then(function (res) {\n\t            return status(res);\n\t          }).then(function (res) {\n\t            return type(res);\n\t          }).then(function (res) {\n\t            return expect(res);\n\t          }).then(function (res) {\n\t            return save(res);\n\t          }).then(function () {\n\t            if (collection._cancel) {\n\t              return Promise.reject();\n\t            }\n\t            console.log('    %s %s %s %s', padRight(group._name, collection.getMaxGroupNameLength()).gray, padRight(_this._method.toUpperCase(), 6).magenta, url, _this._name.cyan);\n\t            return Promise.resolve();\n\t          });\n\t        })();\n\t      }\n\t      return this._promise;\n\t    }\n\t  }, {\n\t    key: 'get',\n\t    value: function get(url) {\n\t      this._method = 'get';\n\t      this._url = url;\n\t      this._status = this._status || 200;\n\t      return this;\n\t    }\n\t  }, {\n\t    key: 'post',\n\t    value: function post(url) {\n\t      this._method = 'post';\n\t      this._url = url;\n\t      this._status = this._status || 200;\n\t      return this;\n\t    }\n\t  }, {\n\t    key: 'put',\n\t    value: function put(url) {\n\t      this._method = 'put';\n\t      this._url = url;\n\t      this._status = this._status || 204;\n\t      return this;\n\t    }\n\t  }, {\n\t    key: 'delete',\n\t    value: function _delete(url) {\n\t      this._method = 'delete';\n\t      this._url = url;\n\t      this._status = this._status || 204;\n\t      return this;\n\t    }\n\t  }, {\n\t    key: 'json',\n\t    value: function json(data) {\n\t      this._contentType = 'application/json';\n\t      if (typeof data === 'function') {\n\t        this._body = function (context) {\n\t          return JSON.stringify(data(context));\n\t        };\n\t      } else {\n\t        this._body = JSON.stringify(data);\n\t      }\n\t      return this;\n\t    }\n\t  }, {\n\t    key: 'form',\n\t    value: function form(data) {\n\t      this._contentType = 'application/x-www-form-urlencoded';\n\t      this._body = data;\n\t      return this;\n\t    }\n\t  }, {\n\t    key: 'formData',\n\t    value: function formData(data) {\n\t      this._contentType = 'multipart/form-data';\n\t      var form = new FormData();\n\t      Object.keys(data).forEach(function (key) {\n\t        return form.set(key, data[key]);\n\t      });\n\t      this._body = form;\n\t      return this;\n\t    }\n\t  }, {\n\t    key: 'save',\n\t    value: function save(name, func) {\n\t      if (!this._save) {\n\t        this._save = new Map();\n\t      }\n\t      this._save.set(name, func);\n\t      return this;\n\t    }\n\t  }, {\n\t    key: 'expect',\n\t    value: function expect(type) {\n\t      if (typeof type === 'function') {\n\t        if (!this._expect) {\n\t          this._expect = [];\n\t        }\n\t        this._expect.push(type);\n\t      } else if (typeof type === 'number') {\n\t        this._status = type;\n\t      } else if (type.indexOf('/') !== -1) {\n\t        this._responseContentType = type;\n\t      } else {\n\t        this._type = type;\n\t      }\n\t      return this;\n\t    }\n\t  }]);\n\t\n\t  return Test;\n\t}();\n\t\n\texports.default = Test;\n\n/***/ },\n/* 23 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"request-promise\");\n\n/***/ },\n/* 24 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"path\");\n\n/***/ },\n/* 25 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"fs\");\n\n/***/ },\n/* 26 */\n/***/ function(module, exports) {\n\n\tmodule.exports = require(\"js-yaml\");\n\n/***/ }\n/******/ ]);\n\n\n/** WEBPACK FOOTER **\n ** squalus-node.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"lib/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 9e0cd30608cc75c04f90\n **/","import Squalus from './Squalus';\r\nimport TestCollection from './Automation/TestCollection';\r\nimport TestGroup from './Automation/TestGroup';\r\nimport Test from './Automation/Test';\r\nimport path from 'path';\r\nimport fs from 'fs';\r\nimport yaml from 'js-yaml';\r\n\r\nfunction getFiles(source, regex) {\r\n  const files = [];\r\n\r\n  const findChildren = (dir) =>\r\n    fs.readdirSync(dir).forEach(f => {\r\n      const child = path.join(dir, f);\r\n      if (fs.statSync(child).isDirectory()) {\r\n        findChildren(child);\r\n      } else if (regex.test(f)) {\r\n        files.push(child);\r\n      }\r\n    });\r\n\r\n  if (fs.statSync(source).isDirectory()) {\r\n    findChildren(source);\r\n  } else {\r\n    files.push(source);\r\n  }\r\n\r\n  return files;\r\n}\r\n\r\nclass SqualusNode extends Squalus {\r\n\r\n  static execute(typePath, collectionInstance, initialContextPath) {\r\n    const files = getFiles(typePath, /\\.yaml$/);\r\n\r\n    if (files.length) {\r\n      const types = Object.assign.apply(null,\r\n        files.map(file => yaml.safeLoad(fs.readFileSync(file, { encoding: 'utf8' })))\r\n      );\r\n\r\n      Squalus.buildTypes(types);\r\n    }\r\n\r\n    let context = undefined;\r\n    if (initialContextPath) {\r\n      context = JSON.parse(fs.readFileSync(initialContextPath, { encoding: 'utf8' }));\r\n    }\r\n\r\n    return collectionInstance.execute(context);\r\n  }\r\n}\r\n\r\nfunction collection(name, options) {\r\n  return new TestCollection(name, options);\r\n}\r\n\r\nfunction group(name) {\r\n  return new TestGroup(name);\r\n}\r\n\r\nfunction test(name) {\r\n  return new Test(name);\r\n}\r\n\r\nexport { SqualusNode as squalus, collection, group, test };\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/SqualusNode.js\n **/","import { default as $ } from './Tag';\nimport Endpoint from './Endpoint';\nimport topoSort from './TopoSort';\n\nimport BranchType from './Type/BranchType';\nimport ArrayType from './Type/ArrayType';\nimport AttributeType from './Type/AttributeType';\nimport ObjectType from './Type/ObjectType';\nimport ScalarType from './Type/ScalarType';\nimport MapType from './Type/MapType';\n\nimport BoolScalarType from './Type/Scalar/BoolScalarType';\nimport FloatScalarType from './Type/Scalar/FloatScalarType';\nimport IntScalarType from './Type/Scalar/IntScalarType';\nimport NullScalarType from './Type/Scalar/NullScalarType';\n\nScalarType.register('null', NullScalarType);\nScalarType.register(['int', 'uint'], IntScalarType);\nScalarType.register('float', FloatScalarType);\nScalarType.register('bool', BoolScalarType);\n\nconst registeredTypes = new Map();\n\nfunction findPreviousTokenGroupStart(tokens, i) {\n  if (tokens[i] === ')') {\n    let depth = 0;\n    for (let j = i - 1; j >= 0; j--) {\n      if (tokens[j] === ')') {\n        ++depth;\n      } else if (tokens[j] === '(') {\n        if (depth === 0) {\n          return findPreviousTokenGroupStart(tokens, j - 1);\n        }\n        --depth;\n      }\n    }\n  } else if (tokens[i] === '}') {\n    for (let j = i - 1; j >= 0; j--) {\n      if (tokens[j] === '{') {\n        return findPreviousTokenGroupStart(tokens, j - 1);\n      }\n    }\n  } else if (tokens[i] === '[]') {\n    return findPreviousTokenGroupStart(tokens, i - 1);\n  }\n\n  return i >= 0 ? i : 0;\n}\n\nfunction parseTokensFromType(type, dependenciesOnly) {\n  /*\n   * e.g.\n   *   type\n   *   type:map(Name,Value)\n   *   type1|type2|type3\n   *   type1 => type2\n   *   int{1,2,7-9}?\n   *   string?[]?\n   *   (string => int{2,4-9}|bool|string?)?[]?\n   *   type1,type2 # this only applies to inheritance\n   * todo:\n   *   content-type(image/png) && signature(89 50 4E 47 0D 0A 1A 0A)\n   */\n  const tokens = type.split(/([|{}()?:,]|&&|\\[]|=>)/).map(t => t.trim()).filter(t => t !== '');\n\n  // expand shortcuts\n  for (let i = 0; i < tokens.length; i++) {\n    if (tokens[i] === '?') {\n      const previous = findPreviousTokenGroupStart(tokens, i - 1);\n      tokens.splice(previous, 0, '(');\n      tokens.splice(i + 1, 1, '|', 'null', ')');\n      --i;\n    }\n  }\n\n  if (!dependenciesOnly) {\n    return tokens;\n  }\n\n  /*\n   * remove\n   *   |\n   *   []\n   *   {...}\n   *   :func(...)\n   */\n  const dependencies = [];\n  for (let i = 0; i < tokens.length; i++) {\n    if (tokens[i] === '{') {\n      while (tokens[i] !== '}') {\n        ++i;\n      }\n      continue;\n    } else if (tokens[i] === ':') {\n      while (tokens[i] !== ')') {\n        ++i;\n      }\n      continue;\n    } else if (['[]', '=>', '|', ',', '(', ')'].includes(tokens[i])) {\n      continue;\n    }\n    dependencies.push(tokens[i]);\n  }\n\n  return dependencies;\n}\n\nfunction buildKnownDependencies() {\n  return ScalarType.getScalarTypes().map(t => ({\n    name: t,\n    data: t,\n  }));\n}\n\nfunction parseChild(types) {\n  const dependencies = new Set();\n\n  Object.keys(types).forEach(key => {\n    const type = types[key];\n\n    if (typeof type === 'string') {\n      parseTokensFromType(type, true).forEach(t => dependencies.add(t));\n    } else {\n      parseChild(type).forEach(t => dependencies.add(t));\n    }\n  });\n\n  return dependencies;\n}\n\nfunction scopify(iter, scope) {\n  let source = iter;\n  if (typeof iter === 'string') {\n    source = [iter];\n  }\n  const result = Array.from(source, item => ((\n    item.indexOf('{') === -1 && item.indexOf('[') === -1 && item.indexOf('|') === -1 &&\n    item.indexOf('.') === -1 && !ScalarType.getScalarTypes().includes(item))\n      ? `${scope}.${item}`\n      : item)\n  );\n\n  return (typeof iter === 'string') ? result[0] : result;\n}\n\nfunction parseRoot(root) {\n  const parsed = [];\n\n  Object.keys(root).forEach(scope => {\n    Object.keys(root[scope]).forEach(name => {\n      const type = root[scope][name];\n\n      const requires = new Set();\n\n      if (typeof type === 'string') {\n        parseTokensFromType(type, true).forEach(t => requires.add(t));\n      } else {\n        parseChild(type).forEach(t => requires.add(t));\n      }\n\n      parsed.push({\n        name: scopify(name, scope),\n        requires: scopify(requires, scope),\n        data: type,\n      });\n    });\n  });\n\n  return parsed;\n}\n\nfunction createAttrFromName(name, type) {\n  return new AttributeType(name.replace(/\\?$/, ''), type.clone(), !name.endsWith('?'));\n}\n\nfunction stripOuterParens(array) {\n  if (array[0] === '(' && array[array.length - 1] === ')') {\n    array.splice(array.length - 1);\n    array.splice(0, 1);\n  }\n}\n\nfunction splitArray(array, split) {\n  stripOuterParens(array);\n\n  const chunks = [];\n  let chunk = [];\n  const stack = [];\n  array.forEach(token => {\n    if (token === '(') {\n      stack.push(true);\n      chunk.push(token);\n    } else if (token === ')') {\n      stack.pop();\n      chunk.push(token);\n    } else if (!stack.length && token === split) {\n      if (chunk.length) {\n        chunks.push(chunk);\n      }\n      chunk = [];\n    } else {\n      chunk.push(token);\n    }\n  });\n  if (chunk.length) {\n    chunks.push(chunk);\n  }\n\n  chunks.forEach(c => stripOuterParens(c));\n\n  return chunks;\n}\n\nfunction buildType(def, scope) {\n  // shortcuts\n  if (typeof def === 'boolean') {\n    def = def ? 'bool{true}' : 'bool{false}'; // eslint-disable-line no-param-reassign\n  }\n\n  // references\n  if (typeof def === 'string') {\n    const tokens = parseTokensFromType(def);\n\n    const branches = splitArray(tokens, '|');\n    if (branches.length > 1) {\n      if (branches.length !== new Set(branches).size) {\n        throw new Error('duplicate types in branch list');\n      }\n      const branchMap = new Map();\n      branches.forEach(branch => {\n        branchMap.set(branch, buildType(scopify(branch.join(''), scope)));\n      });\n      return BranchType.create(branchMap);\n    }\n\n    const map = splitArray(tokens, '=>');\n    if (map.length > 1) {\n      return new MapType(buildType(map[0].join(''), scope), buildType(map[1].join(''), scope));\n    }\n\n    if (tokens[tokens.length - 1] === '[]') {\n      return new ArrayType(buildType(tokens.slice(0, tokens.length - 1).join(''), scope));\n    }\n\n    if (tokens[tokens.length - 1] === '}') {\n      return ScalarType.create(\n        tokens[tokens.indexOf('{') - 1],\n        tokens.slice(tokens.indexOf('{') + 1, tokens.length - 1).filter(t => t !== ',')\n      );\n    }\n\n    if (tokens[tokens.length - 1] === ')') {\n      const transformStart = tokens.indexOf(':');\n      const transformName = tokens[transformStart + 1];\n      const transformArgs = tokens.slice(transformStart + 3, tokens.length - 1).filter(t => t !== ',');\n\n      const transforms = {\n        map: type => {\n          const branchMap = new Map();\n          type.attributes().forEach(attr =>\n            branchMap.set(attr.name(), new ObjectType([\n              new AttributeType(transformArgs[0], ScalarType.create('string', [attr.name()]), true),\n              new AttributeType(transformArgs[1], attr.type().clone(), true),\n            ]))\n          );\n          return new BranchType(branchMap);\n        },\n      };\n      if (!transforms[transformName]) {\n        throw new Error('unsupported transform');\n      }\n      return transforms[transformName](buildType(tokens.slice(0, transformStart).join(''), scope));\n    }\n\n    const scopedName = scopify(tokens.join(''), scope);\n    if (registeredTypes.has(scopedName)) {\n      return registeredTypes.get(scopedName).clone();\n    }\n    return ScalarType.create(scopedName);\n  }\n\n  // check for inheritance\n  const attributeNames = Object.keys(def).filter(key => key !== '^');\n  const inheritanceAttr = def['^'];\n  if (inheritanceAttr) {\n    if (typeof inheritanceAttr !== 'string') {\n      throw new Error('inheritance attribute must be a string');\n    }\n\n    const parents = parseTokensFromType(inheritanceAttr).filter(t => t !== ',').map(parent =>\n      registeredTypes.get(scopify(parent, scope))\n    );\n\n    if (parents.length === 1 && parents[0] instanceof BranchType) {\n      const parent = parents[0];\n      if (!Array.from(parent.types.values()).every(branchType => branchType instanceof Object)) {\n        throw new Error('inheritance from branch with non-object');\n      }\n      // create inherited version of each object and re-aggregate\n      const inheritedTypes = new Map();\n      parent.types.forEach((branchType, key) => {\n        const builder = (t, k) => {\n          // add attributes to each branch\n          const attributes = new Map();\n          t.attributes().forEach(attr => {\n            attributes.set(attr.name(), attr.clone());\n          });\n          attributeNames.forEach(attr =>\n            attributes.set(attr.trim('?'), createAttrFromName(attr, buildType(def[attr], scope)))\n          );\n          inheritedTypes.set(k, new ObjectType(Array.from(attributes.values())));\n        };\n\n        if (branchType instanceof BranchType) {\n          branchType.types.forEach((t, k) => builder(t, `${key}-${k}`));\n        } else {\n          builder(branchType, key);\n        }\n      });\n      return new BranchType(inheritedTypes);\n    } else if (parents.every(parent => parent instanceof ObjectType)) {\n      // simple inheritance\n      const attributes = new Map();\n      parents.forEach(parent => {\n        parent.attributes().forEach(parentAttr => {\n          attributes.set(parentAttr, parentAttr.clone());\n        });\n      });\n      attributeNames.forEach(attr =>\n        attributes.set(attr.trim('?'), createAttrFromName(attr, buildType(def[attr], scope)))\n      );\n      return new ObjectType(Array.from(attributes.values()));\n    }\n\n    throw new Error('invalid parent type');\n  }\n\n  // no inheritance\n  return new ObjectType(attributeNames.map(attr => createAttrFromName(attr, buildType(def[attr], scope))));\n}\n\nexport default class Squalus {\n\n  static getType(name) {\n    return registeredTypes.get(name);\n  }\n\n  static buildTypes(root) {\n    // check names and dependencies\n    const dependencies = buildKnownDependencies().concat(parseRoot(root));\n    const sorted = topoSort(dependencies, d => d.name, d => d.requires);\n\n    sorted.forEach((type, name) => {\n      const scope = name.indexOf('.') ? name.substring(0, name.indexOf('.')) : null;\n      registeredTypes.set(name, buildType(type.data, scope));\n    });\n  }\n\n  static buildTests(tests, root) {\n    const ul = root.appendChild($('ul', { class: 'api-tests' }));\n\n    tests.forEach(test => {\n      const params = new Map();\n      if (test.params) {\n        Object.keys(test.params).forEach(key => {\n          params.set(key, buildType(test.params[key]));\n        });\n      }\n      const def = new Endpoint(test.url, test.method, params, test.data ? buildType(test.data) : null);\n      ul.appendChild($('li', def.build()));\n    });\n\n    const events = {\n      change: {\n        'select.test-option': BranchType.onChange,\n      },\n      click: {\n        '.test-row-add': ArrayType.onClickAdd,\n        '.test-row-remove': ArrayType.onClickRemove,\n        '.test-attr-toggle': AttributeType.onClickToggle,\n        '.test-edit': Endpoint.onEdit,\n        '.test-submit': Endpoint.onSubmit,\n      },\n      keypress: {\n        'input[type=text],input[type=checkbox],select': Endpoint.onKeyPress,\n      },\n    };\n\n    // handle events\n    Object.keys(events).forEach(type => {\n      root.addEventListener(type, e => {\n        if (e.target) {\n          const def = Endpoint.closest(e.target);\n          if (def) {\n            Object.keys(events[type]).forEach(selector => {\n              if (e.target.matches(selector)) {\n                const func = events[type][selector];\n                func(e, def);\n              }\n            });\n          }\n        }\n      });\n    });\n\n    BranchType.initializeSelectionStates(root);\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Squalus.js\n **/","\nfunction isObject(obj) {\n  return obj === Object(obj) && !Array.isArray(obj);\n}\n\nfunction appendNode(element, content) {\n  if (content && content.nodeType) {\n    element.appendChild(content);\n  } else {\n    const div = document.createElement('div');\n    div.innerHTML = (content === undefined) ? '' : content;\n\n    while (div.firstChild) {\n      element.appendChild(div.firstChild);\n    }\n  }\n}\n\n// (tagName, attributes?, children?, children?)\nexport default function (tagName, ...args) {\n  const attributes = (args.length && isObject(args[0]) && !args[0].nodeType) ? args[0] : {};\n  const children = args.slice((args[0] === attributes) ? 1 : 0);\n\n  const elem = document.createElement(tagName);\n\n  Object.keys(attributes).forEach(name => {\n    if (name.startsWith('data-')) {\n      elem.dataset[name.substr(5)] = attributes[name];\n    } else if (name.startsWith('_')) {\n      elem[name] = attributes[name];\n    } else {\n      elem.setAttribute(name, attributes[name]);\n    }\n  });\n\n  children.forEach((child) => {\n    if (Array.isArray(child)) {\n      child.forEach((c) => {\n        appendNode(elem, c);\n      });\n    } else {\n      appendNode(elem, child);\n    }\n  });\n\n  return elem;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Tag.js\n **/","import { default as $ } from './Tag';\nimport Result from './Result';\n\nfunction closestAncestorByClassName(elem, className) {\n  let e = elem.parentNode;\n  while (e) {\n    if (e.classList && e.classList.contains(className)) {\n      return e;\n    }\n    e = e.parentNode;\n  }\n  return null;\n}\n\nfunction convertValueToParam(val, key, query) {\n  if (Array.isArray(val)) {\n    val.forEach((item, i) =>\n      convertValueToParam(item, `${key}[${i}]`, query)\n    );\n  } else if (typeof val === 'object') {\n    Object.keys(val).forEach((name) =>\n      convertValueToParam(val[name], `${key}[${name}]`, query)\n    );\n  } else if (typeof val === 'boolean') {\n    query.set(key, encodeURI(val ? 1 : 0));\n  } else {\n    query.set(key, encodeURI(val));\n  }\n}\n\nexport default class Endpoint {\n\n  constructor(url, method, params, type) {\n    this._url = url;\n    this._method = method;\n    this._params = (params && params.size) ? params : null;\n    this._type = type;\n\n    this._node = null;\n  }\n\n  updateSingleParam(data) {\n    if (this._params) {\n      if (data.Id) {\n        this._node.querySelector('.test-param')._squalusType.populate(data.Id);\n      }\n    }\n  }\n\n  value() {\n    if (!this._type) {\n      return null;\n    }\n    return this._type.value();\n  }\n\n  populate(data, types) {\n    this._type.populate(data, 'body', types);\n  }\n\n  clear() {\n    this._type.clear();\n  }\n\n  lock() {\n    // this causes problems with the \"edit\" populate\n    // this._body.find('*').prop('disabled', true);\n  }\n\n  unlock() {\n    // this._body.find('*').prop('disabled', false);\n  }\n\n  getPopulatedUrl() {\n    const query = new Map();\n    let url = this._url;\n    if (this._params) {\n      Array.from(this._node.querySelectorAll('.test-param')).forEach(param => {\n        const key = param.dataset.name;\n        const keyPlaceholder = `{${key}}`;\n        const val = param._squalusType.value();\n        if (url.indexOf(keyPlaceholder) === -1) {\n          if (val !== null && val !== '') {\n            convertValueToParam(val, key, query);\n          }\n        } else {\n          url = url.replace(keyPlaceholder, encodeURI(val));\n        }\n      });\n    }\n\n    url = new URL(url, window.location.href);\n    query.forEach((value, key) => url.searchParams.append(key, value));\n\n    return url;\n  }\n\n  build() {\n    this._node = $('div', { class: `endpoint endpoint-method-${this._method.toLowerCase()}`, _squalusDef: this },\n      $('div', { class: 'endpoint-header' },\n        $('span', { class: 'endpoint-method' }, this._method),\n        $('span', { class: 'endpoint-url' }, this._url)\n      )\n    );\n\n    const test = this._node.appendChild($('div', { class: 'endpoint-test' }));\n\n    if (this._params) {\n      const names = this._url.match(/{[^}\\s]+}/g).map(m => m.substr(1, m.length - 2));\n\n      if (this._params.size > names.length) {\n        names.prototype.push.apply(names, Array.from(this._params.keys()).filter(p => !names.includes(p)));\n      }\n\n      const params = test.appendChild($('div', { class: 'endpoint-test-params' },\n        $('div', { class: 'endpoint-test-label' }, 'params')\n      ));\n      params.appendChild($('table',\n        $('tbody',\n          names.map(param => {\n            const type = this._params.get(param);\n            if (type === undefined) {\n              throw new Error('required param type not specified');\n            }\n            return $('tr', { class: 'test-param', 'data-name': param, _squalusType: type },\n              $('th', param),\n              $('td', type.build())\n            );\n          })\n        )\n      ));\n      if (this._method === 'PUT') {\n        test.appendChild($('div', { class: 'endpoint-test-controls' },\n          $('input', { type: 'button', value: 'EDIT', class: 'test-edit' }),\n          $('span', { class: 'endpoint-test-status test-edit-status' })\n        ));\n      }\n    }\n\n    if (this._type) {\n      test.appendChild($('div', { class: 'endpoint-test-body' },\n        $('div', { class: 'endpoint-test-label' }, 'body'),\n        this._type.build())\n      );\n    }\n\n    test.appendChild($('div', { class: 'endpoint-test-controls' },\n      $('input', { type: 'button', value: this._method, class: 'test-submit' }),\n      $('span', { class: 'endpoint-test-status' })\n    ));\n\n    return this._node;\n  }\n\n  submit() {\n    // todo: trap parse errors\n    const url = this.getPopulatedUrl();\n    const value = JSON.stringify(this.value());\n\n    const options = {\n      method: this._method,\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    };\n    if (['PUT', 'POST', 'PATCH'].includes(this._method)) {\n      options.body = value;\n    }\n\n    fetch(url, options).then(res => {\n      new Result(url, res).parse();\n    }).catch(error => {\n      new Result(url, error).parse();\n    });\n  }\n\n  edit() {\n    const url = this.getPopulatedUrl();\n    const status = this._node.querySelector('.test-edit-status');\n\n    status.textContent = '';\n\n    this.clear();\n    this.lock();\n\n    fetch(url).then(res => {\n      // testing\n      // const json = {\n      //   IntervalUnit: 'monthly',\n      //   IntervalOffset: 15,\n      //   TemplateId: 4,\n      //   Id: 3990,\n      // };\n\n      if (!res.ok) {\n        status.textContent = 'something went wrong';\n        this.unlock();\n        return;\n      }\n\n      res.json().then(json => {\n        let data = json;\n        // todo: this is going to require the actual validation implementation to handle branching\n\n        // if data is array, edit the first one (for convenience, to support shared id/search path)\n        if (Array.isArray(data)) {\n          if (data.length && this._params && this._params.size === 1) {\n            status.textContent = `Loaded first record (${data.length} total)`;\n            data = data[0];\n            this.updateSingleParam(data);\n          } else {\n            data = null;\n          }\n        }\n        if (data) {\n          this.populate(data);\n        } else {\n          status.textContent = 'No match for pattern';\n        }\n\n        this.unlock();\n      });\n    }).catch(error => {\n      status.textContent = error.message;\n      this.unlock();\n    });\n  }\n\n  static onKeyPress(event, def) {\n    if (event.which === 13) {\n      event.preventDefault();\n      (def || this.closest(event.target)).submit();\n    }\n  }\n\n  static onSubmit(event, def) {\n    (def || this.closest(event.target)).submit();\n  }\n\n  static onEdit(event, def) {\n    (def || this.closest(event.target)).edit();\n  }\n\n  static closest(elem) {\n    const node = closestAncestorByClassName(elem, 'endpoint');\n    return node ? node._squalusDef : null;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Endpoint.js\n **/","\nexport default class Result {\n\n  constructor(relativeUrl, response) {\n    this._relativeUrl = relativeUrl;\n    this._response = response;\n  }\n\n  parse() {\n    if (this._response instanceof Response) {\n      if (this._response.ok) {\n        //\n      } else {\n        //\n      }\n    } else {\n      console.log(this._response.message);\n    }\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Result.js\n **/","\nexport default function (elements, getName, getRequires) {\n  const edges = new Map();\n  const s = [];\n\n  const sources = new Map();\n  elements.forEach(elem => sources.set(getName(elem), elem));\n\n  sources.forEach(source => {\n    const requires = getRequires(source);\n    if (requires && requires.length) {\n      requires.forEach(dependency => {\n        if (!sources.has(dependency)) {\n          throw new Error(`Unknown dependency ${dependency}`);\n        }\n        if (!edges.has(dependency)) {\n          edges.set(dependency, []);\n        }\n        edges.get(dependency).push(getName(source));\n      });\n    } else {\n      s.push(source);\n    }\n  });\n\n  let parents;\n  const sorted = new Map();\n  while (s.length > 0) {\n    const nSource = s.pop();\n    const n = getName(nSource);\n    sorted.set(n, nSource);\n    if (edges.has(n)) {\n      parents = edges.get(n);\n      while (parents.length > 0) {\n        const m = parents.pop();\n        const mSource = sources.get(m);\n        const requires = getRequires(mSource);\n        if (!requires || !requires.find(d => !sorted.has(d))) {\n          s.push(mSource);\n        }\n      }\n    }\n  }\n\n  edges.forEach(value => {\n    if (value.size > 0) {\n      throw new Error('Graph cycle; unable to sort');\n    }\n  });\n\n  return sorted;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/TopoSort.js\n **/","import { default as $ } from './../Tag';\nimport NullableType from './NullableType';\nimport NullScalarType from './Scalar/NullScalarType';\n\nexport default class BranchType {\n\n  constructor(types) {\n    if (types.size < 2) {\n      throw new Error('degenerate branch type');\n    }\n\n    this._types = types;\n    this._node = null;\n  }\n\n  get types() {\n    return this._types;\n  }\n\n  clone() {\n    const types = new Map();\n    this._types.forEach((type, key) => types.set(key, type.clone()));\n    return new this.constructor(types);\n  }\n\n  build() {\n    this._node = $('div', { _squalusType: this },\n      $('select', { class: 'test-option' },\n        Array.from(this._types.keys(), key => $('option', key))\n      ),\n      Array.from(this._types.values(), value => $('div', { class: 'test-option' }, value.build()))\n    );\n    return this._node;\n  }\n\n  value() {\n    return Array.from(this._types.values())[this._node.firstElementChild.selectedIndex].value();\n  }\n\n  populate(data) {\n    // validate data to determine branch\n    const types = Array.from(this._types.values());\n    const i = types.findIndex(type =>\n      type.validate(data, '', true)\n    );\n\n    if (i === -1) {\n      throw new Error('branch validation failed');\n    }\n\n    const select = this._node.firstElementChild;\n    select.selectedIndex = i;\n\n    const event = new Event('change', { bubbles: true });\n    select.dispatchEvent(event);\n\n    types[i].populate(data);\n  }\n\n  validate(value, path, silent, context) {\n    if (!Array.from(this._types.values()).some(type => type.validate(value, path, true, context))) {\n      if (silent) {\n        return false;\n      }\n      throw new Error(`${path} does not match any candidate`);\n    }\n    return true;\n  }\n\n  clear() {\n    this._types.forEach(type => type.clear());\n  }\n\n  toJSON() {\n    return {\n      _: 'branch',\n      types: this._types,\n    };\n  }\n\n  static onChange(event) {\n    let node = event.target;\n    let i = 0;\n    while (node.nextElementSibling) {\n      node = node.nextElementSibling;\n      node.classList.toggle('test-hidden', i++ !== event.target.selectedIndex);\n    }\n  }\n\n  static initializeSelectionStates(root) {\n    Array.from(root.querySelectorAll('select')).forEach(elem => {\n      const event = new Event('change', { bubbles: true });\n      elem.dispatchEvent(event);\n    });\n  }\n\n  static create(types) {\n    if (types.size === 2) {\n      const nonNullTypes = Array.from(types.values()).filter(t => !(t instanceof NullScalarType));\n      if (nonNullTypes.length === 1) {\n        return new NullableType(nonNullTypes[0]);\n      }\n    }\n    return new BranchType(types);\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Type/BranchType.js\n **/","export default class NullableType {\n\n  constructor(type) {\n    this._type = type;\n  }\n\n  name() {\n    return this._type.name();\n  }\n\n  build() {\n    return this._type.build();\n  }\n\n  clone() {\n    return new this.constructor(this._type.clone());\n  }\n\n  value() {\n    let val = this._type.value();\n    if (val === '') {\n      val = null;\n    }\n    return val;\n  }\n\n  validate(value, path, silent, context) {\n    return (value === null) || this._type.validate(value, path, silent, context);\n  }\n\n  populate(data, path, types) {\n    this._type.populate(data, path, types);\n  }\n\n  clear() {\n    this._type.clear();\n  }\n\n  toJSON() {\n    return {\n      _: 'nullable',\n      type: this._type,\n    };\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Type/NullableType.js\n **/","import ScalarType from './../ScalarType';\n\nexport default class NullScalarType extends ScalarType {\n\n  supportsValues() {\n    return false;\n  }\n\n  _build() {\n    return document.createTextNode('');\n  }\n\n  _validate(value) {\n    return value === null;\n  }\n\n  value() {\n    return null;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Type/Scalar/NullScalarType.js\n **/","import { default as $ } from './../Tag';\n\nconst implementations = new Map();\n[\n  'null',\n  'int',\n  'uint',\n  'float',\n  'string',\n  'bool',\n  'date',\n  'datetime',\n  'timestamp',\n  'guid',\n].forEach(type => implementations.set(type, null));\n\nexport default class ScalarType {\n\n  constructor(type, values) {\n    this._type = type;\n    this._values = this._parse(values);\n    this._node = null;\n  }\n\n  get name() {\n    return this._type;\n  }\n\n  clone() {\n    return new this.constructor(this._type, this._values);\n  }\n\n  supportsValues() {\n    return true;\n  }\n\n  _parse(values) {\n    return values;\n  }\n\n  _build() {\n    if (this._values) {\n      if (this._values.length === 1) {\n        return $('input', { type: 'text', disabled: true, value: this._values[0] });\n      }\n      return $('select',\n        this._values.map(v => $('option', v))\n      );\n    }\n    return $('input', { type: 'text', placeholder: this._type });\n  }\n\n  build() {\n    this._node = this._build();\n    this._node._squalusType = this;\n    return this._node;\n  }\n\n  value() {\n    return this._node.value;\n  }\n\n  populate(data) {\n    this._node.value = data;\n  }\n\n  _validate(value) {\n    return typeof value === 'string';\n  }\n\n  validate(value, path, silent) {\n    if (!this._validate(value, path, silent)) {\n      if (silent) {\n        return false;\n      }\n      throw new Error(`${path} must be of type ${this._type}`);\n    }\n\n    if (this._values && !this._values.includes(value)) {\n      if (silent) {\n        return false;\n      }\n      throw new Error(`${path}: '${value}' must be in [${this._values.join(', ')}]`);\n    }\n\n    return true;\n  }\n\n  clear() {\n    if (this._values) {\n      if (this._node.selectedIndex !== undefined) {\n        this._node.selectedIndex = 0;\n      }\n    } else {\n      this._node.value = '';\n    }\n  }\n\n  static register(type, implementation) {\n    if (Array.isArray(type)) {\n      type.forEach(t => implementations.set(t, implementation));\n    } else {\n      implementations.set(type, implementation);\n    }\n  }\n\n  toJSON() {\n    return {\n      _: 'scalar',\n      type: this._type,\n    };\n  }\n\n  static create(type, values) {\n    return new (implementations.get(type) || ScalarType)(type, values);\n  }\n\n  static getScalarTypes() {\n    return Array.from(implementations.keys());\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Type/ScalarType.js\n **/","import { default as $ } from './../Tag';\nimport BranchType from './BranchType';\n\nexport default class ArrayType {\n\n  constructor(type) {\n    this._type = type;\n    this._rows = [];\n    this._node = null;\n    this._body = null;\n  }\n\n  name() {\n    return `${this._type.name()}[]`;\n  }\n\n  clone() {\n    return new this.constructor(this._type.clone());\n  }\n\n  build() {\n    this._node = $('div', { _squalusType: this },\n      $('table',\n        this._body = $('tbody'),\n        $('tfoot',\n          $('th', $('input', { type: 'button', class: 'test-row-add', value: '+' })),\n          $('th'),\n          $('td')\n        )\n      )\n    );\n    return this._node;\n  }\n\n  populate(data, path, types) {\n    for (let i = 0; i < data.length; i++) {\n      const row = this.add();\n      row.populate(data[i], `${path}[${i}]`, types);\n    }\n  }\n\n  validate(value, path, silent, context) {\n    if (!Array.isArray(value)) {\n      if (silent) {\n        return false;\n      }\n      throw new Error(`${path} must be an array`);\n    }\n\n    return value.every((item, i) => this._type.validate(item, `${path}[${i}]`, silent, context));\n  }\n\n  value() {\n    return this._rows.map((val) => val.value());\n  }\n\n  clear() {\n    this._rows = [];\n    this._body.innerHTML = '';\n  }\n\n  add() {\n    const clone = this._type.clone();\n    this._rows.push(clone);\n    this._body.appendChild($('tr',\n      $('th', $('input', { type: 'button', class: 'test-row-remove', value: '-' })),\n      $('th', `[${this._body.children.length}]`),\n      $('td', clone.build())\n    ));\n    BranchType.initializeSelectionStates(this._body.lastElementChild);\n    return clone;\n  }\n\n  remove(i) {\n    this._rows.splice(i, 1);\n    this._body.children[i].remove();\n\n    for (let j = i; j < this._body.children.length; j++) {\n      this._body.children[j].children[1].textContent = `[${j}]`;\n    }\n  }\n\n  toJSON() {\n    return {\n      _: 'array',\n      type: this._type,\n    };\n  }\n\n  static onClickAdd(event) {\n    event.target.parentNode.parentNode.parentNode.parentNode._squalusType.add();\n  }\n\n  static onClickRemove(event) {\n    const row = event.target.parentNode.parentNode;\n    const i = Array.prototype.indexOf.call(row.parentNode.children, row);\n    row.parentNode.parentNode.parentNode._squalusType.remove(i);\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Type/ArrayType.js\n **/","import { default as $ } from './../Tag';\n\nexport default class AttributeType {\n\n  constructor(name, type, required) {\n    this._name = name;\n    this._type = type;\n    this._required = required;\n    this._included = false;\n\n    if (this._name.endsWith('?')) {\n      console.log(this);\n    }\n  }\n\n  name() {\n    return this._name;\n  }\n\n  type() {\n    return this._type;\n  }\n\n  required() {\n    return this._required;\n  }\n\n  included() {\n    return this._included;\n  }\n\n  clone() {\n    return new this.constructor(this._name, this._type.clone(), this._required);\n  }\n\n  build() {\n    this._node = $('tr', { _squalusType: this },\n      $('th'),\n      $('th', this._name),\n      $('td', this._type.build())\n    );\n    if (!this._required) {\n      this._node.firstElementChild.appendChild(\n        $('input', { type: 'button', class: 'test-attr-toggle', value: '\\uD83D\\uDCCE' })\n      );\n    }\n    this.update();\n    return this._node;\n  }\n\n  value() {\n    return this._type.value();\n  }\n\n  populate(data, path, types) {\n    this._type.populate(data, `${path}.${this._name}`, types);\n    this._included = true;\n    this.update();\n  }\n\n  validate(value, path, silent, context) {\n    return this._type.validate(value, path, silent, context);\n  }\n\n  clear() {\n    this._type.clear();\n    this._included = false;\n    this.update();\n  }\n\n  toggle() {\n    this._included = !this._included;\n    this.update();\n  }\n\n  update() {\n    if (!this._required) {\n      this._node.children[0].firstElementChild.classList.toggle('test-attr-included', this._included);\n      this._node.children[1].classList.toggle('test-attr-toggle', !this._included);\n      this._node.children[2].firstElementChild.classList.toggle('test-hidden', !this._included);\n    }\n  }\n\n  toJSON() {\n    return {\n      _: 'attribute',\n      name: this._name,\n      type: this._type,\n    };\n  }\n\n  static onClickToggle(event) {\n    event.target.parentNode.parentNode._squalusType.toggle();\n  }\n}\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Type/AttributeType.js\n **/","import { default as $ } from './../Tag';\n\nexport default class ObjectType {\n\n  constructor(attributes) {\n    this._attributes = attributes;\n    this._node = null;\n  }\n\n  attributes() {\n    return this._attributes;\n  }\n\n  clone() {\n    return new this.constructor(this._attributes.map(attr => attr.clone()));\n  }\n\n  build() {\n    this._node = $('table', { _squalusType: this },\n      $('tbody',\n        this._attributes.map(type => type.build())\n      )\n    );\n    return this._node;\n  }\n\n  value() {\n    const data = {};\n    this._attributes.forEach((attr) => {\n      if (attr.required() || attr.included()) {\n        data[attr.name()] = attr.value();\n      }\n    });\n    return data;\n  }\n\n  populate(data, path, types) {\n    this._attributes.forEach(attr => {\n      attr.populate(data[attr.name()], path, types);\n    });\n  }\n\n  validate(value, path, silent, context) {\n    // todo: filter/warn on unrecognized attributes\n\n    if (typeof value !== 'object' || value === null) {\n      if (silent) {\n        return false;\n      }\n      throw new Error(`${path} must be an object`);\n    }\n\n    for (let i = 0; i < this._attributes.length; i++) {\n      const attr = this._attributes[i];\n      const key = attr.name();\n\n      if (value[key] === undefined) {\n        if (attr.required()) {\n          if (silent) {\n            return false;\n          }\n          throw new Error(`${path}.${key} is required`);\n        }\n      } else if (!attr.validate(value[key], `${path}.${key}`, silent, context)) {\n        return false;\n      }\n    }\n\n    if (context._throwUnknownObjectAttributes) {\n      const allowedKeys = new Set(this._attributes.map(a => a.name()));\n      const diff = Object.keys(value).filter(x => !allowedKeys.has(x));\n      if (diff.length > 0) {\n        throw new Error(`Unknown attributes \\`${diff.join(',')}\\` not allowed in \\`${path}\\``);\n      }\n    }\n\n    return true;\n  }\n\n  clear() {\n    this._attributes.forEach(attr => attr.clear());\n  }\n\n  toJSON() {\n    return {\n      _: 'object',\n      attributes: this._attributes,\n    };\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Type/ObjectType.js\n **/","import { default as $ } from './../Tag';\nimport BranchType from './BranchType';\n\nexport default class MapType {\n\n  constructor(key, type, required) {\n    this._type = type;\n    this._key = key;\n    this._required = required;\n    this._rows = [];\n    this._node = null;\n    this._body = null;\n  }\n\n  name() {\n    return `${this._type.name()}{}`;\n  }\n\n  clone() {\n    return new this.constructor(this._key.clone(), this._type.clone(), this._required ? this._required.clone() : null);\n  }\n\n  build() {\n    this._node = $('div', { _squalusType: this },\n      $('table',\n        this._body = $('tbody'),\n        $('tfoot',\n          $('th', $('input', { type: 'button', class: 'test-row-add', value: '+' })),\n          $('th'),\n          $('td')\n        )\n      )\n    );\n    if (this._required) {\n      this._required.attributes().forEach((attr) => {\n        this.add(attr.type(), attr.name());\n      });\n    }\n    return this._node;\n  }\n\n  populate(data, path, types) {\n    Object.keys(data).forEach((key, i) => {\n      const row = this.add();\n      this._body.children[i].firstElementChild.textContent = key;\n      row.populate(data[key], `${path}[${key}]`, types);\n    });\n  }\n\n  validate(value, path, silent, context) {\n    if (typeof value !== 'object' || value === null) {\n      if (silent) {\n        return false;\n      }\n      throw new Error(`${path} must be an object`);\n    }\n\n    const keys = Object.keys(value);\n    for (let i = 0; i < keys.length; i++) {\n      const key = keys[i];\n\n      if (!this._key.validate(key, `${path}[${key}]*`, silent, context)) {\n        return false;\n      }\n\n      if (!this._type.validate(value[key], `${path}[${key}]`, silent, context)) {\n        return false;\n      }\n    }\n\n    if (this._required) {\n      if (!this._type.validate(value, path, silent, context)) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  value() {\n    const obj = {};\n    this._rows.forEach((row, i) => {\n      const key = this._body.children[i].children[1].firstElementChild.value;\n      obj[key] = row.value();\n    });\n    return obj;\n  }\n\n  clear() {\n    this._rows = [];\n    this._body.innerHTML = '';\n  }\n\n  add(type, key) {\n    const clone = type || this._type.clone();\n    this._rows.push(clone);\n    const keyField = this._key ? this._key.build() : $('input', { type: 'text', placeholder: 'key' });\n    if (key) {\n      keyField.value = key;\n    }\n    this._body.appendChild($('tr',\n        $('th', $('input', { type: 'button', class: 'test-row-remove', value: '-' })),\n        $('th', keyField),\n        $('td', clone.build())\n      ));\n    BranchType.initializeSelectionStates(this._body.lastElementChild);\n    return clone;\n  }\n\n  remove(i) {\n    this._rows.splice(i, 1);\n    this._body.children[i].remove();\n  }\n\n  toJSON() {\n    return {\n      _: 'map',\n      key: this._key,\n      type: this._type,\n    };\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Type/MapType.js\n **/","import { default as $ } from './../../Tag';\nimport ScalarType from './../ScalarType';\n\nexport default class BoolScalarType extends ScalarType {\n\n  _parse(values) {\n    return values ? values.map(v => v === true || v === 'true') : null;\n  }\n\n  _build() {\n    return $('input', { type: 'checkbox' });\n  }\n\n  _validate(value) {\n    return typeof value === 'boolean';\n  }\n\n  value() {\n    return this._node.checked;\n  }\n\n  populate(data) {\n    this._node.checked = data;\n  }\n\n  clear() {\n    this._node.checked = false;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Type/Scalar/BoolScalarType.js\n **/","import ScalarType from './../ScalarType';\n\nexport default class FloatScalarType extends ScalarType {\n\n  _parse(values) {\n    return values ? values.map(v => parseFloat(v)) : null;\n  }\n\n  _validate(value) {\n    return typeof value === 'number';\n  }\n\n  value() {\n    return parseFloat(this._node.value);\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Type/Scalar/FloatScalarType.js\n **/","import ScalarType from './../ScalarType';\n\nexport default class IntScalarType extends ScalarType {\n\n  constructor(type, values) {\n    super(type, values);\n    this._validator = null;\n  }\n\n  _parse(values) {\n    if (!values) {\n      return null;\n    }\n\n    const parsed = values.reduce((previous, current) => {\n      if (typeof current === 'number') {\n        if ((current | 0) !== current) {\n          throw new Error('not an int');\n        }\n        previous.push(current);\n      } else if (current.indexOf('-') !== -1) {\n        const parts = current.split('-');\n        const start = parseInt(parts[0], 10);\n        const end = parseInt(parts[1], 10);\n        previous.push([start, end]);\n      } else {\n        previous.push(parseInt(current, 10));\n      }\n      return previous;\n    }, []);\n\n    const ranges = parsed.filter(p => Array.isArray(p));\n\n    if (!ranges.length) {\n      return parsed.sort((a, b) => a - b);\n    }\n\n    const fixed = parsed.filter(p => !Array.isArray(p));\n\n    const rangeSize = ranges.reduce((previous, current) => previous + (current[1] - current[0]), 0);\n\n    // if the ranges are small enough, just enumerate them\n    if (rangeSize + fixed.length <= 100) {\n      ranges.forEach(r => {\n        for (let i = r[0]; i <= r[1]; i++) {\n          fixed.push(i);\n        }\n      });\n      return fixed.sort((a, b) => a - b);\n    }\n\n    this._validator = (value) => fixed.includes(value) || ranges.some(r => r[0] <= value && value >= r[1]);\n\n    return null;\n  }\n\n  _validate(value) {\n    return typeof value === 'number' && (value | 0) === value;\n  }\n\n  value() {\n    return parseInt(this._node.value, 10);\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Type/Scalar/IntScalarType.js\n **/","/* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"^colors$\" }] */\n\n// colors is imported for the side effects\nimport colors from 'colors';\nimport topoSort from '../TopoSort';\nimport TestError from './TestError';\nimport ValidationContext from '../ValidationContext';\n\nexport default class TestCollection {\n\n  constructor(name, options) {\n    this._name = name;\n    this._groups = null;\n    this._cancel = false;\n    this._sequential = !!((options || {}).sequential);\n    this._validationContext = new ValidationContext(\n      !!((options || {}).throwUnknownObjectAttributes)\n    );\n  }\n\n  groups(groups) {\n    this._groups = groups;\n    return this;\n  }\n\n  getMaxGroupNameLength() {\n    if (this._groups && !this._maxGroupNameLength) {\n      this._maxGroupNameLength = this._groups.reduce((a, b) => (a._name.length > b._name.length ? a : b))._name.length;\n    }\n    return this._maxGroupNameLength;\n  }\n\n  execute(initial) {\n    const startTime = Date.now();\n\n    let root = Promise.resolve();\n    const context = new Map();\n    if (initial) {\n      Object.keys(initial).forEach(k => context.set(k, initial[k]));\n    }\n\n    const testCount = this._groups.reduce((a, b) => a + b._tests.length, 0);\n\n    const options = [];\n    if (this._sequential) {\n      options.push('sequential');\n    }\n    if (this._validationContext._throwUnknownObjectAttributes) {\n      options.push('throwUnknownObjectAttributes');\n    }\n\n    console.log();\n    console.log('  collection [%s] %s', this._name.green, options.length > 0 ? `(${options.join(',')})` : '');\n    console.log();\n\n    this._groups = Array.from(topoSort(this._groups, g => g._name, g =>\n      (g._requires ? g._requires.map(r => r._name) : null)\n    ).values());\n\n    return Promise.all(this._groups.map((g, i, a) => {\n      if (this._sequential && i > 0) {\n        root = a[i - 1].execute();\n      }\n      return g.execute(context, this, root);\n    })).then(() => {\n      console.log();\n      console.log('  %s after %s',\n        `${testCount} passing`.green,\n        `${(Date.now() - startTime)} ms`.magenta\n      );\n      console.log();\n    }).catch(error => {\n      if (this._cancel) {\n        return;\n      }\n\n      this._cancel = true;\n\n      if (error instanceof TestError) {\n        error.log(context, startTime);\n      } else {\n        console.log(error);\n      }\n    });\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Automation/TestCollection.js\n **/","module.exports = require(\"colors\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"colors\"\n ** module id = 18\n ** module chunks = 0\n **/","\nexport default class TestError {\n\n  constructor(test, group, collection, reason, response) {\n    this._test = test;\n    this._group = group;\n    this._collection = collection;\n    this._reason = reason;\n    this._response = response;\n  }\n\n  log(context) {\n    const info = {\n      collection: this._collection._name,\n      group: this._group._name,\n    };\n\n    if (this._test._name !== undefined && this._test._name !== null && this._test._name.length > 0) {\n      info.test = this._test._name;\n    } else {\n      info.test = `#${this._group._tests.indexOf(this._test)}`;\n    }\n\n    info['req-url'] = this._response.request.uri.href;\n    info['req-method'] = this._response.request.method.toUpperCase();\n\n    if (['post', 'put', 'patch'].includes(this._response.request.method)) {\n      info['req-body'] = this._response.request.body;\n    }\n\n    if (this._response.statusCode >= 200 && ![204, 205].includes(this._response.statusCode)) {\n      // the response MAY include an entity\n      const responseContentType = (this._response.headers['content-type'] || '')\n        .split(';')[0].toLowerCase().trim();\n      // technically, the content-type header is only a SHOULD, rather than a MUST for entity responses,\n      // but I don't care enough to sniff the response to determine the media response\n      if (responseContentType) {\n        let responseBody = this._response.body;\n        let responseNote = null;\n\n        if (responseContentType === 'text/html') {\n          if (this._response.statusCode === 500 && /<span><H1>Server Error in/i.test(responseBody)) {\n            responseNote = 'including only error trace from ASP.NET YSOD response';\n            responseBody = responseBody.replace(/^[\\s\\S]*<!--([\\s\\S]*)-->\\s*$/, '$1');\n          }\n        } else if (responseContentType === 'application/json') {\n          responseBody = JSON.stringify(JSON.parse(responseBody), null, 4);\n        }\n\n        if (this._test._type) {\n          info['res-squalus-type'] = this._test._type;\n        }\n\n        info['res-content-type'] = responseContentType;\n        info['res-body'] = `${(responseNote ? `(${responseNote})` : '')}\\n${responseBody}`;\n      }\n    }\n\n    info.context = JSON.stringify(Array.from(context.keys()).reduce((a, b) =>\n      Object.assign(a, { [`${b}`]: context.get(b) }), {}), null, 4);\n\n    if (this._reason instanceof Error) {\n      info.error = this._reason.stack;\n    } else {\n      info.reason = this._reason;\n    }\n\n    const maxInfoNameLength = Object.keys(info).reduce((a, b) => (Math.max(a, b.length)), 0);\n\n    console.log();\n    console.log('  failed'.red);\n    console.log();\n    Object.keys(info).forEach(k => console.log('    %s%s : %s',\n      k.yellow,\n      info[k].indexOf('\\n') === -1\n        ? ' '.repeat(maxInfoNameLength - k.length)\n        : '',\n      info[k].replace(/\\n/g, `\\n${' '.repeat(4 + 4)}`)\n    ));\n    console.log();\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Automation/TestError.js\n **/","\nexport default class ValidationContext {\n\n  constructor(throwUnknownObjectAttributes) {\n    this._throwUnknownObjectAttributes = !!throwUnknownObjectAttributes;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/ValidationContext.js\n **/","\nexport default class TestGroup {\n\n  constructor(name) {\n    this._name = name;\n    this._requires = null;\n    this._parallel = false;\n    this._session = null;\n    this._tests = null;\n    this._promise = null;\n  }\n\n  requires(groups) {\n    this._requires = Array.isArray(groups) ? groups : [groups];\n    return this;\n  }\n\n  parallel() {\n    this._parallel = true;\n    return this;\n  }\n\n  session(name) {\n    this._session = name;\n    return this;\n  }\n\n  tests(tests) {\n    this._tests = tests;\n    return this;\n  }\n\n  execute(context, collection, root) {\n    if (!this._promise) {\n      if (!collection || !root) {\n        throw new Error('uninitialized promise');\n      }\n\n      let when = root;\n      if (this._requires) {\n        when = Promise.all(this._requires.map(g => g.execute(root, context)).concat([root]));\n      }\n      this._promise = new Promise((resolve, reject) => {\n        if (this._parallel && !collection._sequential) {\n          when.then(() => {\n            Promise.all(this._tests.map(t => t.execute(context, this, collection))).then(resolve, reject);\n          });\n        } else {\n          const tests = this._tests.slice().reverse();\n\n          const onResolve = () => {\n            if (tests.length) {\n              tests.pop().execute(context, this, collection).then(onResolve, reject);\n            } else {\n              resolve();\n            }\n          };\n\n          when.then(onResolve, reject);\n        }\n      });\n    }\n    return this._promise;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Automation/TestGroup.js\n **/","/* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"^colors$\" }] */\n\nimport Squalus from '../Squalus';\nimport rp from 'request-promise';\nimport colors from 'colors';\nimport TestError from './TestError';\n\nfunction padRight(str, width, char = ' ') {\n  if (str.length < width) {\n    return str + char.repeat(width - str.length);\n  }\n  return str;\n}\n\nconst STRIP_COMMENTS = /((\\/\\/.*$)|(\\/\\*[\\s\\S]*?\\*\\/))/mg;\nconst ARGUMENT_NAMES = /([^\\s,]+)/g;\nfunction getParamNames(func) {\n  const fnStr = func.toString().replace(STRIP_COMMENTS, '');\n  let result = fnStr.slice(fnStr.indexOf('(') + 1, fnStr.indexOf(')')).match(ARGUMENT_NAMES);\n  if (result === null) {\n    result = [];\n  }\n  return result;\n}\n\nfunction callFuncWithParamInjection(func, response, body, context) {\n  const sourceParams = new Map();\n  sourceParams.set('response', response);\n  sourceParams.set('body', body);\n  sourceParams.set('context', context);\n  const maps = [sourceParams];\n  Array.from(sourceParams.values()).filter(p => p instanceof Map).forEach(map => maps.push(map));\n\n  return func.apply(null, getParamNames(func).map(name => {\n    const map = maps.find(m => m.has(name));\n    if (map) {\n      return map.get(name);\n    }\n    return undefined;\n  }));\n}\n\nexport default class Test {\n\n  constructor(name) {\n    this._name = name;\n    this._method = null;\n    this._url = null;\n    this._contentType = null;\n    this._responseContentType = null;\n    this._body = null;\n    this._status = null;\n    this._type = null;\n    this._save = null;\n    this._expect = null;\n    this._promise = null;\n  }\n\n  execute(context, group, collection) {\n    if (!this._promise) {\n      let url = this._url;\n      if (typeof url === 'function') {\n        url = url(context);\n      }\n\n      const populateVariables = (m, name) => (context.has(name) ? context.get(name) : m);\n\n      url = url.replace(/[@:]([a-z0-9_]+)/gi, populateVariables);\n      url = url.replace(/{([a-z0-9_]+)}/gi, populateVariables);\n\n      const absUrl = context.get('baseUrl') + url;\n\n      let body = this._body;\n      if (typeof body === 'function') {\n        body = body(context);\n      }\n\n      const reject = (reason, response) =>\n        Promise.reject(new TestError(this, group, collection, reason, response));\n\n      const status = (response) => {\n        if (!this._status || typeof this._status !== 'number') {\n          return reject('invalid response status', response);\n        }\n        if (response.statusCode !== this._status) {\n          return reject(`response status ${response.statusCode} does not match expected ${this._status}`, response);\n        }\n        if (this._responseContentType) {\n          const contentType = (response.headers['content-type'] || '').split(';', 2)[0];\n          if (contentType !== this._responseContentType) {\n            return reject(`response content type ${contentType} does not match expected ${this._responseContentType}`,\n              response);\n          }\n        }\n        return Promise.resolve(response);\n      };\n\n      const type = (response) => {\n        if (this._type) {\n          const responseType = Squalus.getType(this._type);\n          if (!responseType) {\n            return reject(`failed to create response type ${this._type}`, response);\n          }\n          try {\n            const json = JSON.parse(response.body);\n            response.bodyJson = json;// eslint-disable-line no-param-reassign\n            responseType.validate(json, 'body', false, collection._validationContext);\n          } catch (e) {\n            return reject(e, response);\n          }\n          return Promise.resolve(response);\n        }\n        return Promise.resolve(response);\n      };\n\n      const expect = (response) => {\n        if (this._expect) {\n          return Promise.all(this._expect.map((func, i) =>\n            Promise.resolve(callFuncWithParamInjection(\n              func,\n              response,\n              response.bodyJson !== undefined ? response.bodyJson : response.body,\n              context\n            )).then(passed => {\n              if (!passed) {\n                return reject(`expect test '${i}' failed`, response);\n              }\n              return Promise.resolve(response);\n            })\n          )).then(() => Promise.resolve(response));\n        }\n        return Promise.resolve(response);\n      };\n\n      const save = (response) => {\n        if (this._save) {\n          return Promise.all(Array.from(this._save.keys()).map(key =>\n            Promise.resolve(\n              callFuncWithParamInjection(\n                this._save.get(key),\n                response,\n                response.bodyJson !== undefined ? response.bodyJson : response.body,\n                context\n              )\n            ).then(v => {\n              if (context.has(key)) {\n                throw new Error(`The context already contains key '${key}'`);\n              }\n              context.set(key, v);\n              // console.log(`  [${key}] = ${v}`);\n            })\n          )).then(() => Promise.resolve(response));\n        }\n        return Promise.resolve(response);\n      };\n\n      const options = {\n        uri: absUrl,\n        method: this._method,\n        headers: {\n          'Content-Type': this._contentType || 'application/json',\n          Cookie: context.get(group._session),\n        },\n        resolveWithFullResponse: true,\n        simple: false,\n      };\n\n      if (this._contentType === 'application/x-www-form-urlencoded') {\n        options.form = body;\n      } else if (this._contentType === 'multipart/form-data') {\n        options.formData = body;\n      } else {\n        options.body = body;\n      }\n\n      this._promise = rp(options)\n        .then(res => status(res))\n        .then(res => type(res))\n        .then(res => expect(res))\n        .then(res => save(res))\n        .then(() => {\n          if (collection._cancel) {\n            return Promise.reject();\n          }\n          console.log('    %s %s %s %s',\n            padRight(group._name, collection.getMaxGroupNameLength()).gray,\n            padRight(this._method.toUpperCase(), 6).magenta,\n            url,\n            this._name.cyan\n          );\n          return Promise.resolve();\n        });\n    }\n    return this._promise;\n  }\n\n  get(url) {\n    this._method = 'get';\n    this._url = url;\n    this._status = this._status || 200;\n    return this;\n  }\n\n  post(url) {\n    this._method = 'post';\n    this._url = url;\n    this._status = this._status || 200;\n    return this;\n  }\n\n  put(url) {\n    this._method = 'put';\n    this._url = url;\n    this._status = this._status || 204;\n    return this;\n  }\n\n  delete(url) {\n    this._method = 'delete';\n    this._url = url;\n    this._status = this._status || 204;\n    return this;\n  }\n\n  json(data) {\n    this._contentType = 'application/json';\n    if (typeof data === 'function') {\n      this._body = context => JSON.stringify(data(context));\n    } else {\n      this._body = JSON.stringify(data);\n    }\n    return this;\n  }\n\n  form(data) {\n    this._contentType = 'application/x-www-form-urlencoded';\n    this._body = data;\n    return this;\n  }\n\n  formData(data) {\n    this._contentType = 'multipart/form-data';\n    const form = new FormData();\n    Object.keys(data).forEach(key => form.set(key, data[key]));\n    this._body = form;\n    return this;\n  }\n\n  save(name, func) {\n    if (!this._save) {\n      this._save = new Map();\n    }\n    this._save.set(name, func);\n    return this;\n  }\n\n  expect(type) {\n    if (typeof type === 'function') {\n      if (!this._expect) {\n        this._expect = [];\n      }\n      this._expect.push(type);\n    } else if (typeof type === 'number') {\n      this._status = type;\n    } else if (type.indexOf('/') !== -1) {\n      this._responseContentType = type;\n    } else {\n      this._type = type;\n    }\n    return this;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/Automation/Test.js\n **/","module.exports = require(\"request-promise\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"request-promise\"\n ** module id = 23\n ** module chunks = 0\n **/","module.exports = require(\"path\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"path\"\n ** module id = 24\n ** module chunks = 0\n **/","module.exports = require(\"fs\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"fs\"\n ** module id = 25\n ** module chunks = 0\n **/","module.exports = require(\"js-yaml\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"js-yaml\"\n ** module id = 26\n ** module chunks = 0\n **/"],"sourceRoot":""}